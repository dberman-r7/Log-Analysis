openapi: 3.0.2
info:
  title: InsightOps REST API
  version: latest
  contact:
    email: support@rapid7.com
  description: |
    ### Overview

    Our REST API lets you use InsightOps through HTTP requests.
    Currently, the REST API allows you to perform the majority of the actions available through the UI, and has some
    additional functionality that is not available through the UI.
    You may use this API to automate common tasks (for example, via shell scripts), and to generally interact with InsightOps
    programmatically.

    This page precisely describes the REST API and serves as a reference for the API.
    Each HTTP method and each URL endpoint is documented in a self-contained unit
    so that users only need to read about the HTTP methods relevant to them.

    ### Terminology

    * A **log entry** is an individual log event.
    * A **log** is a collection of log entries, or a single log stream.
    * A **log set** is a logical-only collection of logs, i.e. logs can be in multiple logsets and deleting a logset only deletes the relation between logs, not the logs themselves.
    * [Log Entry Query Language](https://docs.rapid7.com/insightops/log-search) (**LEQL**) is the query language used in
    Insight Ops to search log data.
servers:
  - url: https://eu.rest.logs.insight.rapid7.com
    description: Europe
  - url: https://us.rest.logs.insight.rapid7.com
    description: United States (Users are automatically assigned to one of 3 US regions)
  - url: https://us2.rest.logs.insight.rapid7.com
    description: United States (Users are automatically assigned to one of 3 US regions)
  - url: https://us3.rest.logs.insight.rapid7.com
    description: United States (Users are automatically assigned to one of 3 US regions)
  - url: https://ca.rest.logs.insight.rapid7.com
    description: Canada
  - url: https://au.rest.logs.insight.rapid7.com
    description: Australia
  - url: https://ap.rest.logs.insight.rapid7.com
    description: Japan
tags:
  - name: Query Log Data
    description: |
      You can perform queries on your log data by using the LEQL query language. For information on LEQL consult the
      [LEQL documentation page](https://docs.rapid7.com/insightidr/use-a-search-language/), and our 
      [LEQL example queries](https://docs.rapid7.com/insightidr/example-queries/).

      ### Query Types
      There are two fundamentally different types of queries, which return different response body structures:
      * **Event Search** queries do not contain a `calculate` clause and return a list of log lines in the
      response. When the number of log lines matching your query is large, the response will be paginated, and you will 
      need to send further requests to retrieve the following pages of log lines (more details on this below).
      * **Statistical Search** queries contain a `calculate` clause and return a number rather 
      than a list of log lines. These queries do not require you to handle any pagination. Additionally, the response body
      will have a different structure depending on whether the query contains a `groupby` clause.

      ### Polling In-Progress Queries
      In many cases the initial response will not contain the complete results, instead the response will indicate that
      the query was created and is in progress. The query must then be polled until it is completed.

      If the query must be polled, there will be a `"links"` array in the response which contains a link object that has 
      `"rel"` equal to `"Self"` (see response schemas below).

      To poll the in-progress query, make a `GET` request to the value of `"href"` in that link object. 
      For example, if the response looks like
      ```
      {
      ...,
        "links": [
          {
            "rel": "Self",
            "href": "https://eu.rest.logs.insight.rapid7.com/log_search/query/b79b0082-6255-4f85-b2e6-0041b179b1ff:1:38cdc7c1fb508f8e384536b77ce495fda2185be0::d472eb0c00d8aeddbc2b5386ad0d7c560323d443:"
          }
        ],
      ...
      }
      ```
      Then you must make a `GET` request to 
      ```
      https://eu.rest.logs.insight.rapid7.com/log_search/query/b79b0082-6255-4f85-b2e6-0041b179b1ff:1:38cdc7c1fb508f8e384536b77ce495fda2185be0::d472eb0c00d8aeddbc2b5386ad0d7c560323d443:
      ```

      If further polls are needed, then the response to your polling request will once again contain a `"links"` array in the 
      response with link object that has `"rel"` equal to `"Self"`. 

      Polling links must be polled **at least every 20 seconds**, 
      or they will expire. However they should also not be polled too frequently, or you risk being rate limited 
      (more details on rate limiting below).

      A query is completed and requires no further polling when there is either no `"links"` array in the response, or
      there is no link object with `"rel"` equal to `"Self"`.

      ### Pagination

      Any search queries with over 50 results (by default) will return a paginated response. If there is another page
      of results, then there will be a `"links"` array in the response which has `"rel"` equal to `"Next"`. For example
      if the response looks like
      ```
      {
      ...,
      "links": [
        {
          "rel": "Next",
          "href": "https://eu.rest.logs.insight.rapid7.com/log_search/query/logs/17e958e2-0000-0000-0000-000000000000?from=1684763133211&to=1684763203000&per_page=1&sequence_number=3237198280324534273&next_page=true"
        }
      ],
      ...
      }
      ```
      Then you can fetch the next page of results by making a `GET` request to
      ```
      https://eu.rest.logs.insight.rapid7.com/log_search/query/logs/17e958e2-0000-0000-0000-000000000000?from=1684763133211&to=1684763203000&per_page=1&sequence_number=3237198280324534273&next_page=true
      ```

      Note that a new query is launched when fetching the next page of results, and hence you may need to poll the 
      `"Self"` link until the query is completed. It is only possible to paginate forwards, backward pagination is not supported.


      ### Rate Limits
      By default, users are limited to making 1,500 queries and 10,000 polling requests within a 15 minute window.
      For every query request or polling request you make, the response will contain an `X-RateLimit-Remaining` header
      which tells you how many further requests you can make within this 15 minute window before hitting the limit.

      The API will return responses with status code 429 when this limit is reached, and will contain an `X-RateLimit-Reset` 
      header, which tells you the number of seconds you must wait before your limit is reset.

      Note that if you are rate limited while making a polling request, then the polling link will likely expire before
      the limit is reset, and you will need to make the initial query request again after the limit is reset.
  - name: Logs & Log Sets
    description: |
      Logs are a collection of timestamped log entries.
      You can search your logs and use numerical functions to dig deeper into your log data. (See the ["Query Log Data"](#tag/Query-Log-Data) section).
      Notifications can be set up to trigger when certain behaviours occur in the log data (see the ["Basic Detection Rules"](#tag/Basic-Detection-Rules) section).
      Additionally, the log entries may be [downloaded](#tag/Download-Log-Data), [backed up to S3](#tag/Backup-Your-Log-Data-To-S3), 
      and [exported to CSV](#tag/Export-Log-Data-To-CSV).

      For your convenience, logs are grouped into log sets. The same log may belong to multiple log sets.
      [Read more about logs, log sets and Log Search](https://docs.rapid7.com/insightops/using-log-search/).

      ### Rate Limits
      By default, users are limited to making 1500 requests to the "/management" namespace within a 15 minute window.
      For every request you make, the response contains an `X-RateLimit-Remaining` header, which tells you how many 
      additional requests you can make within this 15 minute window before hitting the limit.

      The API returns responses with status code 429 when this limit is reached, and contains an `X-RateLimit-Reset`
      header, which tells you the number of seconds you must wait before your limit is reset.
  - name: Basic Detection Rules
    description: |
      Basic detection rules allow you to receive notifications when certain behaviours occurs in your log data.
      There are three types of basic detection rules: log pattern detections rules, log inactivity detection rules, and log change detection rules.
      [Read more about basic detection rules](https://docs.rapid7.com/insightidr/create-and-manage-custom-alerts).

      In the REST API, a basic detection rule is made up of are three components:
        * The rule itself (labeled as "tags" in the JSON payloads).
        * One or more notifications that are attached to rules and define the notification behaviour (labeled as "actions" in the JSON payloads).
        * One or more notification targets that are attached to notifications and define the destination for the notification (labeled as "targets" in the JSON payloads).

      Additionally, pattern detection rules may have one or more labels attached to them. 
      These labels are returned together with log entries when you search your log data, 
      and can be used to filter your data when performing a search. If you choose to use pattern detection rules to 
      only apply labels, notifications do not need to be attached.

      ### Rate Limits
      By default, users are limited to making 1500 requests to the "/management" namespace within a 15 minute window.
      For every request you make, the response contains an `X-RateLimit-Remaining` header, which tells you how many 
      additional requests you can make within this 15 minute window before hitting the limit.

      The API returns responses with status code 429 when this limit is reached, and contains an `X-RateLimit-Reset`
      header, which tells you the number of seconds you must wait before your limit is reset.
  - name: LEQL Variables
    description: |
      A LEQL variable is a placeholder in a LEQL query that represents one or more values that you can use when you
      [query your log data](#tag/Query-Log-Data) or configure [basic detection rules](#tag/Basic-Detection-Rules). 
      By storing and reusing values, you can streamline your queries to make them shorter and easier to enter. 
      [Read more about LEQL variables](https://docs.rapid7.com/insightidr/use-variables-in-queries/).

      ### Rate Limits
      By default, users are limited to making 1500 requests to the "/management" namespace within a 15 minute window.
      For every request you make, the response contains an `X-RateLimit-Remaining` header, which tells you how many 
      additional requests you can make within this 15 minute window before hitting the limit.

      The API returns responses with status code 429 when this limit is reached, and contains an `X-RateLimit-Reset`
      header, which tells you the number of seconds you must wait before your limit is reset.
  - name: Saved Queries
    description: |
      The details of a Log Search query can be stored as a saved query so those details do not have to be entered 
      manually the next time you run the query. A saved query consists of 3 parts:
      * **A LEQL statement**
      * **A time range (optional)** - If omitted, the time range must be specified when you use the saved query.
      * **Logs to query (optional)** - If omitted, logs must be specified when you use the saved query.

      ### Rate Limits
      By default, users are limited to making 1,500 requests to the "/query" namespace within a 15 minute window.
      For every request you make, the response contains an `X-RateLimit-Remaining` header, which tells you how many 
      additional requests you can make within this 15 minute window before hitting the limit.

      The API returns responses with status code 429 when this limit is reached, and contains an `X-RateLimit-Reset`
      header, which tells you the number of seconds you must wait before your limit is reset.
  - name: Pre-Computed Queries
    description: |
      You can query your log data using the LEQL query language. For information on LEQL consult the
      [LEQL documentation page](https://docs.rapid7.com/insightidr/use-a-search-language/), and our 
      [LEQL example queries](https://docs.rapid7.com/insightidr/example-queries/).

      **Statistical queries** are those that contain a `calculate` clause and return a number rather than a list
      of log lines. 

      Pre-computed queries compute the results for a statistical search in real time, as log entries are
      received by the Log Search system. This means that results are available immediately and can be returned much 
      faster than a conventional search. For this reason you may consider using a pre-computed query if:
      * You regularly perform a statistical search with the same LEQL statement on the same logs
      * Your statistical search typically takes a long time to return results.

      Users are limited to creating 10 pre-computed queries. 
      Unlike regular Log Search queries, there is no need to poll queries until they are complete, or handle pagination.

      ### Rate Limits   
      By default, users are limited to making 1,500 requests to the "/query" namespace (for fetching the results for a 
      Pre-Computed Query) within a 15 minute window, and 1,500 requests to the "/management" 
      (for creating and modifying a Pre-Computed Query) namespace within a 15 minute window.
      For every request you make, the response contains an `X-RateLimit-Remaining` header, which tells you how many 
      additional requests you can make within this 15 minute window before hitting the limit.

      The API returns responses with status code 429 when this limit is reached, and contains an `X-RateLimit-Reset`
      header, which tells you the number of seconds you must wait before your limit is reset.
  - name: Download Log Data
    description: |
      You can download your log data in plain text with the REST API.
      The download includes all the LEQL query's results, or, if no query is provided,
      all log entries are included in the download. For information on LEQL consult the
      [LEQL documentation page](https://docs.rapid7.com/insightidr/use-a-search-language/), and our 
      [LEQL example queries](https://docs.rapid7.com/insightidr/example-queries/).

      ### Rate Limits
      By default, users are limited to making 300 download requests within a 15 minute window.
      For every request you make, the response contains an `X-RateLimit-Remaining` header, which tells you how many 
      additional requests you can make within this 15 minute window before hitting the limit.

      The API returns responses with status code 429 when this limit is reached, and contains an `X-RateLimit-Reset`
      header, which tells you the number of seconds you must wait before your limit is reset.
  - name: Export Log Data To CSV
    description: |
      You can export log data as a CSV file to share with stakeholders at your convenience. 
      [Read more about exporting your log entries as a CSV file](https://docs.rapid7.com/insightidr/log-search/#export-your-data).

      The API below allows you view the progress of export jobs and obtain the links to download the CSV file for any 
      completed export jobs. Only one export job can be processed at a time for an organization.

      To initiate an export job, use the **/query** endpoints and specify the **export_format** query parameter 
      (See the ["Query Log Data"](#tag/Query-Log-Data) section).

      ### Rate Limits
      By default, users are limited to making 500 export requests within a 15 minute window.
      For every request you make, the response contains an `X-RateLimit-Remaining` header, which tells you how many 
      additional requests you can make within this 15 minute window before hitting the limit.

      The API returns responses with status code 429 when this limit is reached, and contains an `X-RateLimit-Reset`
      header, which tells you the number of seconds you must wait before your limit is reset.
  - name: Explore The Size of Your Log Data
    description: |
      You can use the **/usage/organizations** endpoints to view the amount of log data that you have stored, in bytes, for any time range, across:
      * All of your organization's log data
      * Individual logs

      ### Rate Limits
      By default, users are limited to making 500 requests to the "/usage" namespace within a 15 minute window.
      For every request you make, the response contains an `X-RateLimit-Remaining` header, which tells you how many 
      additional requests you can make within this 15 minute window before hitting the limit.

      The API returns responses with status code 429 when this limit is reached, and contains an `X-RateLimit-Reset`
      header, which tells you the number of seconds you must wait before your limit is reset.
  - name: Backup Your Log Data To S3
    description: |
      Data archiving allows you to retain a copy of your log data using the storage capabilities of Amazon S3. 
      [Read more about data archiving](https://docs.rapid7.com/insightidr/data-archiving/).
      To use the data archiving feature, you will need to grant Rapid7 access to your organization's bucket.
      [Instructions can be found here](https://docs.rapid7.com/insightidr/data-archiving/#configure-an-amazon-s3-bucket).

      There are two types of archiving available.
      * **Daily archiving** - Occurs once a day and sends all of the log data received in the past day to your S3 bucket in a compressed file format.
      * **Historical archiving** - Occurs on demand and sends all of the log data in your specified time range to your S3 bucket in a compressed file format.
        The process of archiving a large amount of data can take several days, thus this process is limited to only twice each year.

      ### Rate Limits
      By default, users are limited to making 1500 requests to the "/management" namespace within a 15 minute window.
      For every request you make, the response contains an `X-RateLimit-Remaining` header, which tells you how many 
      additional requests you can make within this 15 minute window before hitting the limit.

      The API returns responses with status code 429 when this limit is reached, and contains an `X-RateLimit-Reset`
      header, which tells you the number of seconds you must wait before your limit is reset.
  - name: Retrieve The Most Common Keys Within Your Log Data
    description: |
      [Keys](https://docs.rapid7.com/insightidr/ls-glossary/#key) are constants that define the data in your logs.
      For example, the key could be `geoip_country_name` and a value that pertains to that category might be `United States`.
      [Read more about common keys for various logs](https://docs.rapid7.com/insightidr/keys-to-use-in-your-queries/).

      The API allows you to fetch the most commonly occurring keys that appear for any given log, sorted in order from least common to most common.
      If there have been more than 1000 distinct keys in that log's data, then only the 1000 most common keys will be returned.
      Each key is returned together with a `weight`, which is a number representing how commonly occurring the key is. 
      The weight of a key is determined by the number of times the key has occurred, combined with how long ago the occurrences happened
      (recent occurrences impact the weight of a key more than older occurrences do).

      ### Rate Limits
      By default, users are limited to making 1500 requests to the "/management" namespace within a 15 minute window.
      For every request you make, the response contains an `X-RateLimit-Remaining` header, which tells you how many 
      additional requests you can make within this 15 minute window before hitting the limit.

      The API returns responses with status code 429 when this limit is reached, and contains an `X-RateLimit-Reset`
      header, which tells you the number of seconds you must wait before your limit is reset.
  - name: Watch Incoming Log Data In Realtime
    description: |
      Use the Live Tail API to start a real-time feed of log entries matching a query.
      The query may be performed on any collection of logs (Live Tail on *log sets* is not supported), either by
      providing a LEQL query, or by using a saved query.

      Queries are submitted using the methods and the endpoints described below.
      The endpoints will respond with
      * A `200 OK` response, with a link to poll the live tail feed in the response body.

      Each time a Live Tail feed is polled, all log entries ingested since the last poll, and which match the query are returned.
      A Live Tail feed must be polled **at least every 20 seconds**, or it will expire.
      If there are more than `per_page` results (50 by default) since the last poll,
      only `per_page` results will be returned, and the next page of results is returned the next time the Live Tail feed is polled.
  - name: Audit API
    description: |

      [Audit Logging](https://docs.rapid7.com/insight/audit-logging/) allows you to track and record activity (both user driven and automated) for investigative purposes.
      For every auditable action, you can see what the action was, the time that the action occurred, and who completed the action.
paths:
  /query:
    get:
      operationId: getQueryEndpoints
      summary: List All Endpoints
      tags:
        - Query Log Data
      responses:
        '200':
          description: Endpoints in Response Body.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListEndpointsResponse'
              example:
                /query:
                  path: https://eu.rest.logs.insight.rapid7.com/query
                  verbs:
                    - GET
                /query/logs/{log_keys}:
                  path: https://eu.rest.logs.insight.rapid7.com/query/logs/{log_keys}
                  verbs:
                    - GET
                /query/logs/:
                  path: https://eu.rest.logs.insight.rapid7.com/query/logs/
                  verbs:
                    - POST
                ...:
                  path: ...
                  verbs: ...
  /query/logs/{log_keys}:
    parameters:
      - $ref: '#/components/parameters/log_keys_deprecated'
    get:
      operationId: getQueryLogs
      summary: Query Individual Logs
      description: |
        Submit the query specified in the query parameters for the log with that **{log_key}**.
        For instructions on polling a query until it is completed, handling pagination, and handling rate limits, consult
        [this section's introduction](#tag/Query-Log-Data).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Query Log Data
      parameters:
        - $ref: '#/components/parameters/query'
        - $ref: '#/components/parameters/from'
        - $ref: '#/components/parameters/to'
        - $ref: '#/components/parameters/time_range'
        - $ref: '#/components/parameters/label'
        - $ref: '#/components/parameters/labels'
        - $ref: '#/components/parameters/per_page'
        - $ref: '#/components/parameters/export_format'
        - $ref: '#/components/parameters/kvp_info'
        - $ref: '#/components/parameters/most_recent_first'
        - $ref: '#/components/parameters/sequence_number'
      responses:
        '200':
          description: Results in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsResponse'
                  - $ref: '#/components/schemas/StatisticalResponse'
              examples:
                EventsResponseSimple:
                  $ref: '#/components/examples/EventsResponseSimple'
                EventsResponsePagination:
                  $ref: '#/components/examples/EventsResponsePagination'
                StatisticalResponseSimple:
                  $ref: '#/components/examples/StatisticalResponseSimple'
                StatisticalResponseTimeSeriesMultiGroupBy:
                  $ref: '#/components/examples/StatisticalResponseTimeSeriesMultiGroupBy'
        '202':
          description: Query in Progress. Links in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsContinuation'
                  - $ref: '#/components/schemas/StatisticalContinuation'
              examples:
                EventsContinue:
                  $ref: '#/components/examples/EventsContinue'
                EventsContinueExportCSV:
                  $ref: '#/components/examples/EventsContinueExportCSV'
                StatsContinueInitial:
                  $ref: '#/components/examples/StatsContinueInitial'
        '400':
          description: Invalid Query Request.
        '401':
          description: Unauthorized.
        '404':
          description: Log Not Found.
        '415':
          description: Non-JSON request body was given (not that the endpoint takes a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            -G \
            --data-urlencode query="where(number<100) calculate(count)" \
            --data from=1609755026007 \
            --data to=1609927826007 \
            https://us.rest.logs.insight.rapid7.com/query/logs/f558ea24-c213-8b99-9a33-8a498121677a
        - lang: Python
          label: Python3.10
          source: |
            import json
            import time            
            from requests import Response, Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY'
            LOG_KEY = 'YOUR LOG KEY'
            FROM_TS_MILLIS = 1684762903000  # Unix epoch
            TO_TS_MILLIS = 1684763203000  # Unix epoch
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            QUERY = ''


            class RateLimitedException(Exception):
                def __init__(self, message: str, secs_until_reset: int):
                    super().__init__(message)
                    self.secs_until_reset = secs_until_reset


            def is_query_in_progress(query_response: Response) -> bool:
                if 'links' not in query_response.json():
                    return False
                elif 'Next' in [link['rel'] for link in query_response.json()['links']]:
                    return False
                elif 'Self' in [link['rel'] for link in query_response.json()['links']]:
                    return True
                raise Exception('LogSearch query returned an invalid response body according to their spec '
                                '- contains a "links" object, which does not contain a link with either '
                                '"rel" equal to "Next" or "Self"')


            def poll_request_to_completion(logsearch_session: Session,
                                           query_in_progress_response: Response) -> Response:
                """
                "continuation" polls expire after 10 seconds, so we must not wait too long between
                requests. However we must not poll too frequently for long-running queries or we
                risk being rate limited.
                """
                if query_in_progress_response.status_code == 429:
                    secs_until_reset = query_in_progress_response.headers.get('X-RateLimit-Reset')
                    raise RateLimitedException(
                        f'Log Search API Key was rate limited. Seconds until rate limit reset: {secs_until_reset}',
                        int(secs_until_reset)
                    )

                if not is_query_in_progress(query_in_progress_response):
                    return query_in_progress_response

                poll_delay_secs = 0.5
                max_poll_delay_secs = 6
                links = {link['rel']: link['href'] for link in query_in_progress_response.json()['links']}
                while 'Self' in links:
                    time.sleep(poll_delay_secs)

                    resp = logsearch_session.get(links['Self'], headers={'x-api-key': API_KEY})

                    if resp.status_code == 429:
                        secs_until_reset = resp.headers.get('X-RateLimit-Reset')
                        raise RateLimitedException(
                         f'Log Search API Key was rate limited. Seconds until rate limit reset: {secs_until_reset}',
                         int(secs_until_reset)
                        )

                    if not is_query_in_progress(resp):
                        return resp

                    poll_delay_secs = min(poll_delay_secs * 2, max_poll_delay_secs)
                    links = {link['rel']: link['href'] for link in resp.json()['links']}


            def has_next_page(query_response: Response) -> bool:
                return 'links' in query_response.json() and \
                       'Next' in [link['rel'] for link in query_response.json()['links']]


            def get_next_page_of_results(logsearch_session: Session, resp: Response) -> Response:
                links = {link['rel']: link['href'] for link in resp.json()['links']}
                return logsearch_session.get(links['Next'], headers={'x-api-key': API_KEY})


            def perform_query(logsearch_session: Session) -> Response:
                try:
                    resp = poll_request_to_completion(
                        logsearch_session,
                        logsearch_session.get(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/query/logs/{LOG_KEY}',
                                              headers={'x-api-key': API_KEY},
                                              params={'from': FROM_TS_MILLIS, 'to': TO_TS_MILLIS, 'query': QUERY})
                    )
                    print(json.dumps(resp.json(), indent=4))
                    return resp
                except RateLimitedException as e:
                    print(f'Log Search API Key was rate limited. Sleeping for {e.secs_until_reset} seconds')
                    time.sleep(e.secs_until_reset)
                    return perform_query(logsearch_session)


            session = Session()
            session.mount(
                f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                HTTPAdapter(max_retries=(
                    Retry(total=3,
                          backoff_factor=1,
                          status_forcelist=[500, 502, 503, 504],
                          respect_retry_after_header=False)  # Rate limiting must be handled explicitly
                ))
            )

            query_results_page = perform_query(session)

            while has_next_page(query_results_page):
                try:
                    print('Fetching next page of results')
                    query_results_page = poll_request_to_completion(
                        session,
                        get_next_page_of_results(session, query_results_page)
                    )
                    print(json.dumps(query_results_page.json(), indent=4))
                except RateLimitedException as e:
                    print(f'Log Search API Key was rate limited. Sleeping for {e.secs_until_reset} seconds')
                    time.sleep(e.secs_until_reset)
  /query/logs:
    post:
      operationId: postQueryLogs
      summary: Query Multiple Logs
      description: |
        Submit the query specified in the (JSON) request body and the URL query parameters.

        An arbitrary collection of logs can be specified in the request body.

        For instructions on polling a query until it is completed, handling pagination, and handling rate limits, consult
        [this section's introduction](#tag/Query-Log-Data).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Query Log Data
      requestBody:
        description: |
          The JSON payload must contain:
          * a non-empty array of the log keys for the logs that will be queried
          * a `leql` object, containing a value for either of the following (but **not** for both):
            - `leql.during.time_range`
            - `leql.during.from` and `leql.during.to`

            The `leql.statement` can be empty or omitted.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                logs:
                  $ref: '#/components/schemas/logs'
                leql:
                  $ref: '#/components/schemas/leql'
              example:
                logs:
                  - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                  - c78579a8-8b20-4e6a-d4c0-5287198a263b
                leql:
                  during:
                    time_range: last 1 hour
                  statement: where(931dde6c60>=800)
      parameters:
        - $ref: '#/components/parameters/per_page'
        - $ref: '#/components/parameters/export_format'
        - $ref: '#/components/parameters/kvp_info'
        - $ref: '#/components/parameters/most_recent_first'
        - $ref: '#/components/parameters/labels'
        - $ref: '#/components/parameters/sequence_number'
      responses:
        '200':
          description: Results in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsResponse'
                  - $ref: '#/components/schemas/StatisticalResponse'
              examples:
                EventsResponseSimple:
                  $ref: '#/components/examples/EventsResponseSimple'
                EventsResponsePagination:
                  $ref: '#/components/examples/EventsResponsePagination'
                StatisticalResponseSimple:
                  $ref: '#/components/examples/StatisticalResponseSimple'
                StatisticalResponseTimeSeriesMultiGroupBy:
                  $ref: '#/components/examples/StatisticalResponseTimeSeriesMultiGroupBy'
        '202':
          description: Query in Progress. Links in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsContinuation'
                  - $ref: '#/components/schemas/StatisticalContinuation'
              examples:
                EventsContinue:
                  $ref: '#/components/examples/EventsContinue'
                EventsContinueExportCSV:
                  $ref: '#/components/examples/EventsContinueExportCSV'
                StatsContinueInitial:
                  $ref: '#/components/examples/StatsContinueInitial'
        '400':
          description: Malformed JSON Request Body.
        '401':
          description: Unauthorized.
        '404':
          description: Log Not Found.
        '415':
          description: Data not specified as JSON.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            -H 'Content-Type: application/json' \
            -X POST \
            --data '{"logs": ["565c1b7b-c08b-4c87-a42a-ab08bad56071","c78579a8-8b20-4e6a-d4c0-5287198a263b"],"leql":{"during":{"time_range":"last 1 hour"},"statement":"where(931dde6c60>=800)"}}' \
            https://us.rest.logs.insight.rapid7.com/query/logs?\
            kvp_info=true&\
            most_recent_first=true&\          
            per_page=1
        - lang: Python
          label: Python3.10
          source: |
            import json
            import time
            from requests import Response, Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY'
            LOG_KEY = 'YOUR LOG KEY'
            FROM_TS_MILLIS = 1684762903000  # Unix epoch
            TO_TS_MILLIS = 1684763203000  # Unix epoch
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            QUERY = ''


            class RateLimitedException(Exception):
                def __init__(self, message: str, secs_until_reset: int):
                    super().__init__(message)
                    self.secs_until_reset = secs_until_reset


            def is_query_in_progress(query_response: Response) -> bool:
                if 'links' not in query_response.json():
                    return False
                elif 'Next' in [link['rel'] for link in query_response.json()['links']]:
                    return False
                elif 'Self' in [link['rel'] for link in query_response.json()['links']]:
                    return True
                raise Exception('LogSearch query returned an invalid response body according to their spec '
                                '- contains a "links" object, which does not contain a link with either '
                                '"rel" equal to "Next" or "Self"')


            def poll_request_to_completion(logsearch_session: Session,
                                           query_in_progress_response: Response) -> Response:
                """
                "continuation" polls expire after 10 seconds, so we must not wait too long between
                requests. However we must not poll too frequently for long-running queries or we
                risk being rate limited.
                """
                if query_in_progress_response.status_code == 429:
                    secs_until_reset = query_in_progress_response.headers.get('X-RateLimit-Reset')
                    raise RateLimitedException(
                        f'Log Search API Key was rate limited. Seconds until rate limit reset: {secs_until_reset}',
                        int(secs_until_reset)
                    )

                if not is_query_in_progress(query_in_progress_response):
                    return query_in_progress_response

                poll_delay_secs = 0.5
                max_poll_delay_secs = 6
                links = {link['rel']: link['href'] for link in query_in_progress_response.json()['links']}
                while 'Self' in links:
                    time.sleep(poll_delay_secs)

                    resp = logsearch_session.get(links['Self'], headers={'x-api-key': API_KEY})

                    if resp.status_code == 429:
                        secs_until_reset = resp.headers.get('X-RateLimit-Reset')
                        raise RateLimitedException(
                         f'Log Search API Key was rate limited. Seconds until rate limit reset: {secs_until_reset}',
                         int(secs_until_reset)
                        )

                    if not is_query_in_progress(resp):
                        return resp

                    poll_delay_secs = min(poll_delay_secs * 2, max_poll_delay_secs)
                    links = {link['rel']: link['href'] for link in resp.json()['links']}


            def has_next_page(query_response: Response) -> bool:
                return 'links' in query_response.json() and \
                       'Next' in [link['rel'] for link in query_response.json()['links']]


            def get_next_page_of_results(logsearch_session: Session, resp: Response) -> Response:
                links = {link['rel']: link['href'] for link in resp.json()['links']}
                return logsearch_session.get(links['Next'], headers={'x-api-key': API_KEY})


            def perform_query(logsearch_session: Session) -> Response:
                try:
                    resp = poll_request_to_completion(
                        logsearch_session,
                        logsearch_session.post(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/query/logs',
                                               headers={'x-api-key': API_KEY},
                                               json={
                                                   'logs': [LOG_KEY],
                                                   'leql': {
                                                       'during': {'from': FROM_TS_MILLIS, 'to': TO_TS_MILLIS},
                                                       'statement': QUERY
                                                   }
                                               })
                    )
                    print(json.dumps(resp.json(), indent=4))
                    return resp
                except RateLimitedException as e:
                    print(f'Log Search API Key was rate limited. Sleeping for {e.secs_until_reset} seconds')
                    time.sleep(e.secs_until_reset)
                    return perform_query(logsearch_session)


            session = Session()
            session.mount(
                f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                HTTPAdapter(max_retries=(
                    Retry(total=3,
                          backoff_factor=1,
                          status_forcelist=[500, 502, 503, 504],
                          respect_retry_after_header=False)  # Rate limiting must be handled explicitly
                ))
            )

            query_results_page = perform_query(session)

            while has_next_page(query_results_page):
                try:
                    print('Fetching next page of results')
                    query_results_page = poll_request_to_completion(
                        session,
                        get_next_page_of_results(session, query_results_page)
                    )
                    print(json.dumps(query_results_page.json(), indent=4))
                except RateLimitedException as e:
                    print(f'Log Search API Key was rate limited. Sleeping for {e.secs_until_reset} seconds')
                    time.sleep(e.secs_until_reset)
  /query/logsets:
    get:
      operationId: queryLogsetsByName
      summary: Query Multiple Log Sets
      description: |
        Submit the query specified in the query parameters for the log sets matching the given names.

        For instructions on polling a query until it is completed, handling pagination, and handling rate limits, consult
        [this section's introduction](#tag/Query-Log-Data).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Query Log Data
      parameters:
        - $ref: '#/components/parameters/query'
        - $ref: '#/components/parameters/logset_name'
        - $ref: '#/components/parameters/from'
        - $ref: '#/components/parameters/to'
        - $ref: '#/components/parameters/time_range'
        - $ref: '#/components/parameters/label'
        - $ref: '#/components/parameters/labels'
        - $ref: '#/components/parameters/per_page'
        - $ref: '#/components/parameters/kvp_info'
        - $ref: '#/components/parameters/most_recent_first'
        - $ref: '#/components/parameters/sequence_number'
      responses:
        '200':
          description: Results in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsResponse'
                  - $ref: '#/components/schemas/StatisticalResponse'
              examples:
                EventsResponseSimple:
                  $ref: '#/components/examples/EventsResponseSimple'
                EventsResponsePagination:
                  $ref: '#/components/examples/EventsResponsePagination'
                StatisticalResponseSimple:
                  $ref: '#/components/examples/StatisticalResponseSimple'
                StatisticalResponseTimeSeriesMultiGroupBy:
                  $ref: '#/components/examples/StatisticalResponseTimeSeriesMultiGroupBy'
        '202':
          description: Query in Progress. Links in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsContinuation'
                  - $ref: '#/components/schemas/StatisticalContinuation'
              examples:
                EventsContinue:
                  $ref: '#/components/examples/EventsContinue'
                StatsContinueInitial:
                  $ref: '#/components/examples/StatsContinueInitial'
        '400':
          description: Invalid Query Request.
        '401':
          description: Unauthorized.
        '404':
          description: Log Not Found.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            -G \
            --data-urlencode query="where(931dde6c60>=800)" \
            --data logset_name=HostService \
            --data-urlencode logset_name="Internal Logs" \
            --data from=1609755026007 \
            --data to=1609927826007 \
            --data labels=00000000-0000-0000-0000-000000000002:00000000-0000-0000-0000-000000000001 \
            --data per_page=100 \
            https://us.rest.logs.insight.rapid7.com/query/logsets
        - lang: Python
          label: Python3.10
          source: |
            import json
            import time
            from requests import Response, Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY'
            LOGSET_NAME = "YOUR LOGSET'S NAME"
            FROM_TS_MILLIS = 1684762903000  # Unix epoch
            TO_TS_MILLIS = 1684763203000  # Unix epoch
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            QUERY = ''


            class RateLimitedException(Exception):
                def __init__(self, message: str, secs_until_reset: int):
                    super().__init__(message)
                    self.secs_until_reset = secs_until_reset


            def is_query_in_progress(query_response: Response) -> bool:
                if 'links' not in query_response.json():
                    return False
                elif 'Next' in [link['rel'] for link in query_response.json()['links']]:
                    return False
                elif 'Self' in [link['rel'] for link in query_response.json()['links']]:
                    return True
                raise Exception('LogSearch query returned an invalid response body according to their spec '
                                '- contains a "links" object, which does not contain a link with either '
                                '"rel" equal to "Next" or "Self"')


            def poll_request_to_completion(logsearch_session: Session,
                                           query_in_progress_response: Response) -> Response:
                """
                "continuation" polls expire after 10 seconds, so we must not wait too long between
                requests. However we must not poll too frequently for long-running queries or we
                risk being rate limited.
                """
                if query_in_progress_response.status_code == 429:
                    secs_until_reset = query_in_progress_response.headers.get('X-RateLimit-Reset')
                    raise RateLimitedException(
                        f'Log Search API Key was rate limited. Seconds until rate limit reset: {secs_until_reset}',
                        int(secs_until_reset)
                    )

                if not is_query_in_progress(query_in_progress_response):
                    return query_in_progress_response

                poll_delay_secs = 0.5
                max_poll_delay_secs = 6
                links = {link['rel']: link['href'] for link in query_in_progress_response.json()['links']}
                while 'Self' in links:
                    time.sleep(poll_delay_secs)

                    resp = logsearch_session.get(links['Self'], headers={'x-api-key': API_KEY})

                    if resp.status_code == 429:
                        secs_until_reset = resp.headers.get('X-RateLimit-Reset')
                        raise RateLimitedException(
                         f'Log Search API Key was rate limited. Seconds until rate limit reset: {secs_until_reset}',
                         int(secs_until_reset)
                        )

                    if not is_query_in_progress(resp):
                        return resp

                    poll_delay_secs = min(poll_delay_secs * 2, max_poll_delay_secs)
                    links = {link['rel']: link['href'] for link in resp.json()['links']}


            def has_next_page(query_response: Response) -> bool:
                return 'links' in query_response.json() and \
                       'Next' in [link['rel'] for link in query_response.json()['links']]


            def get_next_page_of_results(logsearch_session: Session, resp: Response) -> Response:
                links = {link['rel']: link['href'] for link in resp.json()['links']}
                return logsearch_session.get(links['Next'], headers={'x-api-key': API_KEY})


            def perform_query(logsearch_session: Session) -> Response:
                try:
                    resp = poll_request_to_completion(
                        logsearch_session,
                        logsearch_session.get(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/query/logsets',
                                    headers={'x-api-key': API_KEY},
                                    params={'logset_name': LOGSET_NAME,
                                            'from': FROM_TS_MILLIS,
                                            'to': TO_TS_MILLIS,
                                            'query': QUERY})
                    )
                    print(json.dumps(resp.json(), indent=4))
                    return resp
                except RateLimitedException as e:
                    print(f'Log Search API Key was rate limited. Sleeping for {e.secs_until_reset} seconds')
                    time.sleep(e.secs_until_reset)
                    return perform_query(logsearch_session)


            session = Session()
            session.mount(
                f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                HTTPAdapter(max_retries=(
                    Retry(total=3,
                          backoff_factor=1,
                          status_forcelist=[500, 502, 503, 504],
                          respect_retry_after_header=False)  # Rate limiting must be handled explicitly
                ))
            )

            query_results_page = perform_query(session)

            while has_next_page(query_results_page):
                try:
                    print('Fetching next page of results')
                    query_results_page = poll_request_to_completion(
                        session,
                        get_next_page_of_results(session, query_results_page)
                    )
                    print(json.dumps(query_results_page.json(), indent=4))
                except RateLimitedException as e:
                    print(f'Log Search API Key was rate limited. Sleeping for {e.secs_until_reset} seconds')
                    time.sleep(e.secs_until_reset)
  /query/logsets/{id}:
    parameters:
      - $ref: '#/components/parameters/logset_id'
    get:
      operationId: queryLogsetsById
      summary: Query Individual Log Sets
      description: |
        Submit the query specified in the query parameters for the log set with that **{logset_id}**.
        Only one log set id may be provided.

        For instructions on polling a query until it is completed, handling pagination, and handling rate limits, consult
        [this section's introduction](#tag/Query-Log-Data).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Query Log Data
      parameters:
        - $ref: '#/components/parameters/query'
        - $ref: '#/components/parameters/from'
        - $ref: '#/components/parameters/to'
        - $ref: '#/components/parameters/time_range'
        - $ref: '#/components/parameters/label'
        - $ref: '#/components/parameters/labels'
        - $ref: '#/components/parameters/per_page'
        - $ref: '#/components/parameters/kvp_info'
        - $ref: '#/components/parameters/most_recent_first'
        - $ref: '#/components/parameters/sequence_number'
      responses:
        '200':
          description: Results in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsResponse'
                  - $ref: '#/components/schemas/StatisticalResponse'
              examples:
                EventsResponseSimple:
                  $ref: '#/components/examples/EventsResponseSimple'
                EventsResponsePagination:
                  $ref: '#/components/examples/EventsResponsePagination'
                StatisticalResponseSimple:
                  $ref: '#/components/examples/StatisticalResponseSimple'
                StatisticalResponseTimeSeriesMultiGroupBy:
                  $ref: '#/components/examples/StatisticalResponseTimeSeriesMultiGroupBy'
        '202':
          description: Query in Progress. Links in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsContinuation'
                  - $ref: '#/components/schemas/StatisticalContinuation'
              examples:
                EventsContinue:
                  $ref: '#/components/examples/EventsContinue'
                StatsContinueInitial:
                  $ref: '#/components/examples/StatsContinueInitial'
        '400':
          description: Invalid Query Request.
        '401':
          description: Unauthorized.
        '404':
          description: Log Not Found.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            -G \
            --data-urlencode query="where(931dde6c60>=800)" \
            --data from=1609755026007 \
            --data to=1609927826007 \
            --data labels=00000000-0000-0000-0000-000000000002:00000000-0000-0000-0000-000000000001 \
            --data per_page=1 \
            https://ap.rest.logs.insight.rapid7.com/query/logsets/c1711420-2eb1-69d1-1e15-c17aa921c119
        - lang: Python
          label: Python3.10
          source: |
            import json
            import time
            from requests import Response, Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY'
            LOGSET_ID = 'YOUR LOGSET ID'
            FROM_TS_MILLIS = 1684762903000  # Unix epoch
            TO_TS_MILLIS = 1684763203000  # Unix epoch
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            QUERY = ''


            class RateLimitedException(Exception):
                def __init__(self, message: str, secs_until_reset: int):
                    super().__init__(message)
                    self.secs_until_reset = secs_until_reset


            def is_query_in_progress(query_response: Response) -> bool:
                if 'links' not in query_response.json():
                    return False
                elif 'Next' in [link['rel'] for link in query_response.json()['links']]:
                    return False
                elif 'Self' in [link['rel'] for link in query_response.json()['links']]:
                    return True
                raise Exception('LogSearch query returned an invalid response body according to their spec '
                                '- contains a "links" object, which does not contain a link with either '
                                '"rel" equal to "Next" or "Self"')


            def poll_request_to_completion(logsearch_session: Session,
                                           query_in_progress_response: Response) -> Response:
                """
                "continuation" polls expire after 10 seconds, so we must not wait too long between
                requests. However we must not poll too frequently for long-running queries or we
                risk being rate limited.
                """
                if query_in_progress_response.status_code == 429:
                    secs_until_reset = query_in_progress_response.headers.get('X-RateLimit-Reset')
                    raise RateLimitedException(
                        f'Log Search API Key was rate limited. Seconds until rate limit reset: {secs_until_reset}',
                        int(secs_until_reset)
                    )

                if not is_query_in_progress(query_in_progress_response):
                    return query_in_progress_response

                poll_delay_secs = 0.5
                max_poll_delay_secs = 6
                links = {link['rel']: link['href'] for link in query_in_progress_response.json()['links']}
                while 'Self' in links:
                    time.sleep(poll_delay_secs)

                    resp = logsearch_session.get(links['Self'], headers={'x-api-key': API_KEY})

                    if resp.status_code == 429:
                        secs_until_reset = resp.headers.get('X-RateLimit-Reset')
                        raise RateLimitedException(
                         f'Log Search API Key was rate limited. Seconds until rate limit reset: {secs_until_reset}',
                         int(secs_until_reset)
                        )

                    if not is_query_in_progress(resp):
                        return resp

                    poll_delay_secs = min(poll_delay_secs * 2, max_poll_delay_secs)
                    links = {link['rel']: link['href'] for link in resp.json()['links']}


            def has_next_page(query_response: Response) -> bool:
                return 'links' in query_response.json() and \
                       'Next' in [link['rel'] for link in query_response.json()['links']]


            def get_next_page_of_results(logsearch_session: Session, resp: Response) -> Response:
                links = {link['rel']: link['href'] for link in resp.json()['links']}
                return logsearch_session.get(links['Next'], headers={'x-api-key': API_KEY})


            def perform_query(logsearch_session: Session) -> Response:
                try:
                    resp = poll_request_to_completion(
                        logsearch_session,
                        logsearch_session.get(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/query/logsets/{LOGSET_ID}',
                                              headers={'x-api-key': API_KEY},
                                              params={'from': FROM_TS_MILLIS, 'to': TO_TS_MILLIS, 'query': QUERY})
                    )
                    print(json.dumps(resp.json(), indent=4))
                    return resp
                except RateLimitedException as e:
                    print(f'Log Search API Key was rate limited. Sleeping for {e.secs_until_reset} seconds')
                    time.sleep(e.secs_until_reset)
                    return perform_query(logsearch_session)

            session = Session()
            session.mount(
                f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                HTTPAdapter(max_retries=(
                    Retry(total=3,
                          backoff_factor=1,
                          status_forcelist=[500, 502, 503, 504],
                          respect_retry_after_header=False)  # Rate limiting must be handled explicitly
                ))
            )

            query_results_page = perform_query(session)

            while has_next_page(query_results_page):
                try:
                    print('Fetching next page of results')
                    query_results_page = poll_request_to_completion(
                        session,
                        get_next_page_of_results(session, query_results_page)
                    )
                    print(json.dumps(query_results_page.json(), indent=4))
                except RateLimitedException as e:
                    print(f'Log Search API Key was rate limited. Sleeping for {e.secs_until_reset} seconds')
                    time.sleep(e.secs_until_reset)
  /query/saved_query/{saved_query_id}:
    get:
      operationId: useSavedQuery
      summary: Use a Saved Query (logs specified)
      description: |
        Run a saved query.

        This endpoint can only be used for saved queries which *have* the logs for the query already specified.
        For saved queries which *don't have* the logs already specified, use the
        [/query/logs/{log_keys}/{saved_query_id}](#operation/useSavedQueryNoLogs) endpoint.

        The saved queries used here may or may not have the time range specified.
        If unspecified, the time range must be indicated in the URL query parameters.
        If the time range *is specified* by the saved query, the time range cannnot be overridden in the query parameters.

        ### Query Types
        There are two types of queries, which return different response body structures:
        * **Event Search** queries do not contain a `calculate` function and return a list of log lines in the
        response. When the number of log lines matching your query is large, the response will be paginated and you will
        need to send further requests to retrieve the other pages of log lines (more details on this below).
        * **Statistical Search** queries contain a `calculate` function and return a number rather
        than a list of log lines. These queries do not require you to handle any pagination. Additionally, the response body
        will have a different structure depending on whether the query contains a `groupby` clause or not.

        ### Polling, Pagination & Rate Limiting
        For instructions on polling a query until it is completed, handling pagination, and handling rate limits, consult
        [the introduction to the "Query Log Data" section](#tag/Query-Log-Data).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Saved Queries
      parameters:
        - $ref: '#/components/parameters/saved_query_id'
        - $ref: '#/components/parameters/from'
        - $ref: '#/components/parameters/to'
        - $ref: '#/components/parameters/time_range'
        - $ref: '#/components/parameters/per_page'
        - $ref: '#/components/parameters/kvp_info'
        - $ref: '#/components/parameters/most_recent_first'
      responses:
        '200':
          description: Results in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsResponse'
                  - $ref: '#/components/schemas/StatisticalResponse'
              examples:
                EventsResponseSimple:
                  $ref: '#/components/examples/EventsResponseSimple'
                EventsResponsePagination:
                  $ref: '#/components/examples/EventsResponsePagination'
                StatisticalResponseSimple:
                  $ref: '#/components/examples/StatisticalResponseSimple'
                StatisticalResponseTimeSeriesMultiGroupBy:
                  $ref: '#/components/examples/StatisticalResponseTimeSeriesMultiGroupBy'
        '202':
          description: Query in Progress. Links in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsContinuation'
                  - $ref: '#/components/schemas/StatisticalContinuation'
              examples:
                EventsContinue:
                  $ref: '#/components/examples/EventsContinue'
                StatsContinueInitial:
                  $ref: '#/components/examples/StatsContinueInitial'
        '400':
          description: Saved Query Parameters Invalid.
        '401':
          description: Unauthorized.
        '404':
          description: Saved Query Not Found.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            -G \
            --data-urlencode time_range="last 1 day" \
            --data per_page=1 \
            --data kvp_info=true \
            https://us.rest.logs.insight.rapid7.com/query/saved_query/00000000-0000-01cf-0000-000000000000
        - lang: Python
          label: Python3.10
          source: |
            import json
            import time
            from requests import Response, Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY GOES HERE'
            SAVED_QUERY_ID = 'YOUR SAVED QUERY ID GOES HERE'
            FROM_TS_MILLIS = 1684762903000  # If unspecified in the saved query
            TO_TS_MILLIS = 1684763203000  # If unspecified in the saved query
            DATA_STORAGE_REGION = 'eu'  # Swap for your region


            class RateLimitedException(Exception):
                def __init__(self, message: str, secs_until_reset: int):
                    super().__init__(message)
                    self.secs_until_reset = secs_until_reset


            def is_query_in_progress(query_response: Response) -> bool:
                if 'links' not in query_response.json():
                    return False
                elif 'Next' in [link['rel'] for link in query_response.json()['links']]:
                    return False
                elif 'Self' in [link['rel'] for link in query_response.json()['links']]:
                    return True
                raise Exception('LogSearch query returned an invalid response body according to their spec '
                                '- contains a "links" object, which does not contain a link with either '
                                '"rel" equal to "Next" or "Self"')


            def poll_request_to_completion(logsearch_session: Session,
                                           query_in_progress_response: Response) -> Response:
                """
                "continuation" polls expire after 10 seconds, so we must not wait too long between
                requests. However we must not poll too frequently for long-running queries or we
                risk being rate limited.
                """
                if query_in_progress_response.status_code == 429:
                    secs_until_reset = query_in_progress_response.headers.get('X-RateLimit-Reset')
                    raise RateLimitedException(
                        f'Log Search API Key was rate limited. Seconds until rate limit reset: {secs_until_reset}',
                        int(secs_until_reset)
                    )

                if not is_query_in_progress(query_in_progress_response):
                    return query_in_progress_response

                poll_delay_secs = 0.5
                max_poll_delay_secs = 6
                links = {link['rel']: link['href'] for link in query_in_progress_response.json()['links']}
                while 'Self' in links:
                    time.sleep(poll_delay_secs)

                    resp = logsearch_session.get(links['Self'], headers={'x-api-key': API_KEY})

                    if resp.status_code == 429:
                        secs_until_reset = resp.headers.get('X-RateLimit-Reset')
                        raise RateLimitedException(
                         f'Log Search API Key was rate limited. Seconds until rate limit reset: {secs_until_reset}',
                         int(secs_until_reset)
                        )

                    if not is_query_in_progress(resp):
                        return resp

                    poll_delay_secs = min(poll_delay_secs * 2, max_poll_delay_secs)
                    links = {link['rel']: link['href'] for link in resp.json()['links']}


            def has_next_page(query_response: Response) -> bool:
                return 'links' in query_response.json() and \
                       'Next' in [link['rel'] for link in query_response.json()['links']]


            def get_next_page_of_results(logsearch_session: Session, resp: Response) -> Response:
                links = {link['rel']: link['href'] for link in resp.json()['links']}
                return logsearch_session.get(links['Next'], headers={'x-api-key': API_KEY})


            def perform_query(logsearch_session: Session) -> Response:
                try:
                    resp = poll_request_to_completion(
                        logsearch_session,
                        logsearch_session.get(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/'
                                              f'query/saved_query/{SAVED_QUERY_ID}',
                                              headers={'x-api-key': API_KEY},
                                              params={'from': FROM_TS_MILLIS, 'to': TO_TS_MILLIS})
                    )
                    print(json.dumps(resp.json(), indent=4))
                    return resp
                except RateLimitedException as e:
                    print(f'Log Search API Key was rate limited. Sleeping for {e.secs_until_reset} seconds')
                    time.sleep(e.secs_until_reset)
                    return perform_query(logsearch_session)


            session = Session()
            session.mount(
                f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                HTTPAdapter(max_retries=(
                    Retry(total=3,
                          backoff_factor=1,
                          status_forcelist=[500, 502, 503, 504],
                          respect_retry_after_header=False)  # Rate limiting must be handled explicitly
                ))
            )

            query_results_page = perform_query(session)

            while has_next_page(query_results_page):
                try:
                    print('Fetching next page of results')
                    query_results_page = poll_request_to_completion(
                        session,
                        get_next_page_of_results(session, query_results_page)
                    )
                    print(json.dumps(query_results_page.json(), indent=4))
                except RateLimitedException as e:
                    print(f'Log Search API Key was rate limited. Sleeping for {e.secs_until_reset} seconds')
                    time.sleep(e.secs_until_reset)
  /query/logs/{log_keys}/{saved_query_id}:
    get:
      operationId: useSavedQueryNoLogs
      summary: Use a Saved Query (logs unspecified)
      description: |
        Run a saved query on the logs matching the specified **{log_keys}**.

        This endpoint can only be used for saved queries which *don't have* the logs for the query already specified.
        For saved queries which *have* the logs already specified, use the
        [/query/saved_query/{saved_query_id}](#operation/useSavedQuery) endpoint.

        The saved queries used here may or may not have the time range specified.
        If unspecified, the time range must be indicated in the URL query parameters.
        If the time range *is specified* by the saved query, the time range cannnot be overridden in the query parameters.

        ### Query Types
        There are two types of queries, which return different response body structures:
        * **Event Search** queries do not contain a `calculate` function and return a list of log lines in the
        response. When the number of log lines matching your query is large, the response will be paginated and you will
        need to send further requests to retrieve the other pages of log lines (more details on this below).
        * **Statistical Search** queries contain a `calculate` function and return a number rather
        than a list of log lines. These queries do not require you to handle any pagination. Additionally, the response body
        will have a different structure depending on whether the query contains a `groupby` clause or not.

        ### Polling, Pagination & Rate Limiting
        For instructions on polling a query until it is completed, handling pagination, and handling rate limits, consult
        [the introduction to the "Query Log Data" section](#tag/Query-Log-Data).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Saved Queries
      parameters:
        - $ref: '#/components/parameters/log_keys'
        - $ref: '#/components/parameters/saved_query_id'
        - $ref: '#/components/parameters/from'
        - $ref: '#/components/parameters/to'
        - $ref: '#/components/parameters/time_range'
        - $ref: '#/components/parameters/per_page'
        - $ref: '#/components/parameters/kvp_info'
        - $ref: '#/components/parameters/most_recent_first'
      responses:
        '200':
          description: Results in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsResponse'
                  - $ref: '#/components/schemas/StatisticalResponse'
              examples:
                EventsResponseSimple:
                  $ref: '#/components/examples/EventsResponseSimple'
                EventsResponsePagination:
                  $ref: '#/components/examples/EventsResponsePagination'
                StatisticalResponseSimple:
                  $ref: '#/components/examples/StatisticalResponseSimple'
                StatisticalResponseTimeSeriesMultiGroupBy:
                  $ref: '#/components/examples/StatisticalResponseTimeSeriesMultiGroupBy'
        '202':
          description: Query in Progress. Links in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsContinuation'
                  - $ref: '#/components/schemas/StatisticalContinuation'
              examples:
                EventsContinue:
                  $ref: '#/components/examples/EventsContinue'
                StatsContinueInitial:
                  $ref: '#/components/examples/StatsContinueInitial'
        '400':
          description: Saved Query Parameters Invalid.
        '401':
          description: Unauthorized.
        '404':
          description: Log or Saved Query Not Found.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            -G \
            --data-urlencode time_range="last 1 day" \
            --data per_page=1 \
            --data kvp_info=true \
            https://eu.rest.logs.insight.rapid7.com/query/logs/626c8841-feb2-4a45-32a8-5224e4cc6ecf/00000000-0000-011e-0000-000000000000
        - lang: Python
          label: Python3.10
          source: |
            import json
            import time
            from requests import Response, Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY GOES HERE'
            LOG_KEY = 'YOUR LOG KEY GOES HERE'
            SAVED_QUERY_ID = 'YOUR SAVED QUEYR ID GOES HERE'
            FROM_TS_MILLIS = 1684762903000  # If unspecified in the saved query
            TO_TS_MILLIS = 1684763203000  # If unspecified in the saved query
            DATA_STORAGE_REGION = 'eu'  # Swap for your region


            class RateLimitedException(Exception):
                def __init__(self, message: str, secs_until_reset: int):
                    super().__init__(message)
                    self.secs_until_reset = secs_until_reset


            def is_query_in_progress(query_response: Response) -> bool:
                if 'links' not in query_response.json():
                    return False
                elif 'Next' in [link['rel'] for link in query_response.json()['links']]:
                    return False
                elif 'Self' in [link['rel'] for link in query_response.json()['links']]:
                    return True
                raise Exception('LogSearch query returned an invalid response body according to their spec '
                                '- contains a "links" object, which does not contain a link with either '
                                '"rel" equal to "Next" or "Self"')


            def poll_request_to_completion(logsearch_session: Session,
                                           query_in_progress_response: Response) -> Response:
                """
                "continuation" polls expire after 10 seconds, so we must not wait too long between
                requests. However we must not poll too frequently for long-running queries or we
                risk being rate limited.
                """
                if query_in_progress_response.status_code == 429:
                    secs_until_reset = query_in_progress_response.headers.get('X-RateLimit-Reset')
                    raise RateLimitedException(
                        f'Log Search API Key was rate limited. Seconds until rate limit reset: {secs_until_reset}',
                        int(secs_until_reset)
                    )

                if not is_query_in_progress(query_in_progress_response):
                    return query_in_progress_response

                poll_delay_secs = 0.5
                max_poll_delay_secs = 6
                links = {link['rel']: link['href'] for link in query_in_progress_response.json()['links']}
                while 'Self' in links:
                    time.sleep(poll_delay_secs)

                    resp = logsearch_session.get(links['Self'], headers={'x-api-key': API_KEY})

                    if resp.status_code == 429:
                        secs_until_reset = resp.headers.get('X-RateLimit-Reset')
                        raise RateLimitedException(
                         f'Log Search API Key was rate limited. Seconds until rate limit reset: {secs_until_reset}',
                         int(secs_until_reset)
                        )

                    if not is_query_in_progress(resp):
                        return resp

                    poll_delay_secs = min(poll_delay_secs * 2, max_poll_delay_secs)
                    links = {link['rel']: link['href'] for link in resp.json()['links']}


            def has_next_page(query_response: Response) -> bool:
                return 'links' in query_response.json() and \
                       'Next' in [link['rel'] for link in query_response.json()['links']]


            def get_next_page_of_results(logsearch_session: Session, resp: Response) -> Response:
                links = {link['rel']: link['href'] for link in resp.json()['links']}
                return logsearch_session.get(links['Next'], headers={'x-api-key': API_KEY})


            def perform_query(logsearch_session: Session) -> Response:
                try:
                    resp = poll_request_to_completion(
                        logsearch_session,
                        logsearch_session.get(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/'
                                    f'query/logs/{LOG_KEY}/{SAVED_QUERY_ID}',
                                    headers={'x-api-key': API_KEY},
                                    params={'from': FROM_TS_MILLIS, 'to': TO_TS_MILLIS})
                    )
                    print(json.dumps(resp.json(), indent=4))
                    return resp
                except RateLimitedException as e:
                    print(f'Log Search API Key was rate limited. Sleeping for {e.secs_until_reset} seconds')
                    time.sleep(e.secs_until_reset)
                    return perform_query(logsearch_session)


            session = Session()
            session.mount(
                f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                HTTPAdapter(max_retries=(
                    Retry(total=3,
                          backoff_factor=1,
                          status_forcelist=[500, 502, 503, 504],
                          respect_retry_after_header=False)  # Rate limiting must be handled explicitly
                ))
            )

            query_results_page = perform_query(session)

            while has_next_page(query_results_page):
                try:
                    print('Fetching next page of results')
                    query_results_page = poll_request_to_completion(
                        session,
                        get_next_page_of_results(session, query_results_page)
                    )
                    print(json.dumps(query_results_page.json(), indent=4))
                except RateLimitedException as e:
                    print(f'Log Search API Key was rate limited. Sleeping for {e.secs_until_reset} seconds')
                    time.sleep(e.secs_until_reset)
  /query/{id}:
    parameters:
      - $ref: '#/components/parameters/continuation_id'
    get:
      operationId: pollQuery
      summary: Poll a Query In Progress
      description: |
        Checks the status of the query with the **{continuation_id}** generated when the query started.  
        If the query is complete, the result is returned.  
        Otherwise: the progress (in percent) is reported, and a partial calculation or some partial search results may be returned.  

        It is important to note that if there are more than `per_page` events which match the query, then the response will only contain `per_page` events.  
        The remaining events can be returned by following the `Next` link in the response body.  

        Therefore to get all results for a specific time-range you will need to create a query, poll it to completion, create a new query using the `Next` link for next page, poll etc.
        There are two types of links in poll requests:
        - `Self`: current query/page of results isn't done, continue polling
        - `Next`: Current query/page is done, but if you wish to get the next/remaining events, create a new query for more events with this link
        There is a code example below for polling logic.

        The `time_range` metadata information for the query can only be tracked by the client,
        by providing it as a query parameter with every polling request, which will be returned as given in the response
        (does not affect the query execution - only metadata information).

        Links must be polled at least once **every 20 seconds** to avoid expiration. Be cautious of polling too frequently as that can lead to rate limiting. 
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Query Log Data
      parameters:
        - $ref: '#/components/parameters/time_range'
      responses:
        '200':
          description: Successful poll. Query is either done or on-going and response body may contain partial or full query results.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Polling'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsContinuation'
                  - $ref: '#/components/schemas/EventsResponse'
                  - $ref: '#/components/schemas/StatisticalContinuation'
                  - $ref: '#/components/schemas/StatisticalResponse'
              examples:
                EventsContinue:
                  $ref: '#/components/examples/EventsContinue'
                EventsResponseSimple:
                  $ref: '#/components/examples/EventsResponseSimple'
                EventsResponsePagination:
                  $ref: '#/components/examples/EventsResponsePagination'
                StatsContinueInitial:
                  $ref: '#/components/examples/StatsContinueInitial'
                StatisticalResponseSimple:
                  $ref: '#/components/examples/StatisticalResponseSimple'
                StatisticalResponseTimeSeriesMultiGroupBy:
                  $ref: '#/components/examples/StatisticalResponseTimeSeriesMultiGroupBy'
        '400':
          description: Invalid Continuation ID.
        '401':
          description: Unauthorized.
        '404':
          description: Query Not Found (Continuation ID may have expired).
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Polling'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            https://ca.rest.logs.insight.rapid7.com/query/c19c7d71-de32-4a6d-92b9-58e12dc38eb9:0:c5be1c97f925ee883347440071863897b83ef305:1:94b844d409485aa4152284708bf65f4b09d931f3:\
            ?time_range=last+1+day
        - lang: Python
          label: Python3
          source: "# This script should *NOT* be used in production.\n# It does not handle throttling, retries or statistical searches.\n# It merely runs an event search assuming a happy path to illustrate polling behaviour.\nimport time\nimport argparse\nimport requests\nimport typing\n\n\ndef make_request(*,\n                region: str,\n                query: str,\n                api_key: str,\n                logs: typing.List[str],\n                _from: int,\n                to: int):\n    HEADERS = {'x-api-key': api_key}\n\n    ALL_EVENTS = []\n\n    SESSION = requests.Session()\n    SESSION.headers.update(HEADERS)\n\n    r = SESSION.post(f'https://{region}.rest.logs.insight.rapid7.com/query/logs/',\n                      json={\n                            \"leql\": {\n                                \"during\": {\n                                    'from': _from,\n                                    'to': to,\n                                },\n                                \"statement\": query,\n                            },\n                            \"logs\": logs\n                      })\n    r.raise_for_status()\n    response_body = r.json()\n\n    while 'links' in response_body:\n        #   `Self` links = continue polling until you get the result.\n        #   `Next` links = link to create a new query to get further results (e.g. paginated responses),\n        #   if you have 200 loglines and you make a query to list them, you'll by default get 50 and will\n        #   need to hit the `Next` link to get the next 50\n\n        #\tCould be `Self` or `Next` link.\n        # \twe don't care, we want all results for the selected `time_range`.\n        r = SESSION.get(response_body['links'][0]['href'])\n        r.raise_for_status()\n        response_body = r.json()\n\n        if r.status_code == 200:\n            ALL_EVENTS.extend(response_body.get('events', []))\n\n    print(ALL_EVENTS)\n\n\ndef main():\n    parser = argparse.ArgumentParser(description='Make a request to LogSearch API.')\n\n    parser.add_argument('--region', '-r', required=True, help='API region.')\n    parser.add_argument('--query', '-q', default='', help='Query to run. Default is no query.')\n    parser.add_argument('--x-api-key', '-x', required=True)\n    parser.add_argument('--log', '-l', nargs='+', required=True, help='The logs to search.')\n    parser.add_argument('-f', type=int, help='From parameter.')\n    parser.add_argument('--to', '-t', type=int, help='To parameter.')\n\n    args = parser.parse_args()\n\n    make_request(region=args.region, query=args.query, api_key=args.x_api_key, logs=args.log, _from=args.f, to=args.to)\n\n\nif __name__ == '__main__':\n    main()\n"
  /query/saved_queries:
    get:
      operationId: listSavedQueries
      summary: List All Saved Queries
      description: |
        For more context on saved queries, as well as instructions on handling rate limits consult [this section's introduction](#tag/Saved-Queries).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Saved Queries
      responses:
        '200':
          description: Saved Queries in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                type: object
                properties:
                  saved_queries:
                    description: All the saved queries for this account.
                    type: array
                    items:
                      $ref: '#/components/schemas/saved_query'
              example:
                saved_queries:
                  - id: 00000000-0000-10d0-0000-000000000000
                    name: QQPP_NoLogs_YesTime
                    leql:
                      statement: where(931dde6c60>=800)
                      during:
                        time_range: last 1 day
                        to: null
                        from: null
                    logs: []
                  - id: 00000000-0000-00cf-0000-000000000000
                    name: QQPP_YesLogs_NoTime
                    leql:
                      statement: where(931dde6c60>=800)
                      during:
                        time_range: null
                        to: null
                        from: null
                    logs:
                      - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                      - c78579a8-8b20-4e6a-d4c0-5287198a263b
        '401':
          description: Unauthorized.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            https://us.rest.logs.insight.rapid7.com/query/saved_queries/
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region


            def list_saved_queries(s: Session) -> None:
                response = s.get(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/query/saved_queries',
                                 headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                list_saved_queries(session)
    post:
      operationId: postSavedQueryRoot
      summary: Create A Saved Query
      description: |
        For more context on saved queries, as well as instructions on handling rate limits consult [this section's introduction](#tag/Saved-Queries).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Saved Queries
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/create_saved_query'
            example:
              saved_query:
                name: Large Values Yesterday
                leql:
                  statement: where(931dde6c60>=800)
                  during:
                    time_range: yesterday
                    to: null
                    from: null
                logs:
                  - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                  - c78579a8-8b20-4e6a-d4c0-5287198a263b
      responses:
        '201':
          description: Saved Query Created. ID in Response.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/saved_query'
              example:
                saved_query:
                  id: 00000000-0000-10d0-0000-000000000000
                  name: Large Values Yesterday
                  leql:
                    statement: where(931dde6c60>=800)
                    during:
                      time_range: yesterday
                      to: null
                      from: null
                  logs:
                    - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                    - c78579a8-8b20-4e6a-d4c0-5287198a263b
        '400':
          description: Saved Query Specified in Payload Invalid.
        '401':
          description: Unauthorized.
        '415':
          description: Non-JSON request body was given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            -H 'Content-Type: application/json' \
            -X POST \
            --data '{"saved_query":{"name":"Large Values Yesterday","leql":{"statement":"where(931dde6c60>=800)","during":{"time_range":"yesterday"}},"logs":["565c1b7b-c08b-4c87-a42a-ab08bad56071","c78579a8-8b20-4e6a-d4c0-5287198a263b"]}}' \
            https://us.rest.logs.insight.rapid7.com/query/saved_queries
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            SAVED_QUERY = {
                'saved_query': {
                    'name': 'saved query example - no logs',
                    "leql": {
                        'statement': 'where("") calculate(count)'
                    }
                }
            }


            def create_saved_query(s: Session) -> None:
                response = s.post(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/query/saved_queries',
                                  headers={'x-api-key': API_KEY},
                                  json=SAVED_QUERY)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                create_saved_query(session)
  /query/saved_queries/{saved_query_id}:
    parameters:
      - $ref: '#/components/parameters/saved_query_id'
    get:
      operationId: getSavedQueryId
      summary: Retrieve A Saved Query
      description: |
        For more context on saved queries, as well as instructions on handling rate limits consult [this section's introduction](#tag/Saved-Queries).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Saved Queries
      responses:
        '200':
          description: Saved Query in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/saved_query'
              example:
                saved_query:
                  id: 00000000-0000-10d0-0000-000000000000
                  name: Large Values Yesterday
                  leql:
                    statement: where(931dde6c60>=800)
                    during:
                      time_range: yesterday
                      to: null
                      from: null
                  logs:
                    - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                    - c78579a8-8b20-4e6a-d4c0-5287198a263b
        '401':
          description: Unauthorized.
        '404':
          description: Saved Query Not Found.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            https://ap.rest.logs.insight.rapid7.com/query/saved_queries/00000000-0000-10d0-0000-000000000000
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            SAVED_QUERY_ID = 'YOUR SAVED QUERY ID GOES HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region


            def get_saved_query(s: Session) -> None:
                response = s.get(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/query/saved_queries/{SAVED_QUERY_ID}',
                                 headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                get_saved_query(session)
    put:
      operationId: putSavedQueryId
      summary: Replace A Saved Query
      description: |
        Replace a saved query with the details specified in the JSON request body. If the saved query you are replacing
        contains a time range and the request body does not contain a time range, then the existing time range is retained.

        For more context on saved queries, as well as instructions on handling rate limits consult [this section's introduction](#tag/Saved-Queries).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Saved Queries
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/create_saved_query'
            example:
              saved_query:
                name: Large Values Yesterday
                leql:
                  statement: where(931dde6c60>=800)
                  during:
                    time_range: yesterday
                    to: null
                    from: null
                logs:
                  - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                  - c78579a8-8b20-4e6a-d4c0-5287198a263b
      responses:
        '200':
          description: Success. New Saved Query in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/saved_query'
              example:
                saved_query:
                  id: 00000000-0000-10d0-0000-000000000000
                  name: Large Values Yesterday
                  leql:
                    statement: where(931dde6c60>=800)
                    during:
                      time_range: yesterday
                      to: null
                      from: null
                  logs:
                    - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                    - c78579a8-8b20-4e6a-d4c0-5287198a263b
        '400':
          description: Saved Query Specified in Payload Invalid.
        '401':
          description: Unauthorized.
        '404':
          description: Saved Query Not Found.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key:  b865a2555-ab43-4297-a894-a9b5bffb6395' \
            -H 'Content-Type: application/json' \
            -X PUT \
            --data '{"saved_query":{"name":"Large Values Yesterday","leql":{"statement":"where(931dde6c60>=800)","during":{"time_range":"yesterday"}},"logs":["565c1b7b-c08b-4c87-a42a-ab08bad56071","c78579a8-8b20-4e6a-d4c0-5287198a263b"]}}' \
            https://us.rest.logs.insight.rapid7.com/query/saved_queries/00000000-0000-10d0-0000-000000000000
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            SAVED_QUERY_ID = 'YOUR SAVED QUERY ID GOES HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            SAVED_QUERY = {
                'saved_query': {
                    'name': 'replaced saved query example',
                    "leql": {
                        'statement': 'where("") calculate(count)'
                    }
                }
            }


            def replace_saved_query(s: Session) -> None:
                response = s.put(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/query/saved_queries/{SAVED_QUERY_ID}',
                                 headers={'x-api-key': API_KEY},
                                 json=SAVED_QUERY)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                replace_saved_query(session)
    patch:
      operationId: patchSavedQueryId
      summary: Modify A Saved Query
      description: |
        Replace one or more individual details of a saved query with the details specified in the JSON request body.
        Cannot be used to remove the time range for a saved query (by replacing the time range with null value).

        For more context on saved queries, as well as instructions on handling rate limits consult [this section's introduction](#tag/Saved-Queries).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Saved Queries
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/patch_saved_query'
            example:
              saved_query:
                leql:
                  statement: where(key1 <= 2 AND key2 > 8) groupby(key1, key2) timeslice(5)
      responses:
        '200':
          description: Success. Modified Saved Query in Response Body
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/saved_query'
              example:
                saved_query:
                  id: 00000000-0000-10d0-0000-000000000000
                  name: Large Values Yesterday
                  leql:
                    statement: where(931dde6c60>=800)
                    during:
                      time_range: yesterday
                      to: null
                      from: null
                  logs:
                    - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                    - c78579a8-8b20-4e6a-d4c0-5287198a263b
        '400':
          description: Query Parameter Value(s) Specified in Payload Invalid.
        '401':
          description: Unauthorized.
        '404':
          description: Saved Query Not Found.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            -H 'Content-Type: application/json' \
            -X PATCH \
            --data '{"saved_query":{"leql":{"statement":"where(931dde6c60>=800)"}}}' \
            https://ap.rest.logs.insight.rapid7.com/query/saved_queries/00000000-0000-10d0-0000-000000000000
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            SAVED_QUERY_ID = 'YOUR SAVED QUERY ID GOES HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            SAVED_QUERY = {
                'saved_query': {
                    "leql": {
                        'statement': 'where("")'
                    }
                }
            }


            def modify_saved_query(s: Session) -> None:
                response = s.patch(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/query/'
                                   f'saved_queries/{SAVED_QUERY_ID}',
                                   headers={'x-api-key': API_KEY},
                                   json=SAVED_QUERY)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                modify_saved_query(session)
    delete:
      operationId: deleteSavedQueryId
      summary: Delete A Saved Query
      description: |
        For more context on saved queries, as well as instructions on handling rate limits consult [this section's introduction](#tag/Saved-Queries).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Saved Queries
      responses:
        '204':
          description: Resource Deleted Successfully.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          description: Unauthorized.
        '404':
          description: Saved Query Not Found.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            -X DELETE \
            https://us.rest.logs.insight.rapid7.com/query/saved_queries/00000000-0000-10d0-0000-000000000000
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            SAVED_QUERY_ID = 'YOUR SAVED QUERY ID GOES HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region


            def delete_saved_query(s: Session) -> None:
                response = s.delete(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/query/'
                                    f'saved_queries/{SAVED_QUERY_ID}',
                                    headers={'x-api-key': API_KEY})
                if response.status_code == 204:
                    print(f'Deleted {SAVED_QUERY_ID}')
                else:
                    print(f'Failed to delete saved query. status_code={response.status_code}')
                    print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                delete_saved_query(session)
  /query/variables:
    get:
      summary: List all LEQL variables
      description: |
        For more context on LEQL variables, as well as instructions on handling rate limits consult [this section's introduction](#tag/Leql-Variables).
      operationId: listVariables
      tags:
        - LEQL Variables
      security:
        - Api Key Authentication:
            - Read Only or Above
      responses:
        '200':
          description: List of Variables in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                type: object
                properties:
                  variables:
                    type: array
                    items:
                      $ref: '#/components/schemas/leql_variable_response'
        '401':
          description: Unauthorized.
        '403':
          description: Forbidden.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
    post:
      summary: Create a LEQL variable
      description: |
        For more context on LEQL variables, as well as instructions on handling rate limits consult [this section's introduction](#tag/Leql-Variables).
      operationId: createVariable
      tags:
        - LEQL Variables
      security:
        - Api Key Authentication:
            - Read Write or Above
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                variable:
                  $ref: '#/components/schemas/leql_variable_request'
      responses:
        '201':
          description: Created Variable in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                type: object
                properties:
                  variable:
                    $ref: '#/components/schemas/leql_variable_response'
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '403':
          description: Forbidden.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
  /query/variables/{id}:
    get:
      summary: Retrieve a LEQL variable
      description: |
        For more context on LEQL variables, as well as instructions on handling rate limits consult [this section's introduction](#tag/Leql-Variables).
      operationId: retrieveVariable
      tags:
        - LEQL Variables
      security:
        - Api Key Authentication:
            - Read Only or Above
      responses:
        '200':
          description: LEQL Variable in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                type: object
                properties:
                  variable:
                    $ref: '#/components/schemas/leql_variable_response'
        '401':
          description: Unauthorized.
        '403':
          description: Forbidden.
        '404':
          description: Not Found.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
    delete:
      summary: Delete a LEQL variable
      description: |
        For more context on LEQL variables, as well as instructions on handling rate limits consult [this section's introduction](#tag/Leql-Variables).
      operationId: deleteVariable
      tags:
        - LEQL Variables
      security:
        - Api Key Authentication:
            - Read Write or Above
      responses:
        '204':
          description: Variable Deleted.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          description: Unauthorized.
        '403':
          description: Forbidden.
        '404':
          description: Not Found.
        '409':
          description: Variable Cannot Be Deleted As It Is In Use.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
    put:
      summary: Update a LEQL variable
      description: |
        Updates a variable that belongs to the authenticated account. Only the value of the variable can be updated. 
        The variable name cannot be updated.

        For more context on LEQL variables, as well as instructions on handling rate limits consult [this section's introduction](#tag/Leql-Variables).
      operationId: updateVariable
      tags:
        - LEQL Variables
      security:
        - Api Key Authentication:
            - Read Write or Above
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                variable:
                  $ref: '#/components/schemas/leql_variable_request'
      responses:
        '200':
          description: Updated Variable in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                type: object
                properties:
                  variable:
                    $ref: '#/components/schemas/leql_variable_response'
        '400':
          description: Invalid Request
        '401':
          description: Unauthorized.
        '403':
          description: Forbidden.
        '409':
          description: Variable Cannot Be Updated As It Will Break A Detection Rule Or Pre-Computed Query.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
  /query/live/logs/{log_keys}:
    parameters:
      - $ref: '#/components/parameters/log_keys_live_tail_deprecated'
    get:
      operationId: getLiveLogs
      summary: Start A Live Tail Feed (Individual Logs)
      description: |
        Starts a Live Tail feed on the logs with those **{log_keys}**, for the Query specified in the URL parameters.
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Watch Incoming Log Data In Realtime
      parameters:
        - $ref: '#/components/parameters/query_live_tail'
        - $ref: '#/components/parameters/mode'
        - $ref: '#/components/parameters/label'
        - $ref: '#/components/parameters/labels'
        - $ref: '#/components/parameters/per_page_live_tail'
      responses:
        '200':
          description: Live Tail feed started. Response body contains link to poll the feed.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LiveTailResponse'
              example:
                logs:
                  - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                leql:
                  statement: where(/f9697e0/)
                events: []
                links:
                  - rel: Next
                    href: https://ap.rest.logs.insight.rapid7.com/query/live/369640e6-5f93-468d-a6db-d378c7c37756:0:9a3ec09650da40feb64849c5e7bd56379ec9eca9:1:bc5b04ad709824b098f977e04ce729b42835b985:?log_keys=565c1b7b-c08b-4c87-a42a-ab08bad56071&query=where%28%2Ff9697e0%2F%29
        '400':
          description: Invalid URL Query Parameters.
        '401':
          description: Unauthorized
        '404':
          description: Log Not Found.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            -G \
            --data-urlencode query="where(/f9697e0/)" \
            --data mode="head" \
            --data label="00000000-0000-0000-0000-000000000001" \
            https://ap.rest.logs.insight.rapid7.com/query/live/logs/f558ea24-c213-8b99-9a33-8a498121677a
        - lang: Python
          label: Python3
          source: |
            import requests
            import json

            API_KEY = 'YOUR API KEY GOES HERE'
            LOG_KEY = 'YOUR LOG KEY GOES HERE'

            def continue_request(req):
                if 'links' in req.json():
                    continue_url = req.json()['links'][0]['href']
                    new_response = make_request(continue_url)
                    handle_response(new_response)


            def handle_response(resp):
                response = resp

                if response.status_code == 200:
                    print(json.dumps(resp.json(), indent=4))
                    continue_request(resp)
                    return

                if response.status_code > 202:
                    print('Error status code ' + str(response.status_code))
                    return


            def make_request(provided_url=None):
                headers = {'x-api-key': API_KEY}

                url = f"https://us.rest.logs.insight.rapid7.com/query/live/logs/{LOG_KEY}?query=where(foobar)"
                if provided_url:
                    url = provided_url
                req = requests.get(url, headers=headers)
                return req


            def print_query():
                req = make_request()
                handle_response(req)

            def start():
                print_query()


            if __name__ == '__main__':
                start()
  /query/live/logs:
    post:
      operationId: postLiveLogs
      summary: Start A Live Tail Feed (Multiple Logs)
      description: |
        Starts a Live Tail feed, where the logs and the query for the feed are specified in the (JSON) request body.

        An arbitrary collection of logs can be specified in the request body.
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Watch Incoming Log Data In Realtime
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                logs:
                  $ref: '#/components/schemas/logs_live_tail'
                leql:
                  $ref: '#/components/schemas/leql_live_tail'
              example:
                logs:
                  - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                  - c78579a8-8b20-4e6a-d4c0-5287198a263b
                leql:
                  statement: where(/f9697e0/)
              required:
                - logs
      parameters:
        - $ref: '#/components/parameters/labels'
      responses:
        '200':
          description: Live Tail feed started. Response body contains link to poll the feed.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LiveTailResponse'
              example:
                logs:
                  - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                leql:
                  statement: where(/f9697e0/)
                events: []
                links:
                  - rel: Next
                    href: https://ap.rest.logs.insight.rapid7.com/query/live/369640e6-5f93-468d-a6db-d378c7c37756:0:9a3ec09650da40feb64849c5e7bd56379ec9eca9:1:bc5b04ad709824b098f977e04ce729b42835b985:?log_keys=565c1b7b-c08b-4c87-a42a-ab08bad56071&query=where%28%2Ff9697e0%2F%29
        '400':
          description: Malformed JSON Request Body.
        '401':
          description: Unauthorized.
        '404':
          description: Log(s) Not Found.
        '415':
          description: Data not specified as JSON.
        '429':
          description: Rate Limited.
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            -H 'Content-Type: application/json' \
            -X POST \
            --data '{"logs": ["565c1b7b-c08b-4c87-a42a-ab08bad56071","c78579a8-8b20-4e6a-d4c0-5287198a263b"],"leql":{"statement":"where(/f9697e0/)"}}' \
            https://ap.rest.logs.insight.rapid7.com/query/live/logs
  /query/live/saved_query/{saved_query_id}:
    get:
      operationId: liveSavedQuery
      summary: Start a Live Tail Feed (Saved Query - with logs)
      description: |
        Starts a Live Tail Feed using the saved query which has id **{saved_query_id}**.

        This endpoint can only be used for saved queries which *have* the logs for the live tail feed already specified.
        For saved queries which *don't have* the logs already specified, use the
        [/query/live/logs/{log_keys}/{saved_query_id}](#operation/liveSavedQueryNoLogs) endpoint.

        Saved queries which have a *time range* already specified can still be used (the time range is ignored).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Watch Incoming Log Data In Realtime
      parameters:
        - $ref: '#/components/parameters/saved_query_id'
        - $ref: '#/components/parameters/per_page_live_tail'
        - $ref: '#/components/parameters/mode'
      responses:
        '200':
          description: Live Tail feed started. Response body contains link to poll the feed.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LiveTailResponse'
              example:
                logs:
                  - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                leql:
                  statement: where(/f9697e0/)
                events: []
                links:
                  - rel: Next
                    href: https://ap.rest.logs.insight.rapid7.com/query/live/369640e6-5f93-468d-a6db-d378c7c37756:0:9a3ec09650da40feb64849c5e7bd56379ec9eca9:1:bc5b04ad709824b098f977e04ce729b42835b985:?log_keys=565c1b7b-c08b-4c87-a42a-ab08bad56071&query=where%28%2Ff9697e0%2F%29
        '400':
          description: URL Query Parameters Invalid.
        '401':
          description: Unauthorized.
        '404':
          description: Saved Query Not Found.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
        '500':
          description: Internal Server Error.
    x-code-samples:
      - lang: Shell
        label: curl
        source: |
          curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
          -G \
          --data per_page=100 \
          --data mode=head \
          https://us.rest.logs.insight.rapid7.com/query/live/saved_query/00000000-0000-01cf-0000-000000000000
  /query/live/logs/{log_keys}/{saved_query_id}:
    get:
      operationId: liveSavedQueryNoLogs
      summary: Start a Live Tail Feed (Saved Query - without logs)
      description: |
        Starts a Live Tail Feed using the saved query which has the id **{saved_query_id}**
        on the logs matching the **{log_keys}**.

        This endpoint can only be used for saved queries which *don't have* the logs for the query already specified.
        For saved queries which *have* the logs already specified, use the
        [/query/live/saved_query/{saved_query_id}](#operation/liveSavedQuery) endpoint.

        Saved queries which have a *time range* already specified can still be used (the time range is ignored).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Watch Incoming Log Data In Realtime
      parameters:
        - $ref: '#/components/parameters/log_keys_live_tail'
        - $ref: '#/components/parameters/saved_query_id'
        - $ref: '#/components/parameters/per_page_live_tail'
        - $ref: '#/components/parameters/mode'
      responses:
        '200':
          description: Live Tail feed started. Response body contains link to poll the feed.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LiveTailResponse'
              example:
                logs:
                  - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                leql:
                  statement: where(/f9697e0/)
                events: []
                links:
                  - rel: Next
                    href: https://ap.rest.logs.insight.rapid7.com/query/live/369640e6-5f93-468d-a6db-d378c7c37756:0:9a3ec09650da40feb64849c5e7bd56379ec9eca9:1:bc5b04ad709824b098f977e04ce729b42835b985:?log_keys=565c1b7b-c08b-4c87-a42a-ab08bad56071&query=where%28%2Ff9697e0%2F%29
        '400':
          description: URL Query Parameters Invalid.
        '401':
          description: Unauthorized.
        '404':
          description: Log(s) or Saved Query Not Found.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            -G \
            --data per_page=100 \
            --data mode=head \
            https://eu.rest.logs.insight.rapid7.com/query/live/logs/626c8841-feb2-4a45-32a8-5224e4cc6ecf:f558ea24-c213-8b99-9a33-8a498121677a/00000000-0000-01cf-0000-000000000000
  /query/live/{id}:
    parameters:
      - $ref: '#/components/parameters/live_tail_poll_id'
    get:
      operationId: pollLiveTail
      summary: Poll a Live Tail Feed
      description: |
        Polls the Live Tail Feed with the corresponding **{id}**, returning all the log entries for the Feed since the
        since last time the Feed was polled. If the number of log entries exceeds 50 (by default),
        only 50 log entries will be returned, and the next "page" is returned on the next poll.

        The `log_keys` and `query` metadata information for the Live Tail Feed can only be tracked by the client,
        by providing it as a query parameter with every polling request, which will be returned as given in the response
        (does not affect the query execution - only metadata information).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Watch Incoming Log Data In Realtime
      parameters:
        - $ref: '#/components/parameters/query_live_tail'
        - $ref: '#/components/parameters/log_keys_live_tail_query_param'
      responses:
        '200':
          description: Feed Polled Succesfully. Response body contains results.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LiveTailPollResponse'
              example:
                logs:
                  - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                leql:
                  statement: where(/f9697e0/)
                events:
                  - labels:
                      - links:
                          - rel: Self
                            href: https://ap.rest.logs.insight.rapid7.com/management/labels/00000000-0000-0000-0000-000000000001
                        id: 00000000-0000-0000-0000-000000000001
                    timestamp: 1609629969390
                    sequence_number: 2234733321019952000
                    log_id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
                    message: '{"931dde6c60":899}'
                    sequence_number_str: 2234733321019952000
                  - labels:
                      - links:
                          - rel: Self
                            href: https://ap.rest.logs.insight.rapid7.com/management/labels/00000000-0000-0000-0000-000000000001
                        id: 00000000-0000-0000-0000-000000000001
                    timestamp: 1609629978988
                    sequence_number: 223473332134561250
                    log_id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
                    message: '{"931dde6c60":931}'
                    sequence_number_str: 2234733321345612300
                links:
                  - rel: Next
                    href: https://ap.rest.logs.insight.rapid7.com/query/live/369640e6-5f93-468d-a6db-d378c7c37756:0:9a3ec09650da40feb64849c5e7bd56379ec9eca9:1:bc5b04ad709824b098f977e04ce729b42835b985:?log_keys=565c1b7b-c08b-4c87-a42a-ab08bad56071&query=where%28%2Ff9697e0%2F%29
        '400':
          description: Invalid Polling Id.
        '401':
          description: Unauthorized.
        '404':
          description: Feed Not Found (Polling id may have expired).
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            "https://ca.rest.logs.insight.rapid7.com/query/live/f8550e83-83f2-4345-8f0e-cb10bc2bf023:2:::e5af7af8b2266b984e382305672331297b8a13c7:\
            ?log_keys=565c1b7b-c08b-4c87-a42a-ab08bad56071%3Ac78579a8-8b20-4e6a-d4c0-5287198a263b\
            &query=where%28%2F.%2A%2F%29"
  /query/context/{id}:
    parameters:
      - $ref: '#/components/parameters/context_id'
    get:
      operationId: getContextEvents
      summary: Retrieve The Log Data Immediately Before And After A Specific Log Line
      description: |
        Submit a query to retrieve the log entries immediately before, after, or both, a specific 
        log entry, which is identified by the log key, the timestamp of the log entry, and its sequence number 
        (a number used to distinguish between log entries received within the same millisecond).

        The log entries included in the query result are those before, after, or both, the specified the log entry, 
        until there is a gap of 60 seconds between log entries. For example:
        1. an entry "entry1" is ingested,
        2. 61 seconds later, entries "entry2", "entry3", and "entry4" are ingested,
        3. 61 seconds later, an entry "entry5" is ingested,

        then the events that are "immediately before or after" (or both) "entry3" will consist of {"entry2", "entry3", "entry4"}.

        For instructions on polling a query until it is completed, handling pagination, and handling rate limits, consult
        [this section's introduction](#tag/Query-Log-Data). However, note that this endpoint is unique in that it also supports
         backwards pagination through the **Prev** link in the `links` array of the response, which behaves in the same way
         as regular pagination which uses the **Next** link.
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Query Log Data
      parameters:
        - $ref: '#/components/parameters/timestamp_context'
        - $ref: '#/components/parameters/log_keys_context'
        - $ref: '#/components/parameters/context_type'
        - $ref: '#/components/parameters/per_page'
        - $ref: '#/components/parameters/kvp_info'
        - $ref: '#/components/parameters/most_recent_first'
      responses:
        '200':
          description: Results in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContextResponse'
              example:
                logs:
                  - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                leql:
                  during:
                    from: 1609607464184
                    to: 1609607425423
                  statement: null
                events:
                  - timestamp: 1609607464184
                    labels: []
                    sequence_number: 3234729357407797000
                    log_id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
                    message: '{"c1462807f1":476}'
                    sequence_number_str: 3234729357407797000
                  - timestamp: 1609607425423
                    labels: []
                    sequence_number: 3234729357408735000
                    log_id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
                    message: '{"c1462807f1":60}'
                    sequence_number_str: 3234729357408735000
                links:
                  - rel: Prev
                    href: https://us.rest.logs.insight.rapid7.com/query/context/3234729357407797248?per_page=2&timestamp=1609607423861&log_keys=565c1b7b-c08b-4c87-a42a-ab08bad56071&context_type=BEFORE
                  - rel: Next
                    href: https://us.rest.logs.insight.rapid7.com/query/context/3234729357408735232?per_page=2&timestamp=1609607425423&log_keys=565c1b7b-c08b-4c87-a42a-ab08bad56071&context_type=AFTER
        '202':
          description: Query in progress. Link to poll the query in response body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContextContinueResponse'
              example:
                logs:
                  - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                leql:
                  during:
                    from: 1609607464184
                    to: 1609607425423
                  statement: null
                progress: 0
                id: '3691ef95-3255-4a48-929a-31f6e51d22ba:3:221803f2d033dd172005be356617ef04bbb75d42:50:c9a2b1aa85fd4e169dbeced848e3ff44c6fb2392:'
                events: []
                links:
                  - rel: Self
                    href: 'https://us.rest.logs.insight.rapid7.com/query/3691ef95-3255-4a48-929a-31f6e51d22ba:3:221803f2d033dd172005be356617ef04bbb75d42:50:c9a2b1aa85fd4e169dbeced848e3ff44c6fb2392:'
        '400':
          description: Invalid Context Request.
        '401':
          description: Unauthorized.
        '404':
          description: Log not found, or invalid sequence number.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            -G \
            --data context_type="SURROUND" \
            --data timestamp=1609607464185 \
            --data log_keys=f558ea24-c213-8b99-9a33-8a498121677a \
            https://us.rest.logs.insight.rapid7.com/query/context/3234729357719937024
        - lang: Python
          label: Python3.10
          source: |
            import json
            import time
            from requests import Response, Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            LOG_KEY = 'YOUR LOG KEY HERE'
            LOG_LINE_TIMESTAMP_MS = 1684763050964
            LOG_LINE_SEQUENCE_NUMBER = 3237124846739517440
            DATA_STORAGE_REGION = 'eu'  # Swap for your region


            class RateLimitedException(Exception):
                def __init__(self, message: str, secs_until_reset: int):
                    super().__init__(message)
                    self.secs_until_reset = secs_until_reset


            def is_query_in_progress(query_response: Response) -> bool:
                if 'links' not in query_response.json():
                    return False
                elif 'Next' in [link['rel'] for link in query_response.json()['links']]:
                    return False
                elif 'Self' in [link['rel'] for link in query_response.json()['links']]:
                    return True
                raise Exception('LogSearch query returned an invalid response body according to their spec '
                                '- contains a "links" object, which does not contain a link with either '
                                '"rel" equal to "Next" or "Self"')


            def poll_request_to_completion(logsearch_session: Session,
                                           query_in_progress_response: Response) -> Response:
                """
                "continuation" polls expire after 10 seconds, so we must not wait too long between
                requests. However we must not poll too frequently for long-running queries or we
                risk being rate limited.
                """
                if query_in_progress_response.status_code == 429:
                    secs_until_reset = query_in_progress_response.headers.get('X-RateLimit-Reset')
                    raise RateLimitedException(
                        f'Log Search API Key was rate limited. Seconds until rate limit reset: {secs_until_reset}',
                        int(secs_until_reset)
                    )

                if not is_query_in_progress(query_in_progress_response):
                    return query_in_progress_response

                poll_delay_secs = 0.5
                max_poll_delay_secs = 6
                links = {link['rel']: link['href'] for link in query_in_progress_response.json()['links']}
                while 'Self' in links:
                    time.sleep(poll_delay_secs)

                    resp = logsearch_session.get(links['Self'], headers={'x-api-key': API_KEY})

                    if resp.status_code == 429:
                        secs_until_reset = resp.headers.get('X-RateLimit-Reset')
                        raise RateLimitedException(
                         f'Log Search API Key was rate limited. Seconds until rate limit reset: {secs_until_reset}',
                         int(secs_until_reset)
                        )

                    if not is_query_in_progress(resp):
                        return resp

                    poll_delay_secs = min(poll_delay_secs * 2, max_poll_delay_secs)
                    links = {link['rel']: link['href'] for link in resp.json()['links']}


            def perform_query(logsearch_session: Session) -> Response:
                try:
                    resp = poll_request_to_completion(
                        logsearch_session,
                        logsearch_session.get(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com'
                                              f'/query/context/{LOG_LINE_SEQUENCE_NUMBER}',
                                              headers={'x-api-key': API_KEY},
                                              params={'timestamp': LOG_LINE_TIMESTAMP_MS,
                                                      'log_keys': LOG_KEY,
                                                      'context_type': 'SURROUND'})
                    )
                    print(json.dumps(resp.json(), indent=4))
                    return resp
                except RateLimitedException as e:
                    print(f'Log Search API Key was rate limited. Sleeping for {e.secs_until_reset} seconds')
                    time.sleep(e.secs_until_reset)
                    return perform_query(logsearch_session)


            session = Session()
            session.mount(
                f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                HTTPAdapter(max_retries=(
                    Retry(total=3,
                          backoff_factor=1,
                          status_forcelist=[500, 502, 503, 504],
                          respect_retry_after_header=False)  # Rate limiting must be handled explicitly
                ))
            )

            query_results_page = perform_query(session)
            print(json.dumps(query_results_page.json(), indent=4))

            # Note that this script does not handle any additional backwards/forwards pagination, to
            # fetch additional contextual log lines.
  /query/metrics/{id}:
    parameters:
      - $ref: '#/components/parameters/metrics_id'
    get:
      operationId: queryMetrics
      summary: Fetch Query Results
      description: |
        For more context on pre-computed queries, as well as instructions on handling rate limits consult [this section's introduction](#tag/Pre-Computed-Queries).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Pre-Computed Queries
      parameters:
        - $ref: '#/components/parameters/time_range'
        - $ref: '#/components/parameters/from'
        - $ref: '#/components/parameters/to'
      responses:
        '200':
          description: Query Results in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MetricsResponse'
              example:
                id: 23cf23a8-9b9b-4b6e-b45f-5cbd19544f28
                logs:
                  - id: 022c2fc5-f9a0-4600-bd72-8d8d14bb1523
                    name: myLog
                    tokens:
                      - 6033f349-4c08-4737-ada6-612515dcfa42
                    structures: []
                    user_data:
                      le_agent_filename: ''
                      le_agent_follow: 'false'
                    source_type: token
                    token_seed: null
                    retention_period: default
                    links:
                      - rel: Related
                        href: https://us.rest.logs.insight.rapid7.com/management/logs/022c2fc5-f9a0-4600-bd72-8d8d14bb1523/topkeys
                    rrn: rrn:logsearch:us:02abbff1-a1ed-452a-86eb-568bfb87e93e:log:022c2fc5-f9a0-4600-bd72-8d8d14bb1523
                    member_info:
                      - id: 89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                        name: myLogset
                        rrn: rrn:logsearch:us:3a80d6bd-a051-43bf-a889-60cee58d8b41:logset:89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                        links:
                          - rel: Self
                            href: https://ap.rest.logs.insight.rapid7.com/log_search/management/logsets/89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                leql:
                  statement: where(foo>10 AND bar!=0 OR /some_reg[ex]*/)
                  function: calculate(count)
                  from: 1609502658000
                  to: 1609503558000
                statistics:
                  type: COUNT
                  resolution: 300
                  result: 377
                  timeseries:
                    - time: 1609502658000
                      value: 100
                    - time: 1609502958000
                      value: 100
                    - time: 1609503258000
                      value: 177
        '400':
          description: Invalid Query Request.
        '401':
          description: Unauthorized.
        '404':
          description: Metric Not Found.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
        '503':
          description: Service Unavailable.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: b865a2555-ab43-4297-a894-a9b5bffb6395' \
            -G \
            --data from=1609502658000 \
            --data to=1610539458000 \
            https://us.rest.logs.insight.rapid7.com/query/metrics/23cf23a8-9b9b-4b6e-b45f-5cbd19544f28
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            PCQ_ID = "YOUR PRE-COMPUTED QUERY ID"
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            TIME_RANGE = "last 1 week"


            def fetch_pcq_results(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/"
                                 f"query/metrics/{PCQ_ID}",
                                 headers={'x-api-key': API_KEY},
                                 params={"time_range": TIME_RANGE})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                fetch_pcq_results(session)
  /management/tags:
    get:
      operationId: getManagementTags
      summary: List All Tags
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      responses:
        '200':
          description: Basic Detection Rules in Response Body
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                type: object
                properties:
                  tags:
                    description: All the basic detection rules for this account.
                    type: array
                    items:
                      oneOf:
                        - $ref: '#/components/schemas/basic_tag_response'
                        - $ref: '#/components/schemas/tag_inactivity_alert_response'
                        - $ref: '#/components/schemas/tag_anomaly_alert_response'
              example:
                tags:
                  - type: Alert
                    id: cfd65778-45ff-4300-9b3e-98c752ac2661
                    name: Login Failure
                    description: Tag for login failure
                    sources:
                      - id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
                        retention_period: default
                        token: c78579a8-8b20-4e6a-d4c0-5287198a263b
                        name: auth.log
                        stored_days: []
                    actions:
                      - id: 022c2fc5-f9a0-4600-bd72-8d8d14bb1523
                        min_matches_count: 1
                        max_matches_count: 100
                        min_report_count: 1
                        max_report_count: 1
                        min_matches_period: Day
                        min_report_period: Day
                        targets:
                          - id: c299180b-d521-4c83-b64a-9a3ce795744h
                            name: Notification target Name
                            description: null
                            type: Mailto
                            params_set:
                              direct: user@example.com
                              teams: ''
                              users: user@example.com
                            user_data: null
                            alert_content_set:
                              le_context: true
                        enabled: true
                        type: Alert
                    leql:
                      statement: where(sunshine)
                    priority: 2
                    user_data:
                      product_type: OPS
                    labels:
                      - id: 59f51b58-c08a-41cc-5a5b-a688bad56071
                        sn: 1056
                        name: Login Failure
                        color: 007afb
                        reserved: false
        '401':
          description: Unauthorized.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region


            def list_all_basic_detection_rules(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/tags",
                                 headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                list_all_basic_detection_rules(session)
    post:
      operationId: postManagementTags
      summary: Create A Basic Detection Rule
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              oneOf:
                - $ref: '#/components/schemas/create_basic_tag'
                - $ref: '#/components/schemas/create_or_put_tag_inactivity_alert'
                - $ref: '#/components/schemas/create_tag_anomaly_alert'
            example:
              tag:
                name: Foo Bar Tag
                leql:
                  statement: where(/Foo Bar/)
                sources:
                  - id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
                type: Alert
                actions:
                  - enabled: true
                    min_matches_count: 0
                    min_matches_period: Hour
                    min_report_count: 1
                    min_report_period: Hour
                    targets:
                      - alert_content_set:
                          le_context: true
                        params_set:
                          direct: user@example.com
                          teams: ''
                          users: user@example.com
                        type: Mailto
                    type: Alert
                labels:
                  - color: 3498db
                    id: a6b486c1-306f-4575-95cc-0eee40f8f7e6
                    name: Test Label
                    reserved: false
                    sn: 1025
      responses:
        '201':
          description: Basic Detection Rule Created. ID in Response
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                type: object
                properties:
                  tag:
                    oneOf:
                      - $ref: '#/components/schemas/basic_tag_response'
                      - $ref: '#/components/schemas/tag_inactivity_alert_response'
                      - $ref: '#/components/schemas/tag_anomaly_alert_response'
              example:
                tag:
                  type: Alert
                  id: cfd65778-45ff-4300-9b3e-98c752ac2661
                  name: Foo Bar Tag
                  description: null
                  sources:
                    - id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
                      retention_period: default
                      token: c78579a8-8b20-4e6a-d4c0-5287198a263b
                      name: auth.log
                      stored_days: []
                  actions:
                    - id: 022c2fc5-f9a0-4600-bd72-8d8d14bb1523
                      min_matches_count: 1
                      min_report_count: 1
                      min_matches_period: Day
                      min_report_period: Day
                      targets:
                        - name: null
                          description: null
                          type: Mailto
                          params_set:
                            direct: user@example.com
                          user_data: null
                          alert_content_set:
                            le_context: true
                      enabled: true
                      type: Alert
                  leql:
                    statement: where(/Foo Bar/)
                  priority: 2
                  user_data: {}
                  labels:
                    - id: a6b486c1-306f-4575-95cc-0eee40f8f7e6
                      sn: 1025
                      name: Test Label
                      color: 3498db
                      reserved: false
        '400':
          description: Basic Detection Rule Specified In Request Body Invalid.
        '401':
          description: Unauthorized.
        '415':
          description: Non-JSON request body was given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            LOG_ID = 'YOUR LOG ID HERE'

            BASIC_DETECTION_RULE = {
                "tag": {
                    "actions": [
                        {
                            "enabled": True,
                            "min_matches_count": 0,
                            "min_matches_period": "Hour",
                            "min_report_count": 1,
                            "min_report_period": "Hour",
                            "targets": [
                                {
                                    "alert_content_set":
                                    {
                                        "le_context": "true"
                                    },
                                    "params_set": {
                                        "direct": "test@test.com",
                                    },
                                    "type": "mailto"
                                }
                            ],
                            "type": "Alert"
                        }
                    ],
                    "labels": [],
                    "name": "Foo Bar Tag",
                    "leql": {
                        "statement": "where(/Foo Bar/)"
                    },
                    "sources": [
                        {
                            "id": LOG_ID
                        }
                    ],
                    "type": "Alert"
                }
            }


            def create_basic_detection_rule(s: Session) -> None:
                response = s.post(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/tags",
                                  headers={'x-api-key': API_KEY},
                                  json=BASIC_DETECTION_RULE)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                create_basic_detection_rule(session)
  /management/tags/{rule_id}:
    parameters:
      - $ref: '#/components/parameters/tag_id'
    get:
      operationId: getManagementTagById
      summary: Retrieve a Basic Detection Rule
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      responses:
        '200':
          description: Basic Detection Rule in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                type: object
                properties:
                  tag:
                    oneOf:
                      - $ref: '#/components/schemas/basic_tag_response'
                      - $ref: '#/components/schemas/tag_inactivity_alert_response'
                      - $ref: '#/components/schemas/tag_anomaly_alert_response'
              example:
                tag:
                  type: Alert
                  id: cfd65778-45ff-4300-9b3e-98c752ac2661
                  name: Foo Bar Tag
                  description: null
                  sources:
                    - id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
                      retention_period: default
                      token: c78579a8-8b20-4e6a-d4c0-5287198a263b
                      name: auth.log
                      stored_days: []
                  actions:
                    - id: 022c2fc5-f9a0-4600-bd72-8d8d14bb1523
                      min_matches_count: 1
                      min_report_count: 1
                      min_matches_period: Day
                      min_report_period: Day
                      targets:
                        - name: null
                          description: null
                          type: Mailto
                          params_set:
                            direct: user@example.com
                          user_data: null
                          alert_content_set:
                            le_context: true
                      enabled: true
                      type: Alert
                  leql:
                    statement: where(/Foo Bar/)
                  priority: 2
                  user_data: {}
                  labels:
                    - id: a6b486c1-306f-4575-95cc-0eee40f8f7e6
                      sn: 1025
                      name: Test Label
                      color: 3498db
                      reserved: false
        '401':
          description: Unauthorized.
        '404':
          description: Basic Detection Rule Not Found.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = "acd86e59-10bd-4fc0-b9ed-9ae91fe76de8"
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            BASIC_DETECTION_RULE_ID = '17791813-6c46-4f45-9130-d5f7bdb13813'


            def get_basic_detection_rule(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                 f"/management/tags/{BASIC_DETECTION_RULE_ID}",
                                 headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                get_basic_detection_rule(session)
    put:
      operationId: putManagementTagById
      summary: Replace a Basic Detection Rule
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              oneOf:
                - $ref: '#/components/schemas/put_basic_tag'
                - $ref: '#/components/schemas/create_or_put_tag_inactivity_alert'
                - $ref: '#/components/schemas/put_tag_anomaly_alert'
            example:
              tag:
                name: Foo Bar Tag
                leql:
                  statement: where(/Foo Bar/)
                sources:
                  - id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
                type: Alert
                actions:
                  - enabled: true
                    min_matches_count: 0
                    min_matches_period: Hour
                    min_report_count: 1
                    min_report_period: Hour
                    targets:
                      - alert_content_set:
                          le_context: true
                        params_set:
                          direct: user@example.com
                          teams: ''
                          users: user@example.com
                        type: Mailto
                    type: Alert
                labels:
                  - color: 3498db
                    id: a6b486c1-306f-4575-95cc-0eee40f8f7e6
                    name: Test Label
                    reserved: false
                    sn: 1025
      responses:
        '200':
          description: Success. New Basic Detection Rule in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                type: object
                properties:
                  tag:
                    oneOf:
                      - $ref: '#/components/schemas/basic_tag_response'
                      - $ref: '#/components/schemas/tag_inactivity_alert_response'
                      - $ref: '#/components/schemas/tag_anomaly_alert_response'
              example:
                tag:
                  type: Alert
                  id: cfd65778-45ff-4300-9b3e-98c752ac2661
                  name: Foo Bar Tag
                  description: null
                  sources:
                    - id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
                      retention_period: default
                      token: c78579a8-8b20-4e6a-d4c0-5287198a263b
                      name: auth.log
                      stored_days: []
                  actions:
                    - id: 022c2fc5-f9a0-4600-bd72-8d8d14bb1523
                      min_matches_count: 1
                      min_report_count: 1
                      min_matches_period: Day
                      min_report_period: Day
                      targets:
                        - name: null
                          description: null
                          type: Mailto
                          params_set:
                            direct: user@example.com
                          user_data: null
                          alert_content_set:
                            le_context: true
                      enabled: true
                      type: Alert
                  leql:
                    statement: where(/Foo Bar/)
                  priority: 2
                  user_data: {}
                  labels:
                    - id: a6b486c1-306f-4575-95cc-0eee40f8f7e6
                      sn: 1025
                      name: Test Label
                      color: 3498db
                      reserved: false
        '400':
          description: Basic Detection Rule Specified in Request Body Invalid.
        '401':
          description: Unauthorized.
        '404':
          description: Basic Detection Rule Not Found.
        '415':
          description: Non-JSON request body was given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            LOG_ID = 'YOUR LOG ID HERE'
            BASIC_DETECTION_RULE_ID = 'YOUR DETECTION RULE ID HERE'

            BASIC_DETECTION_RULE = {
                "tag": {
                    "actions": [
                        {
                            "enabled": True,
                            "min_matches_count": 0,
                            "min_matches_period": "Hour",
                            "min_report_count": 1,
                            "min_report_period": "Hour",
                            "targets": [
                                {
                                    "alert_content_set":
                                    {
                                        "le_context": "true"
                                    },
                                    "params_set": {
                                        "direct": "test@test.com",
                                    },
                                    "type": "mailto"
                                }
                            ],
                            "type": "Alert"
                        }
                    ],
                    "labels": [],
                    "name": "REPLACED Tag",
                    "leql": {
                        "statement": "where(/Replaced/)"
                    },
                    "sources": [
                        {
                            "id": LOG_ID
                        }
                    ],
                    "type": "Alert"
                }
            }


            def replace_basic_detection_rule(s: Session) -> None:
                response = s.put(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                  f"/management/tags/{BASIC_DETECTION_RULE_ID}",
                                  headers={'x-api-key': API_KEY},
                                  json=BASIC_DETECTION_RULE)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                replace_basic_detection_rule(session)
    patch:
      operationId: patchManagementTagById
      summary: Modify a Basic Detection Rule
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                tag:
                  oneOf:
                    - $ref: '#/components/schemas/patch_basic_tag'
                    - $ref: '#/components/schemas/patch_tag_with_inactivity_alert'
                    - $ref: '#/components/schemas/patch_tag_with_anomaly_alert'
            example:
              tag:
                sources:
                  - id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
      responses:
        '200':
          description: Success. Modified Basic Detection Rule in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                type: object
                properties:
                  tag:
                    oneOf:
                      - $ref: '#/components/schemas/basic_tag_response'
                      - $ref: '#/components/schemas/tag_inactivity_alert_response'
                      - $ref: '#/components/schemas/tag_anomaly_alert_response'
              example:
                tag:
                  type: Alert
                  id: cfd65778-45ff-4300-9b3e-98c752ac2661
                  name: Foo Bar Tag
                  description: null
                  sources:
                    - id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
                      retention_period: default
                      token: c78579a8-8b20-4e6a-d4c0-5287198a263b
                      name: auth.log
                      stored_days: []
                  actions:
                    - id: 022c2fc5-f9a0-4600-bd72-8d8d14bb1523
                      min_matches_count: 1
                      min_report_count: 1
                      min_matches_period: Day
                      min_report_period: Day
                      targets:
                        - name: null
                          description: null
                          type: Mailto
                          params_set:
                            direct: user@example.com
                          user_data: null
                          alert_content_set:
                            le_context: true
                      enabled: true
                      type: Alert
                  leql:
                    statement: where(/Foo Bar/)
                  priority: 2
                  user_data: {}
                  labels:
                    - id: a6b486c1-306f-4575-95cc-0eee40f8f7e6
                      sn: 1025
                      name: Test Label
                      color: 3498db
                      reserved: false
        '400':
          description: Basic Detection Rule Parameter Value(s) Specified In Request Body Invalid.
        '401':
          description: Unauthorized.
        '404':
          description: Tag Not Found.
        '415':
          description: Non-JSON request body was given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            LOG_ID = 'YOUR LOG ID HERE'
            BASIC_DETECTION_RULE_ID = 'YOUR DETECTION RULE ID HERE'

            BASIC_DETECTION_RULE = {
                "tag": {
                    "name": "Updated Tag Name",
                }
            }


            def update_basic_detection_rule(s: Session) -> None:
                response = s.patch(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                   f"/management/tags/{BASIC_DETECTION_RULE_ID}",
                                   headers={'x-api-key': API_KEY},
                                   json=BASIC_DETECTION_RULE)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                update_basic_detection_rule(session)
    delete:
      operationId: deleteManagementTagById
      summary: Delete a Basic Detection Rule
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      responses:
        '204':
          description: Basic Detection Rule Deleted Successfully.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '401':
          description: Unauthorized.
        '404':
          description: Basic Detection Rule Not Found.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            BASIC_DETECTION_RULE_ID = 'YOUR DETECTION RULE ID HERE'


            def delete_basic_detection_rule(s: Session) -> None:
                response = s.delete(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                    f"/management/tags/{BASIC_DETECTION_RULE_ID}",
                                    headers={'x-api-key': API_KEY})
                if response.status_code == 204:
                    print(f'Deleted {BASIC_DETECTION_RULE_ID}')
                else:
                    print(f'Failed to delete {BASIC_DETECTION_RULE_ID}. status_code={response.status_code}')
                    print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                delete_basic_detection_rule(session)
  /management/actions:
    get:
      operationId: getManagementAlertNotificationSettings
      summary: List All Notifications
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Basic Detection Rules
      responses:
        '200':
          description: Notifications in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                type: object
                properties:
                  actions:
                    description: All the notifications for this account that can be attached to basic detection rules.
                    type: array
                    items:
                      $ref: '#/components/schemas/alert_notification_setting'
              example:
                actions:
                  - id: cfd65778-45ff-4300-9b3e-98c752ac2661
                    min_matches_count: 0
                    max_matches_count: 0
                    min_report_count: 1
                    max_report_count: 1
                    min_matches_period: Hour
                    min_report_period: Hour
                    targets:
                      - id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
                        name: Some Name
                        description: null
                        type: Mailto
                        params_set:
                          - direct: some@email.com
                        user_data:
                          - {}
                        alert_content_set:
                          - le_log_ling: 'false'
                            le_context: 'true'
                      - id: 00000000-ffff-ffff-ffff-00000000
                        name: null
                        description: null
                        type: Sqs
                        params_set:
                          - destination_queue: investigations
                            destination_app: IDR
                        user_data:
                          - {}
                        alert_content_set:
                          - le_context: 'true'
                    enabled: true
                    type: Alert
        '401':
          description: Unauthorized.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region


            def list_basic_detection_rule_notifications(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/actions",
                                 headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                list_basic_detection_rule_notifications(session)
    post:
      operationId: postManagementTagActions
      summary: Create a Notification
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                action:
                  $ref: '#/components/schemas/alert_notification_setting_request'
            example:
              action:
                min_matches_count: 1
                min_matches_period: Day
                min_report_count: 1
                min_report_period: Day
                enabled: true
                targets:
                  - id: 00000000-ffff-ffff-ffff-00000000
                type: Alert
      responses:
        '201':
          description: Notification Created. ID in Response
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                type: object
                properties:
                  action:
                    $ref: '#/components/schemas/alert_notification_setting'
              example:
                action:
                  id: cfd65778-45ff-4300-9b3e-98c752ac2661
                  min_matches_count: 1
                  max_matches_count: 1
                  min_report_count: 1
                  max_report_count: 1
                  min_matches_period: Day
                  min_report_period: Day
                  targets:
                    - name: Some Name
                      description: null
                      type: Mailto
                      params_set:
                        direct: some@email.com
                      user_data: null
                      alert_content_set: {}
                    - name: null
                      description: null
                      type: Sqs
                      params_set:
                        destination_queue: investigations
                        destination_app: IDR
                      user_data: {}
                      alert_content_set:
                        le_context: 'true'
                  enabled: true
                  type: Alert
        '400':
          description: Notification Specified In Request Body Invalid.
        '401':
          description: Unauthorized.
        '415':
          description: Non-JSON request body was given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            NOTIFICATION_TARGET_ID = 'YOUR NOTIFICATION TARGET ID HERE'

            BASIC_DETECTION_RULE_NOTIFICATION = {
                "action": {
                    "min_matches_count": 0,
                    "min_report_count": 1,
                    "min_matches_period": "Hour",
                    "min_report_period": "Hour",
                    "targets": [
                        {"id": NOTIFICATION_TARGET_ID}
                    ]
                }
            }


            def create_basic_detection_rule_notification(s: Session) -> None:
                response = s.post(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/actions",
                                  headers={'x-api-key': API_KEY},
                                  json=BASIC_DETECTION_RULE_NOTIFICATION)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                create_basic_detection_rule_notification(session)
  /management/actions/{action_id}:
    parameters:
      - $ref: '#/components/parameters/action_id'
    get:
      operationId: getManagementTagActionById
      summary: Retrieve a Notification
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      responses:
        '200':
          description: Notification in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                type: object
                properties:
                  action:
                    $ref: '#/components/schemas/alert_notification_setting'
              example:
                action:
                  id: cfd65778-45ff-4300-9b3e-98c752ac2661
                  min_matches_count: 1
                  max_matches_count: 1
                  min_report_count: 1
                  max_report_count: 1
                  min_matches_period: Day
                  min_report_period: Day
                  targets:
                    - id: 00000000-ffff-ffff-ffff-0000000
                      name: Some Name
                      description: null
                      type: Mailto
                      params_set:
                        direct: some@email.com
                      user_data: null
                      alert_content_set: {}
                    - id: ffffffff-0000-0000-0000-ffffffff
                      name: null
                      description: null
                      type: Sqs
                      params_set:
                        destination_queue: investigations
                        destination_app: IDR
                      user_data: {}
                      alert_content_set:
                        le_context: 'true'
                  enabled: true
                  type: Alert
        '401':
          description: Unauthorized.
        '404':
          description: Notification Not Found.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            NOTIFICATION_ID = 'YOUR NOTIFICATION ID HERE'


            def get_basic_detection_rule_notification(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                 f"/management/actions/{NOTIFICATION_ID}",
                                 headers={'x-api-key': API_KEY}, )
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                get_basic_detection_rule_notification(session)
    put:
      operationId: putManagementTagActionById
      summary: Replace a Notification
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                action:
                  $ref: '#/components/schemas/alert_notification_setting_request'
            example:
              action:
                min_matches_count: 1
                min_matches_period: Day
                min_report_count: 1
                min_report_period: Day
                enabled: true
                targets:
                  - id: 00000000-ffff-ffff-ffff-00000000
                type: Alert
      responses:
        '200':
          description: Success. New Notifications in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                type: object
                properties:
                  action:
                    $ref: '#/components/schemas/alert_notification_setting'
              example:
                action:
                  id: cfd65778-45ff-4300-9b3e-98c752ac2661
                  min_matches_count: 1
                  max_matches_count: 1
                  min_report_count: 1
                  max_report_count: 1
                  min_matches_period: Day
                  min_report_period: Day
                  targets:
                    - name: Some Name
                      description: null
                      type: Mailto
                      params_set:
                        direct: some@email.com
                      user_data: null
                      alert_content_set: {}
                    - name: null
                      description: null
                      type: Sqs
                      params_set:
                        destination_queue: investigations
                        destination_app: IDR
                      user_data: {}
                      alert_content_set:
                        le_context: 'true'
                  enabled: true
                  type: Alert
        '400':
          description: Notification Specified in Request Body Invalid.
        '401':
          description: Unauthorized.
        '404':
          description: Notification Not Found.
        '415':
          description: Non-JSON request body was given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            NOTIFICATION_ID = 'YOUR NOTIFICATION ID HERE'
            NOTIFICATION_TARGET_ID = 'YOUR NOTIFICATION TARGET ID HERE'

            BASIC_DETECTION_RULE_NOTIFICATION = {
                "action": {
                    "min_matches_count": 0,
                    "min_report_count": 1,
                    "min_matches_period": "Day",
                    "min_report_period": "Day",
                    "targets": [
                        {"id": NOTIFICATION_TARGET_ID}
                    ]
                }
            }


            def replace_basic_detection_rule_notification(s: Session) -> None:
                response = s.put(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                 f"/management/actions/{NOTIFICATION_ID}",
                                 headers={'x-api-key': API_KEY},
                                 json=BASIC_DETECTION_RULE_NOTIFICATION)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                replace_basic_detection_rule_notification(session)
    patch:
      operationId: patchManagementTagActionById
      summary: Modify a Notification
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                action:
                  $ref: '#/components/schemas/alert_notification_setting_request'
            example:
              action:
                min_matches_count: 1
                min_matches_period: Day
                min_report_count: 1
                min_report_period: Day
                enabled: true
                targets:
                  - id: 00000000-ffff-ffff-ffff-00000000
                type: Alert
      responses:
        '200':
          description: Success. Modified Notification in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                type: object
                properties:
                  action:
                    $ref: '#/components/schemas/alert_notification_setting'
              example:
                action:
                  id: cfd65778-45ff-4300-9b3e-98c752ac2661
                  min_matches_count: 1
                  max_matches_count: 1
                  min_report_count: 1
                  max_report_count: 1
                  min_matches_period: Day
                  min_report_period: Day
                  targets:
                    - name: Some Name
                      description: null
                      type: Mailto
                      params_set:
                        direct: some@email.com
                      user_data: null
                      alert_content_set: {}
                    - name: null
                      description: null
                      type: Sqs
                      params_set:
                        destination_queue: investigations
                        destination_app: IDR
                      user_data: {}
                      alert_content_set:
                        le_context: 'true'
                  enabled: true
                  type: Alert
        '400':
          description: Notification Parameter Value(s) Specified In Request Body Invalid.
        '401':
          description: Unauthorized.
        '404':
          description: Notification Not Found.
        '415':
          description: Non-JSON request body was given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            NOTIFICATION_ID = 'YOUR NOTIFICATION ID HERE'
            NOTIFICATION_TARGET_ID = 'YOUR NOTIFICATION TARGET ID HERE'

            BASIC_DETECTION_RULE_NOTIFICATION = {
                "action": {
                    "min_matches_count": 5,
                    "min_matches_period": "Hour",
                }
            }


            def update_basic_detection_rule_notification(s: Session) -> None:
                response = s.patch(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                   f"/management/actions/{NOTIFICATION_ID}",
                                   headers={'x-api-key': API_KEY},
                                   json=BASIC_DETECTION_RULE_NOTIFICATION)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                update_basic_detection_rule_notification(session)
    delete:
      operationId: deleteManagementTagActionById
      summary: Delete a Notification
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      responses:
        '204':
          description: Alert Notification Settings Deleted Successfully.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '401':
          description: Unauthorized.
        '404':
          description: Notification Not Found.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            NOTIFICATION_ID = 'YOUR NOTIFICATION ID HERE'


            def delete_basic_detection_rule_notification(s: Session) -> None:
                response = s.delete(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                    f"/management/actions/{NOTIFICATION_ID}",
                                    headers={'x-api-key': API_KEY})
                if response.status_code == 200:
                    print(f'Deleted {NOTIFICATION_ID}')
                else:
                    print(f'Failed to delete {NOTIFICATION_ID}. status_code={response.status_code}')
                    print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                delete_basic_detection_rule_notification(session)            
  /management/actions/{action_id}/targets:
    parameters:
      - $ref: '#/components/parameters/action_id'
    get:
      operationId: getManagementTagActionTargets
      summary: List All Targets Attached To A Notification
      description: |
        Given the ID of a notification, returns all notification targets currently attached to that notification.
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Basic Detection Rules
      responses:
        '200':
          description: Notification Targets in Response Body
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                type: object
                properties:
                  targets:
                    description: All the notification targets for this account.
                    type: array
                    items:
                      $ref: '#/components/schemas/get_target_action'
              example:
                targets:
                  name: Target Name
                  description: Description of the target.
                  type: Mailto
                  params_set:
                    email:
                      direct: user@example.com
                    pagerduty:
                      description: DESCRIPTION_PAGERDUTY.
                      service_key: SERVICE_KEY_PAGERDUTY
                    slack:
                      url: https://hook.slack.com/services/SOME_SECRET
                    webhook:
                      url: http://asdf.com
                    iconworkflow:
                      workflow_id: The workflow ID of the custom alert trigger type in InsightConnect.
                  user_data:
                    hello: world
                  alert_content_set:
                    le_context: true
        '401':
          description: Unauthorized.
        '415':
          description: Non-JSON request body was given (Note that the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            NOTIFICATION_ID = 'YOUR NOTIFICATION ID HERE'


            def list_targets_for_notification(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                 f"/management/actions/{NOTIFICATION_ID}/targets",
                                 headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                list_targets_for_notification(session)
    patch:
      operationId: patchManagementTagActionTargetById
      summary: Modify the Targets Attached To A Notification
      description: |
        Using the ID of a notification, modify the notification target that is attached to it.
        This endpoint only allows updating a notification to have one notification target attached to it.
        To attach multiple targets to a notification you can use the ["management/actions"](#operation/patchManagementTagActionById) endpoint.
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                target:
                  type: object
                  $ref: '#/components/schemas/create_patch_target'
            example:
              target:
                name: Notification target name
                description: Description of the  notification target.
                type: Mailto
                params_set:
                  direct: user@example.com
                user_data:
                  hello: world
                alert_content_set:
                  le_context: true
      responses:
        '200':
          description: Success. Modified Notification Targets in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                type: object
                properties:
                  target:
                    $ref: '#/components/schemas/create_patch_target'
              example:
                targets:
                  name: Target Name
                  description: Description of the target.
                  type: Mailto
                  params_set:
                    email:
                      direct: user@example.com
                    pagerduty:
                      description: DESCRIPTION_PAGERDUTY.
                      service_key: SERVICE_KEY_PAGERDUTY
                    slack:
                      url: https://hook.slack.com/services/SOME_SECRET
                    webhook:
                      url: http://asdf.com
                    iconworkflow:
                      workflow_id: The workflow ID of the custom alert trigger type in InsightConnect.
                  user_data:
                    hello: world
                  alert_content_set:
                    le_context: true
        '400':
          description: Notification Targets Parameter Value(s) Specified In Request Body Invalid.
        '401':
          description: Unauthorized.
        '404':
          description: Notification Not Found.
        '415':
          description: Non-JSON request body was given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            NOTIFICATION_ID = 'YOUR NOTIFICATION ID HERE'
            UPDATED_NOTIFICATION_TARGET_ID = 'YOUR NOTIFICATION TARGET ID HERE'


            def update_targets_for_notification(s: Session) -> None:
                response = s.patch(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                   f"/management/actions/{NOTIFICATION_ID}/targets",
                                   headers={'x-api-key': API_KEY},
                                   json={"target": {"id": UPDATED_NOTIFICATION_TARGET_ID}})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                update_targets_for_notification(session)
  /management/targets:
    get:
      operationId: getManagementTargets
      summary: List All Targets
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Basic Detection Rules
      responses:
        '200':
          description: Notification Targets in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/target_response'
              example:
                targets:
                  - target:
                      id: c299180b-d521-4c83-b64a-9a3ce795744h
                      name: Target Name
                      description: Description of the target.
                      type: Mailto
                      params_set:
                        email:
                          direct: user@example.com
                        pagerduty:
                          description: DESCRIPTION_PAGERDUTY.
                          service_key: SERVICE_KEY_PAGERDUTY
                        slack:
                          url: https://hook.slack.com/services/SOME_SECRET
                        webhook:
                          url: http://asdf.com
                        iconworkflow:
                          workflow_id: The workflow ID of the custom alert trigger type in InsightConnect.
                      user_data:
                        hello: world
                      alert_content_set:
                        le_context: true
                  - target:
                      id: c299180b-d521-4c83-b64a-9a3ce795744h
                      name: Target Name
                      description: Description of the target.
                      type: Mailto
                      params_set:
                        email:
                          direct: user@example.com
                        pagerduty:
                          description: DESCRIPTION_PAGERDUTY.
                          service_key: SERVICE_KEY_PAGERDUTY
                        slack:
                          url: https://hook.slack.com/services/SOME_SECRET
                        webhook:
                          url: http://asdf.com
                        iconworkflow:
                          workflow_id: The workflow ID of the custom alert trigger type in InsightConnect.
                      user_data:
                        hello: world
                      alert_content_set:
                        le_context: true
        '401':
          description: Unauthorized.
        '415':
          description: Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region


            def list_notifications_targets(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/targets",
                                 headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                list_notifications_targets(session)
    post:
      operationId: postManagementTargets
      summary: Create a Target
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/create_put_target'
            example:
              target:
                name: Notification target name
                description: Description of the  notification target.
                type: Mailto
                params_set:
                  direct: user@example.com
                user_data:
                  hello: world
                alert_content_set:
                  le_context: true
      responses:
        '201':
          description: Notification Target Created. ID in Response.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/target_response'
              example:
                target:
                  id: c299180b-d521-4c83-b64a-9a3ce795744h
                  name: Target Name
                  description: Description of the target.
                  type: Mailto
                  params_set:
                    email:
                      direct: user@example.com
                    pagerduty:
                      description: DESCRIPTION_PAGERDUTY.
                      service_key: SERVICE_KEY_PAGERDUTY
                    slack:
                      url: https://hook.slack.com/services/SOME_SECRET
                    webhook:
                      url: http://asdf.com
                    iconworkflow:
                      workflow_id: The workflow ID of the custom alert trigger type in InsightConnect.
                  user_data:
                    hello: world
                  alert_content_set:
                    le_context: true
        '400':
          description: Notification Targets Specified in Request Body Invalid.
        '401':
          description: Unauthorized.
        '403':
          description: Forbidden.
        '415':
          description: Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region

            NOTIFICATION_TARGET = {
                "target": {
                        "name": "My Notification Target",
                        "description": "My Clever Description",
                        "type": "Mailto",
                        "params_set": {
                            "direct": "my_name@my_organisation.com"
                        },
                        "user_data": {},
                        "alert_content_set": {
                            "le_trigger_event": "true",
                            "le_context": "true"
                        }
                    }
            }


            def create_notification_target(s: Session) -> None:
                response = s.post(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/targets",
                                  headers={'x-api-key': API_KEY},
                                  json=NOTIFICATION_TARGET)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                create_notification_target(session)
  /management/targets/{target_id}:
    parameters:
      - $ref: '#/components/parameters/target_id'
    get:
      operationId: getManagementTargetById
      summary: Retrieve a Target
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Basic Detection Rules
      responses:
        '200':
          description: Notification Target in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/target_response'
              example:
                target:
                  id: c299180b-d521-4c83-b64a-9a3ce795744h
                  name: Target Name
                  description: Description of the target.
                  type: Mailto
                  params_set:
                    email:
                      direct: user@example.com
                    pagerduty:
                      description: DESCRIPTION_PAGERDUTY.
                      service_key: SERVICE_KEY_PAGERDUTY
                    slack:
                      url: https://hook.slack.com/services/SOME_SECRET
                    webhook:
                      url: http://asdf.com
                    iconworkflow:
                      workflow_id: The workflow ID of the custom alert trigger type in InsightConnect.
                  user_data:
                    hello: world
                  alert_content_set:
                    le_context: true
        '401':
          description: Unauthorized.
        '404':
          description: Notification Target Not Found.
        '415':
          description: Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            NOTIFICATION_TARGET_ID = 'YOUR NOTIFICATION TARGET ID HERE'


            def create_notification_target(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                 f"/management/targets/{NOTIFICATION_TARGET_ID}",
                                 headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                create_notification_target(session)
    put:
      operationId: putManagementTargetById
      summary: Replace a Target
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/create_put_target'
            example:
              target:
                name: Notification target name
                description: Description of the  notification target.
                type: Mailto
                params_set:
                  direct: user@example.com
                user_data:
                  hello: world
                alert_content_set:
                  le_context: true
      responses:
        '200':
          description: Success. Modified Notification Target in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/target_response'
              example:
                target:
                  id: c299180b-d521-4c83-b64a-9a3ce795744h
                  name: Target Name
                  description: Description of the target.
                  type: Mailto
                  params_set:
                    email:
                      direct: user@example.com
                    pagerduty:
                      description: DESCRIPTION_PAGERDUTY.
                      service_key: SERVICE_KEY_PAGERDUTY
                    slack:
                      url: https://hook.slack.com/services/SOME_SECRET
                    webhook:
                      url: http://asdf.com
                    iconworkflow:
                      workflow_id: The workflow ID of the custom alert trigger type in InsightConnect.
                  user_data:
                    hello: world
                  alert_content_set:
                    le_context: true
        '400':
          description: Notification Target Specified in Request Body Invalid.
        '401':
          description: Unauthorized.
        '403':
          description: Forbidden.
        '404':
          description: Target Not Found.
        '415':
          description: Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            NOTIFICATION_TARGET_ID = 'YOUR NOTIFICATION TARGET ID HERE'

            NOTIFICATION_TARGET = {
                "target": {
                    "name": "My Replace Notification Target",
                    "description": "My Replaced Description",
                    "type": "Mailto",
                    "params_set": {
                        "direct": "replaced@my_organisation.com"
                    },
                    "user_data": {},
                    "alert_content_set": {
                        "le_trigger_event": "true",
                        "le_context": "true"
                    }
                }
            }


            def replace_notification_target(s: Session) -> None:
                response = s.put(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                 f"/management/targets/{NOTIFICATION_TARGET_ID}",
                                 headers={'x-api-key': API_KEY},
                                 json=NOTIFICATION_TARGET)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                replace_notification_target(session)
    delete:
      operationId: deleteManagementTargetById
      summary: Delete a Target
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      responses:
        '204':
          description: Notification Target Deleted Successfully.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '401':
          description: Unauthorized.
        '404':
          description: Notification Target Not Found.
        '415':
          description: Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            NOTIFICATION_TARGET_ID = 'YOUR NOTIFICATION TARGET ID HERE'


            def delete_notification_target(s: Session) -> None:
                response = s.delete(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                    f"/management/targets/{NOTIFICATION_TARGET_ID}",
                                    headers={'x-api-key': API_KEY})
                if response.status_code == 204:
                    print(f'Deleted {NOTIFICATION_TARGET_ID}')
                else:
                    print(f'Failed to delete {NOTIFICATION_TARGET_ID}. status_code={response.status_code}')
                    print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                delete_notification_target(session)
  /management/logs:
    get:
      operationId: getLogs
      summary: Retrieve All Logs
      description: |
        For more context on logs and log sets, as well as instructions on handling rate limits consult [this section's introduction](#tag/Logs-and-Log-Sets).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Logs & Log Sets
      responses:
        '200':
          description: Logs in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/logs_response'
              example:
                logs:
                  - id: 00000000-0000-0000-0000-000000000000
                    name: my log
                    structures:
                      - 00000000-0000-0000-0000-000000000000
                    tokens:
                      - 00000000-0000-0000-0000-000000000000
                    source_type: token
                    token_seed: null
                    user_data:
                      foo: bar
                    rrn: rrn:logsearch:us:00000000-0000-0000-0000-000000000000:log:00000000-0000-0000-0000-000000000000
                    logsets_info:
                      - id: d25737e8-7135-4b48-b0f8-4b4b5b60b358
                        name: ibtest
                        rrn: rrn:logsearch:us:00000000-0000-0000-0000-000000000000:logset:00000000-0000-0000-0000-000000000000
                        links:
                          - href: https://us.rest.logs.insight.rapid7.com/management/logsets/00000000-0000-0000-0000-000000000000
                            rel: Self
                    links:
                      - rel: Related,
                        href: https://us.rest.logs.insight.rapid7.com/log_search/management/logs/00000000-0000-0000-0000-000000000000/topkeys
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
        '503':
          description: Service Unavailable.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region


            def list_all_logs(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/logs",
                                 headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                list_all_logs(session)
    post:
      operationId: postLog
      summary: Create a Log
      description: |
        For more context on logs and log sets, as well as instructions on handling rate limits consult [this section's introduction](#tag/Logs-and-Log-Sets).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Logs & Log Sets
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/create_or_put_log'
            example:
              log:
                name: my log
                source_type: token
                token_seed: my_token_seed
                user_data:
                  foo: bar
                logsets_info:
                  - id: 00000000-0000-0000-0000-000000000000
      responses:
        '201':
          description: New Log Returned.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/log_response'
              example:
                log:
                  id: 00000000-0000-0000-0000-000000000000
                  name: my log
                  structures:
                    - 00000000-0000-0000-0000-000000000000
                  tokens:
                    - 00000000-0000-0000-0000-000000000000
                  source_type: token
                  token_seed: null
                  user_data:
                    foo: bar
                  rrn: rrn:logsearch:us:00000000-0000-0000-0000-000000000000:log:00000000-0000-0000-0000-000000000000
                  logsets_info:
                    - id: d25737e8-7135-4b48-b0f8-4b4b5b60b358
                      name: ibtest
                      rrn: rrn:logsearch:us:00000000-0000-0000-0000-000000000000:logset:00000000-0000-0000-0000-000000000000
                      links:
                        - href: https://us.rest.logs.insight.rapid7.com/management/logsets/00000000-0000-0000-0000-000000000000
                          rel: Self
                  links:
                    - rel: Related,
                      href: https://us.rest.logs.insight.rapid7.com/log_search/management/logs/00000000-0000-0000-0000-000000000000/topkeys
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '405':
          description: Method Not Allowed.
        '415':
          description: Unsupported Media Type. Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
        '503':
          description: Service Unavailable.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            LOGSET_ID = 'YOUR LOGSET ID HERE'
            LOG = {
                'log': {
                    'name': 'my log',
                    'structures': [],
                    'source_type': 'token',
                    'token_seed': None,
                    'user_data': {
                        'foo': 'bar'
                    },
                    'logsets_info': [
                        {
                            'id': LOGSET_ID
                        }
                    ]
                }
            }


            def create_log(s: Session) -> None:
                response = s.post(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/logs",
                                  headers={'x-api-key': API_KEY},
                                  json=LOG)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                create_log(session)
  /management/logs/{id}:
    parameters:
      - $ref: '#/components/parameters/log_id'
    get:
      operationId: getLog
      summary: Retrieve a Log
      description: |
        For more context on logs and log sets, as well as instructions on handling rate limits consult [this section's introduction](#tag/Logs-and-Log-Sets).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Logs & Log Sets
      responses:
        '200':
          description: Log Successfully Returned.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/log_response'
              example:
                log:
                  id: 00000000-0000-0000-0000-000000000000
                  name: my log
                  structures:
                    - 00000000-0000-0000-0000-000000000000
                  tokens:
                    - 00000000-0000-0000-0000-000000000000
                  source_type: token
                  token_seed: null
                  user_data:
                    foo: bar
                  rrn: rrn:logsearch:us:00000000-0000-0000-0000-000000000000:log:00000000-0000-0000-0000-000000000000
                  logsets_info:
                    - id: d25737e8-7135-4b48-b0f8-4b4b5b60b358
                      name: ibtest
                      rrn: rrn:logsearch:us:00000000-0000-0000-0000-000000000000:logset:00000000-0000-0000-0000-000000000000
                      links:
                        - href: https://us.rest.logs.insight.rapid7.com/management/logsets/00000000-0000-0000-0000-000000000000
                          rel: Self
                  links:
                    - rel: Related,
                      href: https://us.rest.logs.insight.rapid7.com/log_search/management/logs/00000000-0000-0000-0000-000000000000/topkeys
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '404':
          description: Log Not Found.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
        '503':
          description: Service Unavailable.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: 00000000-0000-0000-0000-000000000000' \
            -G \
            https://us.rest.logs.insight.rapid7.com/management/logs/00000000-0000-0000-0000-000000000000
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            LOG_ID = 'YOUR LOG ID HERE'


            def get_log(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/logs/{LOG_ID}",
                                 headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                get_log(session)
    put:
      operationId: putLog
      summary: Replace a Log
      description: |
        For more context on logs and log sets, as well as instructions on handling rate limits consult [this section's introduction](#tag/Logs-and-Log-Sets).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Logs & Log Sets
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/create_or_put_log'
            example:
              log:
                name: my log
                source_type: token
                token_seed: my_token_seed
                user_data:
                  foo: bar
                logsets_info:
                  - id: 00000000-0000-0000-0000-000000000000
      responses:
        '200':
          description: New Log Returned.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/log_response'
              example:
                log:
                  id: 00000000-0000-0000-0000-000000000000
                  name: my log
                  structures:
                    - 00000000-0000-0000-0000-000000000000
                  tokens:
                    - 00000000-0000-0000-0000-000000000000
                  source_type: token
                  token_seed: null
                  user_data:
                    foo: bar
                  rrn: rrn:logsearch:us:00000000-0000-0000-0000-000000000000:log:00000000-0000-0000-0000-000000000000
                  logsets_info:
                    - id: d25737e8-7135-4b48-b0f8-4b4b5b60b358
                      name: ibtest
                      rrn: rrn:logsearch:us:00000000-0000-0000-0000-000000000000:logset:00000000-0000-0000-0000-000000000000
                      links:
                        - href: https://us.rest.logs.insight.rapid7.com/management/logsets/00000000-0000-0000-0000-000000000000
                          rel: Self
                  links:
                    - rel: Related,
                      href: https://us.rest.logs.insight.rapid7.com/log_search/management/logs/00000000-0000-0000-0000-000000000000/topkeys
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '404':
          description: Log Not Found.
        '405':
          description: Method Not Allowed.
        '415':
          description: Unsupported Media Type. Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
        '503':
          description: Service Unavailable.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            LOG_ID = 'YOUR LOG ID HERE'
            LOGSET_ID = 'YOUR LOGSET ID HERE'
            LOG = {
                'log': {
                    'name': 'my replaced log',
                    'structures': [],
                    'source_type': 'token',
                    'token_seed': None,
                    'user_data': {
                        'foo': 'baz'
                    },
                    'logsets_info': [
                        {
                            'id': LOGSET_ID
                        }
                    ]
                }
            }


            def replace_log(s: Session) -> None:
                response = s.put(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/logs/{LOG_ID}",
                                 headers={'x-api-key': API_KEY},
                                 json=LOG)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                replace_log(session)
    delete:
      operationId: deleteLog
      summary: Delete a Log
      description: |
        For more context on logs and log sets, as well as instructions on handling rate limits consult [this section's introduction](#tag/Logs-and-Log-Sets).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Logs & Log Sets
      responses:
        '204':
          description: Log Deleted.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '404':
          description: Log Not Found.
        '405':
          description: Method Not Allowed.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
        '503':
          description: Service Unavailable.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            LOG_ID = 'YOUR LOG ID HERE'


            def delete_log(s: Session) -> None:
                response = s.delete(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/logs/{LOG_ID}",
                                    headers={'x-api-key': API_KEY})
                if response.status_code == 204:
                    print(f'Deleted {LOG_ID}')
                else:
                    print(f'Failed to delete {LOG_ID}. status_code={response.status_code}')
                    print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                delete_log(session)
  /management/logs/{id}/topkeys:
    parameters:
      - $ref: '#/components/parameters/log_id'
    get:
      operationId: getLogTopkeys
      summary: Retrieve Most Common Keys For A Log
      description: |
        For more context on keys and commonly occurring keys, 
        as well as instructions on handling rate limits consult [this section's introduction](#tag/Retrieve-The-Most-Common-Keys-Within-Your-Log-Data).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Retrieve The Most Common Keys Within Your Log Data
      responses:
        '200':
          description: Most Common Keys in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/log_topkeys_response'
              example:
                topkeys:
                  - weight: 100.44
                    key: kvp.country
                  - weight: 200.44
                    key: kvp.email
                  - weight: 300.44
                    key: kvp.fname
                  - weight: 400.44
                    key: kvp.id
                  - weight: 500.44
                    key: kvp.lname
                  - weight: 500.44
                    key: kvp.message
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '404':
          description: Log Not Found.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
        '503':
          description: Service Unavailable.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: 00000000-0000-0000-0000-000000000000' \
            -G \
            https://us.rest.logs.insight.rapid7.com/management/logs/00000000-0000-0000-0000-000000000000/topkeys
  /management/logsets:
    get:
      operationId: getManagementLogsets
      summary: List All Log Sets
      description: |
        For more context on logs and log sets, as well as instructions on handling rate limits consult [this section's introduction](#tag/Logs-and-Log-Sets).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Logs & Log Sets
      responses:
        '200':
          description: Log Sets in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/logset_response'
              example:
                logsets:
                  - id: 23cf23a8-9b9b-4b6e-b45f-5cbd19544f28
                    name: test1
                    description: qwertyui
                    user_data:
                      hello: world
                    logs_info:
                      - id: 89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                        name: myLog1
                        rrn: rrn:logsearch:us:3a80d6bd-a051-43bf-a889-60cee58d8b41:logset:89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                        links:
                          rel: Self
                          href: https://ap.rest.logs.insight.rapid7.com/log_search/management/logsets/89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                      - id: 89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                        name: myLog2
                        rrn: rrn:logsearch:us:3a80d6bd-a051-43bf-a889-60cee58d8b41:logset:89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                        links:
                          rel: Self
                          href: https://ap.rest.logs.insight.rapid7.com/log_search/management/logsets/89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                    rrn: rrn:logsearch:us:02abbff1-a1ed-452a-86eb-568bfb87e93e:log:022c2fc5-f9a0-4600-bd72-8d8d14bb1523
                  - id: 23cf23a8-9b9b-4b6e-b45f-5cbd19544f28
                    name: test2
                    description: qwertyui
                    user_data:
                      hello: world
                    logs_info:
                      - id: 89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                        name: myLog1
                        rrn: rrn:logsearch:us:3a80d6bd-a051-43bf-a889-60cee58d8b41:logset:89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                        links:
                          rel: Self
                          href: https://ap.rest.logs.insight.rapid7.com/log_search/management/logsets/89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                      - id: 89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                        name: myLog2
                        rrn: rrn:logsearch:us:3a80d6bd-a051-43bf-a889-60cee58d8b41:logset:89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                        links:
                          rel: Self
                          href: https://ap.rest.logs.insight.rapid7.com/log_search/management/logsets/89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                    rrn: rrn:logsearch:us:02abbff1-a1ed-452a-86eb-568bfb87e93e:log:022c2fc5-f9a0-4600-bd72-8d8d14bb1523
        '401':
          description: Unauthorized.
        '415':
          description: Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region


            def list_all_logsets(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/logsets",
                                 headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                list_all_logsets(session)
    post:
      operationId: postManagementLogsets
      summary: Create a Log Set
      description: |
        For more context on logs and log sets, as well as instructions on handling rate limits consult [this section's introduction](#tag/Logs-and-Log-Sets).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Logs & Log Sets
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/create_logset'
            example:
              logset:
                name: test
                description: qwertyui
                user_data:
                  hello: world
                logs_info:
                  - id: 89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                    name: myLog1
                    rrn: rrn:logsearch:us:3a80d6bd-a051-43bf-a889-60cee58d8b41:logset:89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                    links:
                      rel: Self
                      href: https://ap.rest.logs.insight.rapid7.com/log_search/management/logsets/89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                  - id: 89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                    name: myLog2
                    rrn: rrn:logsearch:us:3a80d6bd-a051-43bf-a889-60cee58d8b41:logset:89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                    links:
                      rel: Self
                      href: https://ap.rest.logs.insight.rapid7.com/log_search/management/logsets/89ed3b0d-2d9c-480b-9735-90c7d2f357c2
      responses:
        '201':
          description: Log Set Created. ID in Response.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/logset_response'
              example:
                logset:
                  id: 23cf23a8-9b9b-4b6e-b45f-5cbd19544f28
                  name: test
                  description: qwertyui
                  user_data:
                    hello: world
                  logs_info:
                    - id: 89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                      name: myLog1
                      rrn: rrn:logsearch:us:3a80d6bd-a051-43bf-a889-60cee58d8b41:logset:89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                      links:
                        rel: Self
                        href: https://ap.rest.logs.insight.rapid7.com/log_search/management/logsets/89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                    - id: 89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                      name: myLog2
                      rrn: rrn:logsearch:us:3a80d6bd-a051-43bf-a889-60cee58d8b41:logset:89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                      links:
                        rel: Self
                        href: https://ap.rest.logs.insight.rapid7.com/log_search/management/logsets/89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                  rrn: rrn:logsearch:us:02abbff1-a1ed-452a-86eb-568bfb87e93e:log:022c2fc5-f9a0-4600-bd72-8d8d14bb1523
        '400':
          description: Log Set Specified in Request Body Invalid.
        '401':
          description: Unauthorized.
        '403':
          description: Forbidden.
        '415':
          description: Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            LOGSET = {
                "logset": {
                    "name": "My New LogSet"
                }
            }


            def create_logset(s: Session) -> None:
                response = s.post(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/logsets",
                                  headers={'x-api-key': API_KEY},
                                  json=LOGSET)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                create_logset(session)
  /management/logsets/{logset_id}:
    parameters:
      - $ref: '#/components/parameters/logset_id'
    get:
      operationId: getManagementLogsetById
      summary: Retrieve a Log Set
      description: |
        For more context on logs and log sets, as well as instructions on handling rate limits consult [this section's introduction](#tag/Logs-and-Log-Sets).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Logs & Log Sets
      responses:
        '200':
          description: Log Set in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/logset_response'
              example:
                logset:
                  id: 23cf23a8-9b9b-4b6e-b45f-5cbd19544f28
                  name: test
                  description: qwertyui
                  user_data:
                    hello: world
                  logs_info:
                    - id: 89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                      name: myLog1
                      rrn: rrn:logsearch:us:3a80d6bd-a051-43bf-a889-60cee58d8b41:logset:89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                      links:
                        rel: Self
                        href: https://ap.rest.logs.insight.rapid7.com/log_search/management/logsets/89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                    - id: 89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                      name: myLog2
                      rrn: rrn:logsearch:us:3a80d6bd-a051-43bf-a889-60cee58d8b41:logset:89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                      links:
                        rel: Self
                        href: https://ap.rest.logs.insight.rapid7.com/log_search/management/logsets/89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                  rrn: rrn:logsearch:us:02abbff1-a1ed-452a-86eb-568bfb87e93e:log:022c2fc5-f9a0-4600-bd72-8d8d14bb1523
        '401':
          description: Unauthorized.
        '404':
          description: Log Set Not Found.
        '415':
          description: Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            LOGSET_ID = 'YOUR LOGSET ID HERE'


            def get_logset(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/logsets/{LOGSET_ID}",
                                  headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                get_logset(session)
    put:
      operationId: putManagementLogsetById
      summary: Replace a Log Set
      description: |
        For more context on logs and log sets, as well as instructions on handling rate limits consult [this section's introduction](#tag/Logs-and-Log-Sets).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Logs & Log Sets
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/logset_response'
            example:
              logset:
                name: test
                description: qwertyui
                user_data:
                  hello: world
                logs_info:
                  - id: 89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                    name: myLog1
                    rrn: rrn:logsearch:us:3a80d6bd-a051-43bf-a889-60cee58d8b41:logset:89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                    links:
                      rel: Self
                      href: https://ap.rest.logs.insight.rapid7.com/log_search/management/logsets/89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                  - id: 89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                    name: myLog2
                    rrn: rrn:logsearch:us:3a80d6bd-a051-43bf-a889-60cee58d8b41:logset:89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                    links:
                      rel: Self
                      href: https://ap.rest.logs.insight.rapid7.com/log_search/management/logsets/89ed3b0d-2d9c-480b-9735-90c7d2f357c2
      responses:
        '200':
          description: Success. Modified Log Set in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/logset_response'
              example:
                logset:
                  id: 23cf23a8-9b9b-4b6e-b45f-5cbd19544f28
                  name: test
                  description: qwertyui
                  user_data:
                    hello: world
                  logs_info:
                    - id: 89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                      name: myLog1
                      rrn: rrn:logsearch:us:3a80d6bd-a051-43bf-a889-60cee58d8b41:logset:89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                      links:
                        rel: Self
                        href: https://ap.rest.logs.insight.rapid7.com/log_search/management/logsets/89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                    - id: 89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                      name: myLog2
                      rrn: rrn:logsearch:us:3a80d6bd-a051-43bf-a889-60cee58d8b41:logset:89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                      links:
                        rel: Self
                        href: https://ap.rest.logs.insight.rapid7.com/log_search/management/logsets/89ed3b0d-2d9c-480b-9735-90c7d2f357c2
                  rrn: rrn:logsearch:us:02abbff1-a1ed-452a-86eb-568bfb87e93e:log:022c2fc5-f9a0-4600-bd72-8d8d14bb1523
        '400':
          description: Log Set Specified in Request Body Invalid.
        '401':
          description: Unauthorized.
        '403':
          description: Forbidden.
        '404':
          description: Log Set Not Found.
        '415':
          description: Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            LOGSET_ID = 'YOUR LOGSET ID HERE'

            LOGSET = {
                "logset": {
                    "name": "My Replaced Logset"
                }
            }


            def replace_logset(s: Session) -> None:
                response = s.put(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/logsets/{LOGSET_ID}",
                                 headers={'x-api-key': API_KEY},
                                 json=LOGSET)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                replace_logset(session)
    delete:
      operationId: deleteManagementLogsetById
      summary: Delete a Log Set
      description: |
        For more context on logs and log sets, as well as instructions on handling rate limits consult [this section's introduction](#tag/Logs-and-Log-Sets).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Logs & Log Sets
      responses:
        '204':
          description: Log Set Deleted Successfully.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          description: Unauthorized.
        '404':
          description: Log Set Not Found.
        '415':
          description: Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            LOGSET_ID = 'YOUR LOGSET ID HERE'


            def delete_logset(s: Session) -> None:
                response = s.delete(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/logsets/{LOGSET_ID}",
                                    headers={'x-api-key': API_KEY})
                if response.status_code == 204:
                    print(f'Deleted {LOGSET_ID}')
                else:
                    print(f'Failed to delete {LOGSET_ID}. status_code={response.status_code}')
                    print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                delete_logset(session)
  /management/metrics:
    get:
      operationId: metrics-retrieve_all
      summary: List All Pre-Computed Queries
      description: |
        For more context on pre-computed queries, as well as instructions on handling rate limits consult [this section's introduction](#tag/Pre-Computed-Queries).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Pre-Computed Queries
      responses:
        '200':
          description: Pre-Computed Queries in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MetricsResponseList'
              example:
                metrics:
                  - id: 12345-ef12-4887-93a5-00931be12f0a
                    name: test
                    description: ''
                    enabled: true
                    logs:
                      - id: 12345-b046-4978-a40d-244a43e3e326
                        name: Endpoint Agents
                        tokens:
                          - 12345-86d0-4481-8dcf-3a8e1ae18a8b
                        structures:
                          - 12345-3b1b-4a36-b564-45de5f8425e9
                        user_data:
                          platform_managed: 'true'
                        source_type: token
                        token_seed: null
                        retention_period: default
                        links:
                          - rel: Related
                            href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-b046-4978-a40d-244a43e3e326/topkeys
                        rrn: rrn:logsearch:eu:123445-7027-435f-b16e-b14627df8e1b:log:12345-b046-4978-a40d-244a43e3e326
                        logsets_info:
                          - id: 12345-472b-4bbd-914a-f27ad13ec45f
                            name: Asset Authentication
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-472b-4bbd-914a-f27ad13ec45f
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/121f411d-472b-4bbd-914a-f27ad13ec45f
                          - id: 12345-31bd-426f-993b-97ab87fdcc05
                            name: Logset
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-31bd-426f-993b-97ab87fdcc05
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/888c7316-31bd-426f-993b-97ab87fdcc05
                      - id: 12345-2449-4a13-a859-9be4127dd0be
                        name: Test
                        tokens:
                          - 12345-afab-4e4d-b43d-8eb9affabe7f
                        structures:
                          - 12345-3b1b-4a36-b564-45de5f8425e9
                        user_data: {}
                        source_type: token
                        token_seed: null
                        retention_period: default
                        links:
                          - rel: Related
                            href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-2449-4a13-a859-9be4127dd0be/topkeys
                        rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-2449-4a13-a859-9be4127dd0be
                        logsets_info:
                          - id: 12345-472b-4bbd-914a-f27ad13ec45f
                            name: Asset Authentication
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-472b-4bbd-914a-f27ad13ec45f
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-472b-4bbd-914a-f27ad13ec45f
                          - id: 12345-3d76-4948-a9ee-56fea8ab344f
                            name: Active Directory Admin Activity
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:4336a934-3d76-4948-a9ee-56fea8ab344f
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/4336a934-3d76-4948-a9ee-56fea8ab344f
                          - id: 12345-b9d7-4ad6-b255-d11d796e29db
                            name: Cloud Service Admin Activity
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:4a4b1677-b9d7-4ad6-b255-d11d796e29db
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/4a4b1677-b9d7-4ad6-b255-d11d796e29db
                          - id: 12345-0a71-4b9d-8314-f61307c7afbd
                            name: File Access Activity
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:528fd296-0a71-4b9d-8314-f61307c7afbd
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/528fd296-0a71-4b9d-8314-f61307c7afbd
                    logsets:
                      - id: 12345-472b-4bbd-914a-f27ad13ec45f
                        name: Asset Authentication
                        description: null
                        user_data:
                          platform_managed: 'true'
                        logs_info:
                          - id: 12345-b046-4978-a40d-244a43e3e326
                            name: Endpoint Agents
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-b046-4978-a40d-244a43e3e326
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-b046-4978-a40d-244a43e3e326
                          - id: 12345-2449-4a13-a859-9be4127dd0be
                            name: Test
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-2449-4a13-a859-9be4127dd0be
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345b-2449-4a13-a859-9be4127dd0be
                        rrn: rrn:logsearch:eu:12354-7027-435f-b16e-b14627df8e1b:logset:12345-472b-4bbd-914a-f27ad13ec45f
                    leql:
                      statement: where(result=SUCCESS)
                      function: calculate(count)
                    resolution_secs: 3600
                    retention_secs: 345600
                    enabled_since: 1678982031496
                    created: 1678982031496
                  - id: 12354-e932-37f9-b1cd-46fb080cf5ed
                    name: Successful Auths to New Assets
                    enabled: true
                    logs:
                      - id: 12345-b046-4978-a40d-244a43e3e326
                        name: Endpoint Agents
                        tokens:
                          - 12345-86d0-4481-8dcf-3a8e1ae18a8b
                        structures:
                          - 12354-3b1b-4a36-b564-45de5f8425e9
                        user_data:
                          platform_managed: 'true'
                        source_type: token
                        token_seed: null
                        retention_period: default
                        links:
                          - rel: Related
                            href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12356-b046-4978-a40d-244a43e3e326/topkeys
                        rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:796ba085-b046-4978-a40d-244a43e3e326
                        logsets_info:
                          - id: 12345-472b-4bbd-914a-f27ad13ec45f
                            name: Asset Authentication
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:123445-472b-4bbd-914a-f27ad13ec45f
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/123445-472b-4bbd-914a-f27ad13ec45f
                          - id: 12345-31bd-426f-993b-97ab87fdcc05
                            name: Test Logset
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-31bd-426f-993b-97ab87fdcc05
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-31bd-426f-993b-97ab87fdcc05
                      - id: 12345-2449-4a13-a859-9be4127dd0be
                        name: Seamus Test
                        tokens:
                          - 12345-afab-4e4d-b43d-8eb9affabe7f
                        structures:
                          - 12345-3b1b-4a36-b564-45de5f8425e9
                        user_data: {}
                        source_type: token
                        token_seed: null
                        retention_period: default
                        links:
                          - rel: Related
                            href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-2449-4a13-a859-9be4127dd0be/topkeys
                        rrn: rrn:logsearch:eu:398ef2c2-7027-435f-b16e-b14627df8e1b:log:12345-2449-4a13-a859-9be4127dd0be
                        logsets_info:
                          - id: 12345-472b-4bbd-914a-f27ad13ec45f
                            name: Asset Authentication
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-472b-4bbd-914a-f27ad13ec45f
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/121f411d-472b-4bbd-914a-f27ad13ec45f
                          - id: 12345-3d76-4948-a9ee-56fea8ab344f
                            name: Active Directory Admin Activity
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-3d76-4948-a9ee-56fea8ab344f
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-3d76-4948-a9ee-56fea8ab344f
                          - id: 12345-b9d7-4ad6-b255-d11d796e29db
                            name: Cloud Service Admin Activity
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-b9d7-4ad6-b255-d11d796e29db
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/123457-b9d7-4ad6-b255-d11d796e29db
                          - id: 12345-0a71-4b9d-8314-f61307c7afbd
                            name: File Access Activity
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-0a71-4b9d-8314-f61307c7afbd
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-0a71-4b9d-8314-f61307c7afbd
                    logsets:
                      - id: 12345-472b-4bbd-914a-f27ad13ec45f
                        name: Asset Authentication
                        description: null
                        user_data:
                          platform_managed: 'true'
                        logs_info:
                          - id: 12345-b046-4978-a40d-244a43e3e326
                            name: Endpoint Agents
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-b046-4978-a40d-244a43e3e326
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-b046-4978-a40d-244a43e3e326
                          - id: 12345-2449-4a13-a859-9be4127dd0be
                            name: Test
                            rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-2449-4a13-a859-9be4127dd0be
                            links:
                              - rel: Self
                                href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-2449-4a13-a859-9be4127dd0be
                        rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-472b-4bbd-914a-f27ad13ec45f
                    leql:
                      statement: where(new_authentication=true)
                      function: groupby(destination_user,destination_asset)
                    resolution_secs: 3600
                    retention_secs: -864000
                    enabled_since: 1678202223450
                    created: 1678202223450
        '401':
          description: Unauthorized.
        '415':
          description: Incorrect Request Body Format.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region


            def list_precomputed_queries(s: Session) -> None:
                response = s.get(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/metrics',
                                 headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                list_precomputed_queries(session)
    post:
      operationId: metrics-create
      summary: Create A Pre-Computed Query
      description: |
        For more context on pre-computed queries, as well as instructions on handling rate limits consult [this section's introduction](#tag/Pre-Computed-Queries).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Pre-Computed Queries
      requestBody:
        required: true
        content:
          application/json:
            schema:
              oneOf:
                - $ref: '#/components/schemas/MetricsInput'
                - $ref: '#/components/schemas/MetricsInputLogsetsById'
                - $ref: '#/components/schemas/MetricsInputLogsetsByName'
            example:
              metric:
                name: test
                description: test
                enabled: true
                logs:
                  - id: 12345-b046-4978-a40d-244a43e3e326
                leql:
                  statement: where(json.key > 500)
                  function: calculate(count)
                retention: 600
                resolution: 60
      responses:
        '201':
          description: Pre-Computed Query Created.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MetricsResponseSingle'
              example:
                metric:
                  id: 12345-ef12-4887-93a5-00931be12f0a
                  name: test
                  description: ''
                  enabled: true
                  logs:
                    - id: 12345-b046-4978-a40d-244a43e3e326
                      name: Endpoint Agents
                      tokens:
                        - 12345-86d0-4481-8dcf-3a8e1ae18a8b
                      structures:
                        - 12345-3b1b-4a36-b564-45de5f8425e9
                      user_data:
                        platform_managed: 'true'
                      source_type: token
                      token_seed: null
                      retention_period: default
                      links:
                        - rel: Related
                          href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-b046-4978-a40d-244a43e3e326/topkeys
                      rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-b046-4978-a40d-244a43e3e326
                      logsets_info:
                        - id: 12345-472b-4bbd-914a-f27ad13ec45f
                          name: Asset Authentication
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-472b-4bbd-914a-f27ad13ec45f
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-472b-4bbd-914a-f27ad13ec45f
                        - id: 12345-31bd-426f-993b-97ab87fdcc05
                          name: Test Logset
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-31bd-426f-993b-97ab87fdcc05
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-31bd-426f-993b-97ab87fdcc05
                    - id: 12345-2449-4a13-a859-9be4127dd0be
                      name: Test
                      tokens:
                        - 12345-afab-4e4d-b43d-8eb9affabe7f
                      structures:
                        - 12345-3b1b-4a36-b564-45de5f8425e9
                      user_data: {}
                      source_type: token
                      token_seed: null
                      retention_period: default
                      links:
                        - rel: Related
                          href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-2449-4a13-a859-9be4127dd0be/topkeys
                      rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-2449-4a13-a859-9be4127dd0be
                      logsets_info:
                        - id: 12345-472b-4bbd-914a-f27ad13ec45f
                          name: Asset Authentication
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-472b-4bbd-914a-f27ad13ec45f
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-472b-4bbd-914a-f27ad13ec45f
                        - id: 12345-3d76-4948-a9ee-56fea8ab344f
                          name: Active Directory Admin Activity
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-3d76-4948-a9ee-56fea8ab344f
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-3d76-4948-a9ee-56fea8ab344f
                        - id: 12345-b9d7-4ad6-b255-d11d796e29db
                          name: Cloud Service Admin Activity
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-b9d7-4ad6-b255-d11d796e29db
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-b9d7-4ad6-b255-d11d796e29db
                        - id: 12345-0a71-4b9d-8314-f61307c7afbd
                          name: File Access Activity
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-0a71-4b9d-8314-f61307c7afbd
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/528fd296-0a71-4b9d-8314-f61307c7afbd
                  logsets:
                    - id: 12345-472b-4bbd-914a-f27ad13ec45f
                      name: Asset Authentication
                      description: null
                      user_data:
                        platform_managed: 'true'
                      logs_info:
                        - id: 12345-b046-4978-a40d-244a43e3e326
                          name: Endpoint Agents
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-b046-4978-a40d-244a43e3e326
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-b046-4978-a40d-244a43e3e326
                        - id: 12345-2449-4a13-a859-9be4127dd0be
                          name: 12345 Test
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-2449-4a13-a859-9be4127dd0be
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-2449-4a13-a859-9be4127dd0be
                      rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-472b-4bbd-914a-f27ad13ec45f
                  leql:
                    statement: where(result=SUCCESS)
                    function: calculate(count)
                  resolution_secs: 3600
                  retention_secs: 345600
                  enabled_since: 1678982031496
                  created: 1678982031496
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '415':
          description: Incorrect Request Body Format.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'ap'  # Swap for your region
            LOG_ID = 'YOUR LOG ID HERE'
            NEW_METRIC = {
                "metric": {
                    "name": "test",
                    "description": "test",
                    "enabled": True,
                    "logs": [{"id": LOG_ID}],
                    "leql": {"statement": "where(json.key > 500)", "function": "calculate(count)"},
                    "retention": 600,
                    "resolution": 60
                }
            }


            def create_pre_computed_query(s: Session) -> None:
                response = s.post(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/metrics',
                                  headers={'x-api-key': API_KEY},
                                  json=NEW_METRIC)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                create_pre_computed_query(session)
  /management/metrics/{metric_id}:
    parameters:
      - $ref: '#/components/parameters/metrics_id'
    get:
      operationId: metrics-retrieve
      summary: Retrieve A Pre-Computed Query
      description: |
        For more context on pre-computed queries, as well as instructions on handling rate limits consult [this section's introduction](#tag/Pre-Computed-Queries).
      security:
        - Api Key Authentication:
            - Read Only and Above
      tags:
        - Pre-Computed Queries
      responses:
        '200':
          description: Pre-Computed Query in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MetricsResponseSingle'
              example:
                metric:
                  id: 12345-ef12-4887-93a5-00931be12f0a
                  name: test
                  description: ''
                  enabled: true
                  logs:
                    - id: 12345-b046-4978-a40d-244a43e3e326
                      name: Endpoint Agents
                      tokens:
                        - 12345-86d0-4481-8dcf-3a8e1ae18a8b
                      structures:
                        - 12345-3b1b-4a36-b564-45de5f8425e9
                      user_data:
                        platform_managed: 'true'
                      source_type: token
                      token_seed: null
                      retention_period: default
                      links:
                        - rel: Related
                          href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-b046-4978-a40d-244a43e3e326/topkeys
                      rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-b046-4978-a40d-244a43e3e326
                      logsets_info:
                        - id: 12345-472b-4bbd-914a-f27ad13ec45f
                          name: Asset Authentication
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-472b-4bbd-914a-f27ad13ec45f
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-472b-4bbd-914a-f27ad13ec45f
                        - id: 12345-31bd-426f-993b-97ab87fdcc05
                          name: Test Logset
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-31bd-426f-993b-97ab87fdcc05
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-31bd-426f-993b-97ab87fdcc05
                    - id: 12345-2449-4a13-a859-9be4127dd0be
                      name: Test
                      tokens:
                        - 12345-afab-4e4d-b43d-8eb9affabe7f
                      structures:
                        - 12345-3b1b-4a36-b564-45de5f8425e9
                      user_data: {}
                      source_type: token
                      token_seed: null
                      retention_period: default
                      links:
                        - rel: Related
                          href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-2449-4a13-a859-9be4127dd0be/topkeys
                      rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-2449-4a13-a859-9be4127dd0be
                      logsets_info:
                        - id: 12345-472b-4bbd-914a-f27ad13ec45f
                          name: Asset Authentication
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-472b-4bbd-914a-f27ad13ec45f
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-472b-4bbd-914a-f27ad13ec45f
                        - id: 12345-3d76-4948-a9ee-56fea8ab344f
                          name: Active Directory Admin Activity
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-3d76-4948-a9ee-56fea8ab344f
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-3d76-4948-a9ee-56fea8ab344f
                        - id: 12345-b9d7-4ad6-b255-d11d796e29db
                          name: Cloud Service Admin Activity
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-b9d7-4ad6-b255-d11d796e29db
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-b9d7-4ad6-b255-d11d796e29db
                        - id: 12345-0a71-4b9d-8314-f61307c7afbd
                          name: File Access Activity
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-0a71-4b9d-8314-f61307c7afbd
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/528fd296-0a71-4b9d-8314-f61307c7afbd
                  logsets:
                    - id: 12345-472b-4bbd-914a-f27ad13ec45f
                      name: Asset Authentication
                      description: null
                      user_data:
                        platform_managed: 'true'
                      logs_info:
                        - id: 12345-b046-4978-a40d-244a43e3e326
                          name: Endpoint Agents
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-b046-4978-a40d-244a43e3e326
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-b046-4978-a40d-244a43e3e326
                        - id: 12345-2449-4a13-a859-9be4127dd0be
                          name: 12345 Test
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-2449-4a13-a859-9be4127dd0be
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-2449-4a13-a859-9be4127dd0be
                      rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-472b-4bbd-914a-f27ad13ec45f
                  leql:
                    statement: where(result=SUCCESS)
                    function: calculate(count)
                  resolution_secs: 3600
                  retention_secs: 345600
                  enabled_since: 1678982031496
                  created: 1678982031496
        '401':
          description: Unauthorized.
        '404':
          description: Pre-Computed Query Not Found.
        '415':
          description: Incorrect Request Body Format.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            PCQ_ID = "YOUR PRE-COMPUTED QUERY ID"
            DATA_STORAGE_REGION = 'ap'  # Swap for your region


            def get_pcq_by_id(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/"
                                 f"management/metrics/{PCQ_ID}",
                                 headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                get_pcq_by_id(session)
    put:
      operationId: metrics-put
      summary: Replace a Pre-Computed Query
      description: |
        For more context on pre-computed queries, as well as instructions on handling rate limits consult [this section's introduction](#tag/Pre-Computed-Queries).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Pre-Computed Queries
      requestBody:
        required: true
        content:
          application/json:
            schema:
              oneOf:
                - $ref: '#/components/schemas/MetricsInput'
                - $ref: '#/components/schemas/MetricsInputLogsetsById'
                - $ref: '#/components/schemas/MetricsInputLogsetsByName'
            example:
              metric:
                name: test
                description: test
                enabled: true
                logs:
                  - id: 12345-b046-4978-a40d-244a43e3e326
                leql:
                  statement: where(json.key > 500)
                  function: calculate(count)
                retention: 600
                resolution: 60
      responses:
        '201':
          description: Pre-Computed Query Replaced.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MetricsResponseSingle'
              example:
                metric:
                  id: 12345-ef12-4887-93a5-00931be12f0a
                  name: test
                  description: ''
                  enabled: true
                  logs:
                    - id: 12345-b046-4978-a40d-244a43e3e326
                      name: Endpoint Agents
                      tokens:
                        - 12345-86d0-4481-8dcf-3a8e1ae18a8b
                      structures:
                        - 12345-3b1b-4a36-b564-45de5f8425e9
                      user_data:
                        platform_managed: 'true'
                      source_type: token
                      token_seed: null
                      retention_period: default
                      links:
                        - rel: Related
                          href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-b046-4978-a40d-244a43e3e326/topkeys
                      rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-b046-4978-a40d-244a43e3e326
                      logsets_info:
                        - id: 12345-472b-4bbd-914a-f27ad13ec45f
                          name: Asset Authentication
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-472b-4bbd-914a-f27ad13ec45f
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-472b-4bbd-914a-f27ad13ec45f
                        - id: 12345-31bd-426f-993b-97ab87fdcc05
                          name: Test Logset
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-31bd-426f-993b-97ab87fdcc05
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-31bd-426f-993b-97ab87fdcc05
                    - id: 12345-2449-4a13-a859-9be4127dd0be
                      name: Test
                      tokens:
                        - 12345-afab-4e4d-b43d-8eb9affabe7f
                      structures:
                        - 12345-3b1b-4a36-b564-45de5f8425e9
                      user_data: {}
                      source_type: token
                      token_seed: null
                      retention_period: default
                      links:
                        - rel: Related
                          href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-2449-4a13-a859-9be4127dd0be/topkeys
                      rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-2449-4a13-a859-9be4127dd0be
                      logsets_info:
                        - id: 12345-472b-4bbd-914a-f27ad13ec45f
                          name: Asset Authentication
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-472b-4bbd-914a-f27ad13ec45f
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-472b-4bbd-914a-f27ad13ec45f
                        - id: 12345-3d76-4948-a9ee-56fea8ab344f
                          name: Active Directory Admin Activity
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-3d76-4948-a9ee-56fea8ab344f
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-3d76-4948-a9ee-56fea8ab344f
                        - id: 12345-b9d7-4ad6-b255-d11d796e29db
                          name: Cloud Service Admin Activity
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-b9d7-4ad6-b255-d11d796e29db
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-b9d7-4ad6-b255-d11d796e29db
                        - id: 12345-0a71-4b9d-8314-f61307c7afbd
                          name: File Access Activity
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-0a71-4b9d-8314-f61307c7afbd
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/528fd296-0a71-4b9d-8314-f61307c7afbd
                  logsets:
                    - id: 12345-472b-4bbd-914a-f27ad13ec45f
                      name: Asset Authentication
                      description: null
                      user_data:
                        platform_managed: 'true'
                      logs_info:
                        - id: 12345-b046-4978-a40d-244a43e3e326
                          name: Endpoint Agents
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-b046-4978-a40d-244a43e3e326
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-b046-4978-a40d-244a43e3e326
                        - id: 12345-2449-4a13-a859-9be4127dd0be
                          name: 12345 Test
                          rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:log:12345-2449-4a13-a859-9be4127dd0be
                          links:
                            - rel: Self
                              href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logs/12345-2449-4a13-a859-9be4127dd0be
                      rrn: rrn:logsearch:eu:12345-7027-435f-b16e-b14627df8e1b:logset:12345-472b-4bbd-914a-f27ad13ec45f
                  leql:
                    statement: where(result=SUCCESS)
                    function: calculate(count)
                  resolution_secs: 3600
                  retention_secs: 345600
                  enabled_since: 1678982031496
                  created: 1678982031496
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '415':
          description: Incorrect Request Body Format.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'ap'  # Swap for your region
            PCQ_ID = "YOUR PRE-COMPUTED QUERY ID"
            LOG_ID = 'YOUR LOG ID HERE'
            NEW_METRIC = {
                "metric": {
                    "name": "test",
                    "description": "test",
                    "enabled": True,
                    "logs": [{"id": LOG_ID}],
                    "leql": {"statement": "where(json.key > 500)", "function": "calculate(count)"},
                    "retention": 600,
                    "resolution": 60
                }
            }


            def replace_pre_computed_query(s: Session) -> None:
                response = s.put(f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/metrics/{PCQ_ID}',
                                  headers={'x-api-key': API_KEY},
                                  json=NEW_METRIC)
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                replace_pre_computed_query(session)
    delete:
      operationId: metrics-delete
      summary: Delete A Pre-Computed Query
      description: |
        For more context on pre-computed queries, as well as instructions on handling rate limits consult [this section's introduction](#tag/Pre-Computed-Queries).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Pre-Computed Queries
      responses:
        '204':
          description: Pre-Computed Query Deleted.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          description: Unauthorized.
        '404':
          description: Pre-Computed Query Not Found.
        '415':
          description: Incorrect Request Body Format.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            PCQ_ID = "YOUR PRE-COMPUTED QUERY ID"
            DATA_STORAGE_REGION = 'ap'  # Swap for your region


            def delete_pcq_by_id(s: Session) -> None:
                response = s.delete(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/"
                                    f"management/metrics/{PCQ_ID}",
                                    headers={'x-api-key': API_KEY})
                if response.status_code == 204:
                    print(f"Deleted {PCQ_ID}")
                else:
                    print(f"Failed to delete {PCQ_ID}. status_code={response.status_code}")


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                delete_pcq_by_id(session)
  /management/archiving/s3setup:
    post:
      operationId: postArchivingS3Setup
      summary: Enable Daily Archiving
      description: |
        For more context on daily archiving, the configurations your S3 bucket must have, 
        and handling rate limits consult [this section's introduction](#tag/Backup-Your-Log-Data-To-S3).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Backup Your Log Data To S3
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/create_s3_archiving_setup'
            example:
              s3setup:
                bucket_name: my-bucket
                enabled: false
                compression: GZIP
      responses:
        '201':
          description: Daily Archiving Enabled.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/s3_archiving_setup'
              example:
                s3setup:
                  id: cb8b9014-f83c-4643-9529-60a0969107a0
                  bucket_name: my-bucket
                  enabled: false
                  compression: GZIP
        '400':
          description: Daily Archiving Settings Invalid.
        '401':
          description: Unauthorized.
        '403':
          description: The S3 Bucket Failed Validation.
        '415':
          description: Unsupported Media Type. Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3
          source: |
            import json
            import requests

            API_KEY = 'YOUR API KEY GOES HERE'
            REQUEST_URL = 'https://us.rest.logs.insight.rapid7.com/management/archiving/s3setup'

            data = {'s3setup':{'bucket_name':'my-bucket','enabled':False,'compression':'GZIP'}}

            def handle_response(response):
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))

            def make_request():
                headers = {'Content-type': 'application/json', 'x-api-key': API_KEY}
                body = json.dumps(data, separators=(',', ':'))
                response = requests.post(REQUEST_URL, data=body, headers=headers)
                return response

            def start():
                response = make_request()
                handle_response(response)

            if __name__ == '__main__':
                start()
    get:
      operationId: getArchivingS3Setup
      summary: View Daily Archiving Settings
      description: |
        For more context on daily archiving, the configurations your S3 bucket must have, 
        and handling rate limits consult [this section's introduction](#tag/Backup-Your-Log-Data-To-S3).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Backup Your Log Data To S3
      responses:
        '200':
          description: Daily Archiving Settings in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/s3_archiving_setup'
              example:
                s3setup:
                  id: cb8b9014-f83c-4643-9529-60a0969107a0
                  bucket_name: my-bucket
                  enabled: false
                  compression: GZIP
        '401':
          description: Unauthorized.
        '404':
          description: Daily Archiving is Not Enabled.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3
          source: |
            import json
            import requests

            API_KEY = 'YOUR API KEY GOES HERE'
            REQUEST_URL = 'https://us.rest.logs.insight.rapid7.com/management/archiving/s3setup'

            def handle_response(response):
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))

            def make_request():
                headers = {'x-api-key': API_KEY}
                response = requests.get(REQUEST_URL, headers=headers)
                return response

            def start():
                response = make_request()
                handle_response(response)

            if __name__ == '__main__':
                start()
    put:
      operationId: putArchivingS3Setup
      summary: Replace Daily Archiving Settings
      description: |
        For more context on daily archiving, the configurations your S3 bucket must have, 
        and handling rate limits consult [this section's introduction](#tag/Backup-Your-Log-Data-To-S3).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Backup Your Log Data To S3
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/create_s3_archiving_setup'
            example:
              s3setup:
                bucket_name: my-bucket
                enabled: false
                compression: GZIP
      responses:
        '200':
          description: New Daily Archiving Settings in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/s3_archiving_setup'
              example:
                s3setup:
                  id: cb8b9014-f83c-4643-9529-60a0969107a0
                  bucket_name: my-bucket
                  enabled: false
                  compression: GZIP
        '400':
          description: Daily Archiving Settings are Invalid.
        '401':
          description: Unauthorized.
        '403':
          description: The S3 Bucket Failed Validation.
        '404':
          description: Daily Archiving is Not Enabled
        '415':
          description: Unsupported Media Type. Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3
          source: |
            import json
            import requests

            API_KEY = 'YOUR API KEY GOES HERE'
            REQUEST_URL = 'https://us.rest.logs.insight.rapid7.com/management/archiving/s3setup'

            data = {'s3setup':{'bucket_name':'my-bucket','enabled':False,'compression':'GZIP'}}

            def handle_response(response):
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))

            def make_request():
                headers = {'Content-type': 'application/json', 'x-api-key': API_KEY}
                body = json.dumps(data, separators=(',', ':'))
                response = requests.put(REQUEST_URL, data=body, headers=headers)
                return response

            def start():
                response = make_request()
                handle_response(response)

            if __name__ == '__main__':
                start()
    patch:
      operationId: patchArchivingS3Setup
      summary: Modify Daily Archiving Settings
      description: |
        For more context on daily archiving, the configurations your S3 bucket must have, 
        and handling rate limits consult [this section's introduction](#tag/Backup-Your-Log-Data-To-S3).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Backup Your Log Data To S3
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/patch_s3_archiving_setup'
            example:
              s3setup:
                bucket_name: my-bucket
                enabled: false
                compression: GZIP
      responses:
        '200':
          description: Modified Daily Archiving Settings in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/s3_archiving_setup'
              example:
                s3setup:
                  id: cb8b9014-f83c-4643-9529-60a0969107a0
                  bucket_name: my-bucket
                  enabled: false
                  compression: GZIP
        '400':
          description: Daily Archiving Settings are Invalid.
        '401':
          description: Unauthorized.
        '403':
          description: The S3 Bucket Failed Validation.
        '404':
          description: Daily Archiving is Not Enabled.
        '415':
          description: Unsupported Media Type. Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3
          source: |
            import json
            import requests

            API_KEY = 'YOUR API KEY GOES HERE'
            REQUEST_URL = 'https://us.rest.logs.insight.rapid7.com/management/archiving/s3setup'

            data = {'s3setup':{'bucket_name':'my-bucket','enabled':False,'compression':'GZIP'}}

            def handle_response(response):
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))

            def make_request():
                headers = {'Content-type': 'application/json', 'x-api-key': API_KEY}
                body = json.dumps(data, separators=(',', ':'))
                response = requests.patch(REQUEST_URL, data=body, headers=headers)
                return response

            def start():
                response = make_request()
                handle_response(response)

            if __name__ == '__main__':
                start()
    delete:
      operationId: deleteArchivingS3Setup
      summary: Disable Daily Archiving
      description: |
        For more context on daily archiving, the configurations your S3 bucket must have, 
        and handling rate limits consult [this section's introduction](#tag/Backup-Your-Log-Data-To-S3).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Backup Your Log Data To S3
      responses:
        '204':
          description: Daily Archiving Disabled.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '401':
          description: Unauthorized.
        '404':
          description: Daily Archiving is Not Enabled.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3
          source: |
            import json
            import requests

            API_KEY = 'YOUR API KEY GOES HERE'
            REQUEST_URL = 'https://us.rest.logs.insight.rapid7.com/management/archiving/s3setup'

            data = {'s3setup':{'bucket_name':'my-bucket','enabled':False,'compression':'GZIP'}}

            def handle_response(response):
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))

            def make_request():
                headers = {'Content-type': 'application/json', 'x-api-key': API_KEY}
                body = json.dumps(data, separators=(',', ':'))
                response = requests.delete(REQUEST_URL, data=body, headers=headers)
                return response

            def start():
                response = make_request()
                handle_response(response)

            if __name__ == '__main__':
                start()
  /usage/organizations:
    parameters:
      - $ref: '#/components/parameters/from_usage'
      - $ref: '#/components/parameters/to_usage'
    get:
      operationId: getOrganizationsUsage
      summary: Total Data Size Across All Logs
      description: Returns the total number of bytes written to every log in your account for the specified time range (including logs that may have been deleted since that time). There is no restriction on the timerange.
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Explore The Size of Your Log Data
      responses:
        '200':
          description: Data Size in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Usage-API'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/accounts_usage_response'
              example:
                daily_usage:
                  - usage: 134929550
                    day: '2018-12-13'
                  - usage: 133613742
                    day: '2018-12-12'
                  - usage: 133206061
                    day: '2018-12-11'
                  - usage: 126998155
                    day: '2018-12-10'
                  - usage: 131107328
                    day: '2018-12-09'
                period_usage: 2427260775
                period:
                  from: '2018-12-01'
                  to: '2018-12-19'
                id: 988ec384-c5e0-4c26-b77a-714a535b126a
                name: My Account
        '401':
          description: Unauthorized.
        '404':
          description: Data Not Found.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Usage-API'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            FROM_DATE = '2023-06-19'
            TO_DATE = '2023-06-26'


            def retrieve_total_data_size(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                 f"/usage/organizations",
                                 headers={'x-api-key': API_KEY},
                                 params={'from': FROM_DATE, 'to': TO_DATE})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                retrieve_total_data_size(session)
  /usage/organizations/logs:
    parameters:
      - $ref: '#/components/parameters/from_usage'
      - $ref: '#/components/parameters/to_usage'
      - name: time_range
        in: query
        schema:
          type: string
        example: last 3 days
        description: |
          \
          An alternative to the `from` and `to` query parameters. Supported values:
          * `yesterday`
          * `last x timeunits`, where x specifies the number of time units before the current server time. Supported time units (case insensitive):
              - day(s)
              - week(s)
              - month(s)
              - year(s)

          Note: If `time_range` is used, then the `from` and `to` query parameters must not be used.
    get:
      operationId: getOrganizationsLogsUsage
      summary: Data Size Broken Down By Log
      description: Returns the total number of bytes written to each log in your account for each day in the specified time range.
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Explore The Size of Your Log Data
      responses:
        '200':
          description: Data Size in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Usage-API'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/logs_usage_response'
              example:
                per_day_usage:
                  period:
                    from: '2017-08-02'
                    to: '2017-08-02'
                  report_interval: day
                  usage_units: bytes
                  usage:
                    - interval: '2017-08-02'
                      log_usage:
                        - id: 64b88624-241e-44bb-9abc-aee5ee1e9fea
                          usage: 11000
                        - id: c1731f73-2081-4905-93b4-60a4f42675dd
                          usage: 67600
                        - id: a3731f73-2081-4905-93b4-60a4f42675dd
                          usage: 2200
        '401':
          description: Unauthorized.
        '404':
          description: Data Not Found.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Usage-API'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            FROM_DATE = '2023-06-19'
            TO_DATE = '2023-06-26'


            def retrieve_total_data_size(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                 f"/usage/organizations/logs",
                                 headers={'x-api-key': API_KEY},
                                 params={'from': FROM_DATE, 'to': TO_DATE})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                retrieve_total_data_size(session)
  /usage/organizations/logs/{log_key}:
    parameters:
      - $ref: '#/components/parameters/log_key'
      - $ref: '#/components/parameters/from_usage'
      - $ref: '#/components/parameters/to_usage'
    get:
      operationId: getOrganizationsLogUsage
      summary: Data Size For a Specific Log
      description: Returns the total number of bytes written to the specified log for each day in the specified time range.
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Explore The Size of Your Log Data
      responses:
        '200':
          description: Data Size in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Usage-API'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/log_usage_response'
              example:
                usage:
                  id: d6731f73-2081-4905-93b4-60a4f42675dd
                  period:
                    from: '2017-08-01'
                    to: '2017-07-31'
                  daily_usage:
                    - usage: 2130000
                      day: '2017-07-31'
                    - usage: 150000
                      day: '2017-08-01'
        '401':
          description: Unauthorized.
        '404':
          description: Data Not Found.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Usage-API'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            FROM_DATE = '2023-06-19'
            TO_DATE = '2023-06-26'
            LOG_ID = 'YOUR LOG ID HERE'


            def retrieve_total_data_size(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com"
                                 f"/usage/organizations/logs/{LOG_ID}",
                                 headers={'x-api-key': API_KEY},
                                 params={'from': FROM_DATE, 'to': TO_DATE})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                retrieve_total_data_size(session)
  /download/logs:
    parameters:
      - $ref: '#/components/parameters/log_ids'
    get:
      operationId: getDownloadLogs
      summary: Download Log Data
      description: |
        Returns the raw log entries in the response body. Each log entry is on a new line.
        Data can be downloaded from a maximum of 10 Logs per download request.
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Download Log Data
      parameters:
        - $ref: '#/components/parameters/from'
        - $ref: '#/components/parameters/to'
        - $ref: '#/components/parameters/time_range'
        - $ref: '#/components/parameters/query'
        - $ref: '#/components/parameters/download_logs_limit'
      responses:
        '200':
          description: Log Entries are Returned.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Download-Log-Data'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            text/plain:
              example: "{ \"timestamp\" :\t\"2023-01-26 12:02:40.728021\",\t \"action\" :\"MEMBER_ADDED_TO_SECURITY_GROUP\",\t \"source_user\" : \"concannonp\",\t \"target_user\" : \"haynesd\",\t \"target_account\" : \"cn=haynesd ou=support,ou=users,dc=tor,dc=lasvegas,dc=com\",\t \"IPAddress\" :\t\"192.168.0.132\"\t}\n{ \"timestamp\" :\t\"2023-01-26 12:04:39.910836\",\t \"action\" :\"MEMBER_ADDED_TO_SECURITY_GROUP\",\t \"source_user\" : \"concannonp\",\t \"target_user\" : \"murphyp\",\t \"target_account\" : \"cn=murphyp ou=support,ou=users,dc=tor,dc=lasvegas,dc=com\",\t \"IPAddress\" :\t\"192.168.0.131\"\t}\n{ \"timestamp\" :\t\"2023-01-26 12:06:01.063030\",\t \"action\" :\"PASSWORD_RESET\",\t \"source_user\" : \"buchnano\",\t \"target_user\" : \"thomasv\",\t \"target_account\" : \"cn=thomasv ou=support,ou=users,dc=tor,dc=lasvegas,dc=com\",\t \"IPAddress\" :\t\"192.168.0.129\"\t}\n"
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '404':
          description: Log Not Found.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Download-Log-Data'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
        '503':
          description: Service Unavailable.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: 00000000-0000-0000-0000-000000000000' \
            -G \
            https://us.rest.logs.insight.rapid7.com/download/logs/aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa:bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb:cccccccc-cccc-cccc-cccc-cccccccccccc?time_range=last 1 hour
  /exports:
    get:
      operationId: getExportJobs
      summary: Retrieve All Export Jobs
      description: |
        For more context on export jobs, as well as instructions on handling rate limits consult [this section's introduction](#tag/Export-Log-Data-To-CSV).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Export Log Data To CSV
      responses:
        '200':
          description: Export Jobs are Returned.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Export-To-CSV'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/export_jobs_response'
              example:
                export_jobs:
                  - id: 00000000-0000-0000-0000-000000000000
                    created: 1674485875021
                    format: csv
                    percentage: 100
                    status: Completed
                    expires: 1674835279937
                    links:
                      - rel: Self
                        href: https://us.rest.logs.insight.rapid7.com/log_search/exports/00000000-0000-0000-0000-000000000000
                      - rel: Download
                        href: <download link>
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Export-To-CSV'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
        '503':
          description: Service Unavailable.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: 00000000-0000-0000-0000-000000000000' \
            -G \
            https://us.rest.logs.insight.rapid7.com/exports
  /exports/{id}:
    parameters:
      - $ref: '#/components/parameters/export_job_id'
    get:
      operationId: getExportJob
      summary: Retrieve An Export Job By Id
      description: |
        For more context on export jobs, as well as instructions on handling rate limits consult [this section's introduction](#tag/Export-Log-Data-To-CSV).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Export Log Data To CSV
      responses:
        '200':
          description: Export Job is Returned.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Export-To-CSV'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/export_job_response'
              example:
                export_job:
                  id: 00000000-0000-0000-0000-000000000000
                  created: 1674485875021
                  format: csv
                  percentage: 100
                  status: Completed
                  expires: 1674835279937
                  links:
                    - rel: Self
                      href: https://us.rest.logs.insight.rapid7.com/log_search/exports/00000000-0000-0000-0000-000000000000
                    - rel: Download
                      href: <download link>
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '404':
          description: Export Job Not Found.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Export-To-CSV'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
        '503':
          description: Service Unavailable.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: 00000000-0000-0000-0000-000000000000' \
            -G \
            https://us.rest.logs.insight.rapid7.com/exports/aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa
    delete:
      operationId: deleteExportJob
      summary: Delete An Export Job By Id
      description: |
        Removes the export job with the specified ID. Only export jobs which have failed or completed can be removed.

        For more context on export jobs, as well as instructions on handling rate limits consult [this section's introduction](#tag/Export-Log-Data-To-CSV).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Export Log Data To CSV
      responses:
        '204':
          description: Export Job Deleted Successfully.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Export-To-CSV'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '404':
          description: Export Job Not Found.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Export-To-CSV'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
        '503':
          description: Service Unavailable.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -X DELETE \
            -H 'x-api-key: 00000000-0000-0000-0000-000000000000' \
            https://us.rest.logs.insight.rapid7.com/exports/aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa
  /management/labels:
    get:
      operationId: getLabels
      summary: List all Labels
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Basic Detection Rules
      responses:
        '200':
          description: Labels in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/labels_response'
              example:
                labels:
                  - id: 00000000-0000-0000-0000-000000000000
                    sn: 12345
                    name: My Label
                    color: ff0000
                    reserved: false
                  - id: ffffffff-0000-ffff-0000-ffffffff
                    sn: 54321
                    name: High Load
                    color: '660066'
                    reserved: false
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
        '503':
          description: Service Unavailable.
      x-code-samples:
        - lang: Shell
          label: curl
          source: |
            curl -H 'x-api-key: 00000000-0000-0000-0000-000000000000' \
            -G \
            https://us.rest.logs.insight.rapid7.com/management/labels/00000000-0000-0000-0000-000000000000
        - lang: Python3
          label: Python3.6+
          source: |
            import requests

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region


            def handle_response(response):
              print(response.json())
              print(response.status_code)


            def make_request():
              headers = {'x-api-key': API_KEY}
              url = f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/labels'
              request = requests.get(url, headers=headers)
              return request


            def start():
              request = make_request()
              handle_response(request)


            if __name__ == '__main__':
              start()
    post:
      operationId: postLabels
      summary: Create a Label
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/create_label'
            example:
              label:
                name: My Label
                color: ff0000
      responses:
        '201':
          description: Label Created. ID in Response.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/label_response'
              example:
                labels:
                  - id: 00000000-0000-0000-0000-000000000000
                    sn: 12345
                    name: My Label
                    color: ff0000
                    reserved: false
                  - id: ffffffff-0000-ffff-0000-ffffffff
                    sn: 54321
                    name: High Load
                    color: '660066'
                    reserved: false
        '400':
          description: Invalid Label Specified in the Request Body.
        '401':
          description: Unauthorized.
        '403':
          description: Forbidden.
        '415':
          description: Non-JSON request body was given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            import requests

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            BODY = {
            "label":
              {"sn": 12345,
               "name": "My Label",
               "color": "ff0000",
              }
            }


            def create_label():
              url = f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/labels'
              headers = {
                'x-api-key': API_KEY,
                "Content-Type": "application/json"
              }
              r = requests.post(url, data=json.dumps(BODY), headers=headers)
              print(r.status_code, r.content)


            def start():
              create_label()


            if __name__ == '__main__':
              start()
  /management/labels/{label_id}:
    parameters:
      - $ref: '#/components/parameters/label_id'
    get:
      operationId: getLabelById
      summary: Retrieve a Label
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Basic Detection Rules
      responses:
        '200':
          description: Label in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/label_response'
              example:
                label:
                  name: My label
                  color: ff0000
        '401':
          description: Unauthorized.
        '404':
          description: Label Not Found.
        '415':
          description: Request body is not in JSON format.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import requests
            import json
              
            API_KEY = 'YOUR API KEY'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            LABEL_ID = '00000000-0000-0000-0000-000000000004'


            def handle_response(response):
              if response.status_code == 200:
                print(json.dumps(response.json(), indent=4))
              else:
                print(response.status_code)


            def make_request():
              url = f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/labels/{LABEL_ID}'
              return requests.get(url, headers={'x-api-key': API_KEY})


            def get_label():
              req = make_request()
              handle_response(req)


            if __name__ == '__main__':
              get_label()
    put:
      operationId: putLabelById
      summary: Replace a Label
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/put_label'
            example:
              label:
                name: My Label
                color: ff0000
      responses:
        '200':
          description: Success. Modified Label in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/label_response'
              example:
                label:
                  name: My label
                  color: ff0000
        '400':
          description: Invalid Label Specified in Request Body.
        '401':
          description: Unauthorized.
        '403':
          description: Forbidden.
        '404':
          description: Label Not Found.
        '415':
          description: Non-JSON request body was given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            import requests

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            LABEL_ID = 'YOUR LABEL ID HERE'
            BODY = {
            "label": {
              "name": "My Replaced Label",
              "color": "ff0000"
                }
              }


            def put_label():
              url = f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/labels/{LABEL_ID}'
              headers = {
              'x-api-key': API_KEY,
              "Content-Type": "application/json"
               }
              r = requests.put(url, data=json.dumps(BODY), headers=headers)
              print(r.status_code, r.content)


            if __name__ == '__main__':
              put_label()
    patch:
      operationId: patchLabelById
      summary: Update a Label
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/patch_label'
            example:
              label:
                name: My Label
                color: ff0000
      responses:
        '200':
          description: Success. Updated Label in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/label_response'
              example:
                label:
                  name: My label
                  color: ff0000
        '400':
          description: Invalid Label Specified in Request Body.
        '401':
          description: Unauthorized.
        '403':
          description: Forbidden.
        '404':
          description: Label Not Found.
        '415':
          description: Non-JSON request body was given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            import requests

            API_KEY = 'YOUR API KEY'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            LABEL_ID = '8c67f5a3-bae5-4a25-953c-8edb0bce4c9c'
            BODY = {
            "label": {
              "name": "My Partially Updated Label"
                }
              }


            def patch_label():
              url = f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/labels/{LABEL_ID}'
              headers = {
              'x-api-key': API_KEY,
              "Content-Type": "application/json"
                }
              r = requests.patch(url, data=json.dumps(BODY), headers=headers)
              print(r.status_code, r.content)


            if __name__ == '__main__':
              patch_label()
    delete:
      operationId: deleteLabelById
      summary: Delete a Label
      description: |
        For more context on basic detection rules, notification, notification targets, and labels, 
        as well as instructions on handling rate limits, consult [this section's introduction](#tag/Basic-Detection-Rules).
      security:
        - Api Key Authentication:
            - Read Write or Above
      tags:
        - Basic Detection Rules
      responses:
        '200':
          description: Label Successfully Deleted.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '401':
          description: Unauthorized.
        '404':
          description: Label Not Found.
        '415':
          description: Non-JSON request body was given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import requests

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region
            LABEL_ID = '7882d150-4027-4914-8d4e-744c82fbda38'


            def handle_response(response):
              if response.status_code == 200:
                print("Label successfully deleted")
              else:
                print(response.status_code)


            def make_request():
              headers = {'x-api-key': API_KEY}
              url = f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/management/labels/{LABEL_ID}'
              return requests.delete(url, headers=headers)


            def delete_label():
              response = make_request()
              handle_response(response)


            if __name__ == '__main__':
              delete_label()
  /search-stats:
    get:
      operationId: getSearchStats
      summary: View Statistics On Past Queries
      description: |
        Retrieve information about your queries such as: 
        * Time taken to complete the query.
        * Amount of data searched.
        * Number of log lines in your data which matched the query.
        * LEQL statement used for the query.

        For context and information about Log Search queries, consult this [this section's introduction](#tag/Query-Log-Data).
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Query Log Data
      responses:
        '200':
          description: Statistics in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Search-Stats'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/search-stats'
              example:
                search-stats:
                  - query_id: 2496c0aa-d8db-4793-9780-980ea957d1fe
                    date: 1626283310389
                    source: logview
                    leql:
                      statement: where(status=401)
                      from: 0
                      to: 100
                      num_of_logs: 3
                    statistics:
                      duration_ms: 432
                      bytes_all: 12717132
                      bytes_checked: 4239044
                      events_all: 30
                      events_checked: 20
                      events_matched: 1
                  - query_id: 870264fb-96e0-4304-a9ff-e64b071b1a3e
                    date: 1626283310387
                    source: ''
                    leql:
                      statement: where(status=200)
                      from: 0
                      to: 100
                      num_of_logs: 3
                    statistics:
                      duration_ms: 432
                      bytes_all: 12717132
                      bytes_checked: 4239044
                      events_all: 30
                      events_checked: 20
                      events_matched: 10
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '415':
          description: Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Search-Stats'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.10
          source: |
            import requests
            import json

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region

            def handle_response(response):
              if response.status_code == 200:
                print(json.dumps(response.json(), indent=4))
              else:
                print(response.status_code)

            def make_request():
              headers = {'x-api-key': API_KEY}
              url = f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/search-stats'
              return requests.get(url, headers=headers)

            def get_search_stats():
              response = make_request()
              handle_response(response

            if __name__ == '__main__':
              get_search_stats()
  /audit/query:
    get:
      operationId: auditGetQueryEndpoints
      summary: List All Endpoints
      description: |
        This endpoint is available as a convenient way to search for audit logs. It operates the same way as the [/query](#operation/getQueryEndpoints) endpoints, which can be used to search for both audit logs and regular logs.
      tags:
        - Audit API
      responses:
        '200':
          description: Endpoints in Response Body.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListEndpointsResponse'
              example:
                /audit/query:
                  path: https://eu.rest.logs.insight.rapid7.com/audit/query
                  verbs:
                    - GET
                /audit/query/logs/{log_keys}:
                  path: https://eu.rest.logs.insight.rapid7.com/audit/query/logs/{log_keys}
                  verbs:
                    - GET
                /audit/query/logs/:
                  path: https://eu.rest.logs.insight.rapid7.com/audit/query/logs/
                  verbs:
                    - POST
                ...:
                  path: ...
                  verbs: ...
  /audit/query/{id}:
    parameters:
      - $ref: '#/components/parameters/continuation_id'
    get:
      operationId: auditPollQuery
      summary: Poll a Query In Progress
      description: |
        This endpoint is available as a convenient way to search for audit logs. It operates the same way as the [/query/{id}](#operation/pollQuery) endpoints, which can be used to search for both audit logs and regular logs. 

        Links must be polled at least once **every 20 seconds** to avoid expiration. Be cautious of polling too frequently as that can lead to rate limiting.
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Audit API
      parameters:
        - $ref: '#/components/parameters/time_range'
      responses:
        '200':
          description: Successful poll. Query is either done or on-going and response body may contain partial or full query results.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Polling'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsContinuation'
                  - $ref: '#/components/schemas/EventsResponse'
                  - $ref: '#/components/schemas/StatisticalContinuation'
                  - $ref: '#/components/schemas/StatisticalResponse'
              examples:
                EventsContinue:
                  $ref: '#/components/examples/EventsContinue'
                EventsResponseSimple:
                  $ref: '#/components/examples/EventsResponseSimple'
                EventsResponsePagination:
                  $ref: '#/components/examples/EventsResponsePagination'
                StatsContinueInitial:
                  $ref: '#/components/examples/StatsContinueInitial'
                StatisticalResponseSimple:
                  $ref: '#/components/examples/StatisticalResponseSimple'
                StatisticalResponseTimeSeriesMultiGroupBy:
                  $ref: '#/components/examples/StatisticalResponseTimeSeriesMultiGroupBy'
        '400':
          description: Invalid Continuation ID.
        '401':
          description: Unauthorized.
        '404':
          description: Query Not Found (Continuation ID may have expired).
        '415':
          description: Non-JSON request body was given (Note, the endpoint does not take a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Polling'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
  /audit/query/logs/{log_keys}:
    parameters:
      - $ref: '#/components/parameters/log_keys_deprecated'
    get:
      operationId: auditGetQueryLogs
      summary: Query Individual Logs Using LEQL
      description: |
        This endpoint is available as a convenient way to search for audit logs. It operates the same way as the [/query/logs/{log_keys}](#operation/getQueryLogs) endpoints, which can be used to search for both audit logs and regular logs.
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Audit API
      parameters:
        - $ref: '#/components/parameters/query'
        - $ref: '#/components/parameters/from'
        - $ref: '#/components/parameters/to'
        - $ref: '#/components/parameters/time_range'
        - $ref: '#/components/parameters/label'
        - $ref: '#/components/parameters/labels'
        - $ref: '#/components/parameters/per_page'
        - $ref: '#/components/parameters/export_format'
        - $ref: '#/components/parameters/kvp_info'
        - $ref: '#/components/parameters/most_recent_first'
        - $ref: '#/components/parameters/sequence_number'
      responses:
        '200':
          description: Results in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsResponse'
                  - $ref: '#/components/schemas/StatisticalResponse'
              examples:
                EventsResponseSimple:
                  $ref: '#/components/examples/EventsResponseSimple'
                EventsResponsePagination:
                  $ref: '#/components/examples/EventsResponsePagination'
                StatisticalResponseSimple:
                  $ref: '#/components/examples/StatisticalResponseSimple'
                StatisticalResponseTimeSeriesMultiGroupBy:
                  $ref: '#/components/examples/StatisticalResponseTimeSeriesMultiGroupBy'
        '202':
          description: Query in Progress. Links in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsContinuation'
                  - $ref: '#/components/schemas/StatisticalContinuation'
              examples:
                EventsContinue:
                  $ref: '#/components/examples/EventsContinue'
                EventsContinueExportCSV:
                  $ref: '#/components/examples/EventsContinueExportCSV'
                StatsContinueInitial:
                  $ref: '#/components/examples/StatsContinueInitial'
        '400':
          description: Invalid Query Request.
        '401':
          description: Unauthorized.
        '404':
          description: Log Not Found.
        '415':
          description: Non-JSON request body was given (Note, the endpoint takes a request body).
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
  /audit/exports:
    get:
      operationId: auditGetExportJobs
      summary: Retrieve All Export Jobs
      description: |
        This endpoint is available as a convenient way to search for audit logs. It operates the same way as the [/exports](#operation/getExportJobs) endpoints, which can be used to search for both audit logs and regular logs.
      tags:
        - Audit API
      security:
        - Api Key Authentication:
            - Read Only or Above
      responses:
        '200':
          description: Export Jobs are Returned.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Export-To-CSV'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/export_jobs_response'
              example:
                export_jobs:
                  - id: 00000000-0000-0000-0000-000000000000
                    created: 1674485875021
                    format: csv
                    percentage: 100
                    status: Completed
                    expires: 1674835279937
                    links:
                      - rel: Self
                        href: https://us.rest.logs.insight.rapid7.com/log_search/exports/00000000-0000-0000-0000-000000000000
                      - rel: Download
                        href: <download link>
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Export-To-CSV'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
        '503':
          description: Service Unavailable.
  /audit/exports/{id}:
    parameters:
      - $ref: '#/components/parameters/export_job_id'
    get:
      operationId: auditGetExportJob
      summary: Retrieve An Export Job By Id
      description: |
        This endpoint is available as a convenient way to search for audit logs. It operates the same way as the [/exports/{id}](#operation/getExportJob) endpoints, which can be used to search for both audit logs and regular logs.
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Audit API
      responses:
        '200':
          description: Export Job is Returned.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Export-To-CSV'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/export_job_response'
              example:
                export_job:
                  id: 00000000-0000-0000-0000-000000000000
                  created: 1674485875021
                  format: csv
                  percentage: 100
                  status: Completed
                  expires: 1674835279937
                  links:
                    - rel: Self
                      href: https://us.rest.logs.insight.rapid7.com/log_search/exports/00000000-0000-0000-0000-000000000000
                    - rel: Download
                      href: <download link>
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '404':
          description: Export Job Not Found.
        '415':
          description: Unsupported Media Type.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit-Export-To-CSV'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
        '503':
          description: Service Unavailable.
  /audit/query/logs:
    post:
      operationId: auditPostQueryLogs
      summary: Query Multiple Logs Using LEQL
      description: |
        This endpoint is available as a convenient way to search for audit logs. It operates the same way as the [/query/logs](#operation/postQueryLogs) endpoints, which can be used to search for both audit logs and regular logs.
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Audit API
      requestBody:
        description: |
          The JSON payload must contain:
          * a non-empty array of the log keys for the logs that will be queried
          * a `leql` object, containing a value for either of the following (but **not** for both):
            - `leql.during.time_range`
            - `leql.during.from` and `leql.during.to`

          The `leql.statement` can be empty or omitted.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                logs:
                  $ref: '#/components/schemas/logs'
                leql:
                  $ref: '#/components/schemas/leql'
              example:
                logs:
                  - 565c1b7b-c08b-4c87-a42a-ab08bad56071
                  - c78579a8-8b20-4e6a-d4c0-5287198a263b
                leql:
                  during:
                    time_range: last 1 hour
                  statement: where(931dde6c60>=800)
      parameters:
        - $ref: '#/components/parameters/per_page'
        - $ref: '#/components/parameters/export_format'
        - $ref: '#/components/parameters/kvp_info'
        - $ref: '#/components/parameters/most_recent_first'
        - $ref: '#/components/parameters/labels'
        - $ref: '#/components/parameters/sequence_number'
      responses:
        '200':
          description: Results in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsResponse'
                  - $ref: '#/components/schemas/StatisticalResponse'
              examples:
                EventsResponseSimple:
                  $ref: '#/components/examples/EventsResponseSimple'
                EventsResponsePagination:
                  $ref: '#/components/examples/EventsResponsePagination'
                StatisticalResponseSimple:
                  $ref: '#/components/examples/StatisticalResponseSimple'
                StatisticalResponseTimeSeriesMultiGroupBy:
                  $ref: '#/components/examples/StatisticalResponseTimeSeriesMultiGroupBy'
        '202':
          description: Query in Progress. Links in Response Body.
          headers:
            x-beyond-retention:
              $ref: '#/components/headers/x-beyond-retention'
            x-beyond-retention-message:
              $ref: '#/components/headers/x-beyond-retention-message'
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/EventsContinuation'
                  - $ref: '#/components/schemas/StatisticalContinuation'
              examples:
                EventsContinue:
                  $ref: '#/components/examples/EventsContinue'
                EventsContinueExportCSV:
                  $ref: '#/components/examples/EventsContinueExportCSV'
                StatsContinueInitial:
                  $ref: '#/components/examples/StatsContinueInitial'
        '400':
          description: Malformed JSON Request Body.
        '401':
          description: Unauthorized.
        '404':
          description: Log Not Found.
        '415':
          description: Data not specified as JSON.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
          content:
            text/plain:
              schema:
                type: string
              example: API rate limit exceeded
        '500':
          description: Internal Server Error.
  /audit/management/logs:
    get:
      operationId: getAllAuditLogs
      summary: Retrieve All Audit Logs
      description: |
        Returns all "audit" logs for this account. The "audit" logs are a subset of all the logs, and include the logs 
        inside the "Internal Logs" logset, e.g., "Web Access Log", which report on activity within Log Search itself.
      security:
        - Api Key Authentication:
            - Read Only or Above
      tags:
        - Audit API
      responses:
        '200':
          description: Logs in Response Body.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/audit_log_list'
              example:
                logs:
                  - id: 12345-12345-12345-12345
                    name: Test
                    rrn: rrn:logsearch:eu::platform-audit-log:12345-12345-12345-12345
                    logsets_info:
                      - id: 12345-12345-12345-12345
                        name: EU
                        rrn: rrn:logsearch:eu::platform-audit-logset:12345-12345-12345-12345
                        links:
                          - rel: Self
                            href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-12345-12345-12345
                  - id: 12345-12345-12345-12345
                    name: LOGS_AUDIT
                    rrn: rrn:logsearch:eu::platform-audit-log:12345-12345-12345-12345
                    logsets_info:
                      - id: 12345-12345-12345-12345
                        name: AP
                        rrn: rrn:logsearch:eu::platform-audit-logset:12345-12345-12345-12345
                        links:
                          - rel: Self
                            href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-12345-12345-12345
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '415':
          description: Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region


            def get_audit_logs(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/audit/management/logs",
                                 headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                get_audit_logs(session)
  /audit/management/logs/{id}:
    parameters:
      - $ref: '#/components/parameters/log_id'
    get:
      operationId: getAuditLog
      summary: Retrieve An Audit Log
      description: |
        Returns the "audit" log with that **{id}**. The "audit" logs are a subset of all the logs, and include the logs 
        inside the "Internal Logs" logset, e.g., "Web Access Log", which report on activity within Log Search itself.
      tags:
        - Audit API
      security:
        - Api Key Authentication:
            - Read Only or Above
      responses:
        '200':
          description: Log is Returned.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/audit_log_single'
              example:
                log:
                  id: 12345-12345-12345
                  name: Test
                  rrn: rrn:logsearch:eu::platform-audit-log:12345-12345-12345
                  logsets_info:
                    - id: 12345-12345-12345
                      name: Testing
                      rrn: rrn:logsearch:eu::platform-audit-logset:12345-12345-12345
                      links:
                        - rel: Self
                          href: https://eu.rest.logs.insight.rapid7.com/log_search/management/logsets/12345-12345-12345
        '400':
          description: Invalid Request.
        '401':
          description: Unauthorized.
        '415':
          description: Non-JSON Request Body Given.
        '429':
          description: Rate Limited.
          headers:
            X-RateLimit-Limit:
              $ref: '#/components/headers/X-RateLimit-Limit'
            X-RateLimit-Remaining:
              $ref: '#/components/headers/X-RateLimit-Remaining'
            X-RateLimit-Reset:
              $ref: '#/components/headers/X-RateLimit-Reset'
            Retry-After:
              $ref: '#/components/headers/Retry-After'
        '500':
          description: Internal Server Error.
      x-code-samples:
        - lang: Python
          label: Python3.6+
          source: |
            import json
            from requests import Session
            from requests.adapters import HTTPAdapter
            from urllib3.util.retry import Retry

            API_KEY = 'YOUR API KEY HERE'
            AUDIT_LOG_ID = 'YOUR AUDIT LOG ID HERE'
            DATA_STORAGE_REGION = 'eu'  # Swap for your region


            def get_audit_log(s: Session) -> None:
                response = s.get(f"https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com/audit/management/logs/{AUDIT_LOG_ID}",
                                 headers={'x-api-key': API_KEY})
                print(response.status_code)
                print(json.dumps(response.json(), indent=4))


            if __name__ == '__main__':
                session = Session()
                session.mount(
                    f'https://{DATA_STORAGE_REGION}.rest.logs.insight.rapid7.com',
                    HTTPAdapter(max_retries=(
                        # Handles rate limiting by default, by sleeping until the limit has reset before retrying.
                        Retry(total=3,
                              backoff_factor=1,
                              status_forcelist=[500, 502, 503, 504])
                    ))
                )
                get_audit_log(session)
components:
  securitySchemes:
    Api Key Authentication:
      description: |
        There are three categories for API Keys:
          * Read-Only
          * Read-Write
          * Admin

        They can be created on the [API Keys Management](https://docs.rapid7.com/insight/managing-platform-api-keys) page of your Insight Platform account. Make sure to copy the key afterwards because you
        will not be able to view it again.
      type: apiKey
      in: header
      name: x-api-key
  schemas:
    ListEndpointsResponse:
      type: object
      additionalProperties:
        x-additionalPropertiesName: endpoint
        type: object
        properties:
          path:
            type: string
          verbs:
            type: array
            items:
              type: string
    logs:
      description: The log keys of the logs which the query is run against.
      type: array
      items:
        type: string
      example:
        - 565c1b7b-c08b-4c87-a42a-ab08bad56071
        - c78579a8-8b20-4e6a-d4c0-5287198a263b
    leql:
      description: The LEQL statement of the query, along with the time range.
      type: object
      properties:
        during:
          type: object
          properties:
            from:
              type: integer
              description: The start of the time range for the query, as a UNIX timestamp in milliseconds.
            to:
              type: integer
              description: The end of the time range for the query, as a UNIX timestamp in milliseconds.
            time_range:
              type: string
              description: |
                \
                Relative time range (instead of absolute `from` + `to` time range). Possible values:
                * `yesterday`
                * `today`
                * `last x timeunits` where x is the number of time unit back from the current server time. Supported time units (case insensitive):
                    - min(s) or minute(s)
                    - hr(s) or hour(s)
                    - day(s)
                    - week(s)
                    - month(s)
                    - year(s)
        statement:
          type: string
          description: |
            \
            The LEQL query run against the log(s).
            If empty, the query retrieves all log entries in the specified time range.

            Cannot be empty for saved queries.
      required:
        - statement
    links:
      type: array
      items:
        type: object
        properties:
          rel:
            type: string
          href:
            type: string
        required:
          - rel
          - href
    labels:
      description: the UUIDs of all labels of the log entry (and a link to **/management/labels/{label_id}**).
      type: array
      items:
        type: object
        properties:
          links:
            $ref: '#/components/schemas/links'
          id:
            type: string
    kvp_info:
      description: Information about the KVPs in the log entry that were parsed when they were received.
      type: array
      items:
        type: object
        properties:
          key:
            type: object
            properties:
              text:
                description: the identifier of the key.
                type: string
              start:
                description: the position in the log entry of the first character of the key (the first character in the log entry is at position 0).
                type: integer
              end:
                description: the position in the log entry of the next character after the last character of the key.
                type: integer
            required:
              - text
              - start
              - end
          value:
            type: object
            properties:
              text:
                description: the data associated with the key.
                type: string
              start:
                description: the position in the log entry of the first character of the value (first character in the log entry is at position 0).
                type: integer
              end:
                description: the position in the log entry of the next character after the last character of the value.
                type: integer
            required:
              - text
              - start
              - end
        required:
          - key
          - value
    event_query:
      type: object
      properties:
        labels:
          $ref: '#/components/schemas/labels'
        timestamp:
          description: The UNIX timestamp in milliseconds, of when the log entry was received.
          type: integer
        sequence_number:
          description: The sequence number of the log entry (a unique identifier used to distinguish between log entries received in the same millisecond).
          type: integer
        log_id:
          description: The key of the log that the entry belongs to.
          type: string
        message:
          description: The log entry itself.
          type: string
        links:
          $ref: '#/components/schemas/links'
        sequence_number_str:
          description: The sequence number as a string, rather than as an integer.
          type: string
        kvp_info:
          $ref: '#/components/schemas/kvp_info'
      required:
        - timestamp
        - log_id
        - sequence_number
        - sequence_number_str
        - message
    events_query_response:
      description: |
        The result of the query - the matching log entries (with metadata).
        It is empty for 202 responses.
      type: array
      items:
        $ref: '#/components/schemas/event_query'
    query_api_links:
      type: array
      items:
        type: object
        properties:
          rel:
            description: |
              If equal to "Self", then href contains a link to poll the in-progress query.
              If equal to "Next", then href contains a link to retrieve the next page of results.
            type: string
          href:
            description: A http link to which a `GET` request can be made.
            type: string
        required:
          - rel
          - href
    EventsResponse:
      title: Event Search Response
      type: object
      properties:
        logs:
          $ref: '#/components/schemas/logs'
        leql:
          $ref: '#/components/schemas/leql'
        events:
          $ref: '#/components/schemas/events_query_response'
        links:
          $ref: '#/components/schemas/query_api_links'
      required:
        - logs
        - leql
        - events
    stats:
      type: object
      properties:
        average:
          type: number
        min:
          type: number
        max:
          type: number
        median:
          type: number
        percentile_<1 to 99>*:
          type: number
        count:
          type: number
        sum:
          type: number
        standarddeviation:
          type: number
        unique:
          type: number
        bytes:
          type: number
    groups:
      description: Holds the overall result for each group in a 'groupby' query.
      type: array
      items:
        type: object
        additionalProperties:
          x-additionalPropertiesName: <group key>
          $ref: '#/components/schemas/stats'
    timeseries:
      description: Holds the query results for each timeslice (each partition of the time_range) (10 by default). For non-'groupby' queries.
      type: object
      additionalProperties:
        x-additionalPropertiesName: <the given key|"global_timeseries">
        type: array
        items:
          $ref: '#/components/schemas/stats'
      minProperties: 0
      maxProperties: 1
    groups_timeseries:
      description: For 'groupby' queries, holds the timeseries object for each group.
      type: array
      items:
        type: object
        additionalProperties:
          x-additionalPropertiesName: <group key>
          type: object
          properties:
            group_timeseries:
              $ref: '#/components/schemas/groups_timeseries'
            series:
              type: array
              items:
                $ref: '#/components/schemas/stats'
            totals:
              $ref: '#/components/schemas/stats'
          required:
            - group_timeseries
            - series
            - totals
    statistics:
      description: The result of the 'calculate' function and/or any 'groupby' queries. 202 responses may provide a partial result.
      type: object
      properties:
        stats:
          description: |
            Holds the overall result when query does not contain a 'groupby' clause.

            Examples:
            * `"stats": {"key1": {"sum": <RESULT>}}` for a 'calculate(SUM:key1)' query

            * `"stats": {"number": {"average": <RESULT>}}` for a 'calculate(AVERAGE:number)' query

            * `"stats": {"global_timeseries": {"count": <RESULT>}}` for a 'count' query
          type: object
          additionalProperties:
            x-additionalPropertiesName: <the key in calculate clause OR 'global_timeseries'>
            $ref: '#/components/schemas/stats'
          minProperties: 0
          maxProperties: 1
        groups:
          $ref: '#/components/schemas/groups'
        granularity:
          description: The time window in milliseconds for each time slice in the time series.
          type: integer
        timeseries:
          $ref: '#/components/schemas/timeseries'
        groups_timeseries:
          $ref: '#/components/schemas/groups_timeseries'
        from:
          description: The start of the time range for the query, as a UNIX timestamp in milliseconds.
          type: integer
        to:
          description: The end of the time range for the query, as a UNIX timestamp in milliseconds.
          type: integer
        type:
          description: The type of function performed, for example, "count", "max", "average", "standarddeviation".
          type: string
        key:
          description: The key which the function of the 'calculate' clause is applied to (for example, `number` in `calculate(SUM:number)`).
          type: string
        cardinality:
          description: Always 0. (Not implemented)
          type: integer
        others:
          description: Not yet implemented.
          type: object
        status:
          description: holds a status code for the query(for example, 200, 202, 204, 400), potentially different from the status code of the response.
          type: integer
        all_exact_results:
          description: |
            Boolean indicating whether groups are calculated approximately (approximated if a groupby query involves over 10,000 groups).
            Equal to "null" if query is not a groupby query.
          type: boolean
          x-nullable: true
      required:
        - cardinality
        - granularity
        - from
        - to
        - type
        - stats
        - groups
        - others
        - status
        - timeseries
        - groups_timeseries
        - all_exact_results
      additionalProperties:
        x-additionalPropertiesName: <"calculate" function>
        type: number
        description: |
          If the function is "count" result is the count; otherwise returns 0.

          Examples:
          * `"count": 10`
          * `"standarddeviation": 0`
          * `"sum": 0`:
    search_stats:
      description: It includes the metrics of the executed query.
      type: object
      properties:
        duration_ms:
          description: The time taken to complete the query, in milliseconds.
          type: integer
        bytes_all:
          description: The total number of bytes.
          type: integer
        bytes_checked:
          description: The number of bytes checked.
          type: integer
        events_all:
          description: The total number of events.
          type: integer
        events_checked:
          description: The number of events checked.
          type: integer
        events_matched:
          description: The number of events matched.
          type: integer
        index_factor:
          description: |
            This shows if the query was able to use our indexing technology to help reduce the query duration.
            * Value of 0: Indexing could not be used.
            * Value of 1: Full indexing was achieved to reduce the query duration.
          type: number
    StatisticalResponse:
      title: Statistical Search Response
      type: object
      properties:
        logs:
          $ref: '#/components/schemas/logs'
        leql:
          $ref: '#/components/schemas/leql'
        statistics:
          $ref: '#/components/schemas/statistics'
        search_stats:
          $ref: '#/components/schemas/search_stats'
      required:
        - logs
        - leql
        - statistics
        - search_stats
    EventsContinuation:
      title: Event Search In Progress
      type: object
      properties:
        logs:
          $ref: '#/components/schemas/logs'
        leql:
          $ref: '#/components/schemas/leql'
        progress:
          description: The completion of the query in percent (0 to 99).
          type: integer
        id:
          description: The query ID which can be used to poll the query on the **/query/{id}** endpoint.
          type: string
        events:
          $ref: '#/components/schemas/events_query_response'
        links:
          $ref: '#/components/schemas/query_api_links'
      required:
        - logs
        - leql
        - progress
        - id
        - events
        - links
    StatisticalContinuation:
      title: Statistical Search In Progress
      type: object
      properties:
        logs:
          $ref: '#/components/schemas/logs'
        leql:
          $ref: '#/components/schemas/leql'
        progress:
          description: The completion of the query in percent (0 to 99).
          type: integer
        id:
          description: The query ID which can be used to poll the query on the **/query/{id}** endpoint.
          type: string
        events:
          type: array
          items:
            type: object
          description: This array is always empty.
        partial:
          $ref: '#/components/schemas/statistics'
        links:
          $ref: '#/components/schemas/query_api_links'
      required:
        - logs
        - leql
        - progress
        - id
        - events
        - partial
        - links
    saved_query:
      type: object
      properties:
        id:
          description: The unique id of the saved query.
          type: string
        name:
          description: The name of the saved query.
          type: string
        leql:
          $ref: '#/components/schemas/leql'
        logs:
          $ref: '#/components/schemas/logs'
      required:
        - id
        - name
    create_saved_query:
      name: saved_query
      type: object
      properties:
        saved_query:
          type: object
          properties:
            name:
              type: string
              description: The name for the Saved Query (doesn't need to be unique).
            leql:
              $ref: '#/components/schemas/leql'
            logs:
              $ref: '#/components/schemas/logs'
          required:
            - name
    leql_PATCH:
      description: The LEQL statement of the query and/or the time range.
      type: object
      properties:
        during:
          description: The time range for the query. Either absolute or relative to the current time.
          type: object
          properties:
            from:
              type: integer
              description: The start of the time range for the query, as a UNIX timestamp in milliseconds.
            to:
              type: integer
              description: The end of the time range for the query, as a UNIX timestamp in milliseconds.
            time_range:
              type: string
              description: |
                \
                Relative time range (instead of absolute `from` + `to` time range). Possible values:
                * `yesterday`
                * `today`
                * `last x timeunits` where x is the number of time unit back from the current server time. Supported time units (case insensitive):
                    - min(s) or minute(s)
                    - hr(s) or hour(s)
                    - day(s)
                    - week(s)
                    - month(s)
                    - year(s)
        statement:
          type: string
          description: |
            \
            The LEQL query run against the log(s).
            If empty, the query retrieves all log entries in the specified time range.

            Cannot be empty for saved queries.
    patch_saved_query:
      name: saved_query
      type: object
      properties:
        saved_query:
          type: object
          properties:
            name:
              type: string
              description: The name for the Saved Query (doesn't need to be unique).
            leql:
              $ref: '#/components/schemas/leql_PATCH'
            logs:
              $ref: '#/components/schemas/logs'
    variable_id:
      type: string
      description: Unique variable ID. UUID.
      example: 123e4567-e89b-12d3-a456-426614174000
    variable_name:
      type: string
      description: Variable name.
      example: BadIPs
      pattern: ^[a-zA-Z0-9_]{1,128}$
    variable_description:
      type: string
      description: Variable description.
      example: List of banned IP addresses
      minLength: 0
      maxLength: 1024
      nullable: true
    variable_value:
      type: string
      description: Variable contents.
      example: IP(10.0.0.0/8), IP(5.0.0.0/8)
      minLength: 1
      maxLength: 1024
    variable_user_id:
      type: string
      example: 00000000-0000-0000-0000-000000000001
      description: The ID of the user that created the variable.
    variable_created_timestamp:
      type: string
      example: '2022-10-21T11:51:53.971784'
      description: The date/time when the variable was created.
    variable_updated_timestamp:
      type: string
      example: '2022-10-21T11:51:53.971784'
      description: The date/time when the variable was updated.
    variable_reserved:
      type: boolean
      description: Reserved variables cannot be modified.
      example: false
    leql_variable_response:
      type: object
      required:
        - id
        - name
        - value
      properties:
        id:
          $ref: '#/components/schemas/variable_id'
        name:
          $ref: '#/components/schemas/variable_name'
        description:
          $ref: '#/components/schemas/variable_description'
        value:
          $ref: '#/components/schemas/variable_value'
        userId:
          $ref: '#/components/schemas/variable_user_id'
        created:
          $ref: '#/components/schemas/variable_created_timestamp'
        updated:
          $ref: '#/components/schemas/variable_updated_timestamp'
        reserved:
          $ref: '#/components/schemas/variable_reserved'
    leql_variable_request:
      type: object
      required:
        - name
        - value
      properties:
        name:
          $ref: '#/components/schemas/variable_name'
        description:
          $ref: '#/components/schemas/variable_description'
        value:
          $ref: '#/components/schemas/variable_value'
    logs_live_tail:
      description: The log keys of the logs for the live tail feed.
      type: array
      items:
        type: string
      example:
        - 565c1b7b-c08b-4c87-a42a-ab08bad56071
        - c78579a8-8b20-4e6a-d4c0-5287198a263b
    leql_live_tail:
      description: The LEQL statement of the query.
      type: object
      properties:
        statement:
          type: string
          description: |
            \
            The LEQL query that incoming log entries are matched against.
            If empty, the query matches all incoming log entries.

            Cannot be a statistical query ('calculate' or 'groupby' query).
    event_live_tail:
      type: object
      properties:
        labels:
          $ref: '#/components/schemas/labels'
        timestamp:
          description: The UNIX timestamp in milliseconds, of when the log entry was received.
          type: integer
        sequence_number:
          description: The sequence number of the log entry (a unique identifier used to distinguish between log entries received in the same millisecond).
          type: integer
        log_id:
          description: The key of the log that the entry belongs to.
          type: string
        message:
          description: The log entry itself.
          type: string
        sequence_number_str:
          description: The sequence number as a string, rather than as an integer.
          type: string
      required:
        - timestamp
        - log_id
        - sequence_number
        - sequence_number_str
        - message
    events_live_tail_start:
      description: |
        Always empty.
      type: array
      items:
        $ref: '#/components/schemas/event_live_tail'
    LiveTailResponse:
      type: object
      properties:
        logs:
          $ref: '#/components/schemas/logs_live_tail'
        leql:
          $ref: '#/components/schemas/leql_live_tail'
        events:
          $ref: '#/components/schemas/events_live_tail_start'
        links:
          $ref: '#/components/schemas/links'
      required:
        - logs
        - leql
        - events
        - links
    events_live_tail_poll:
      description: |
        The log entries (with metadata) ingested which match the query.
      type: array
      items:
        $ref: '#/components/schemas/event_live_tail'
    LiveTailPollResponse:
      type: object
      properties:
        logs:
          $ref: '#/components/schemas/logs_live_tail'
        leql:
          $ref: '#/components/schemas/leql_live_tail'
        events:
          $ref: '#/components/schemas/events_live_tail_poll'
        links:
          $ref: '#/components/schemas/links'
      required:
        - logs
        - leql
        - events
        - links
    logs_context:
      description: The log key of the log which contains the contextual log entries.
      type: array
      items:
        type: string
      example:
        - 565c1b7b-c08b-4c87-a42a-ab08bad56071
    leql_context:
      description: Contains the timestamps of the first and last log entry on the current page of contextual log entries.
      type: object
      properties:
        during:
          type: object
          properties:
            from:
              description: The timestamp of the first (earliest) log entry on the current page.
              type: integer
            to:
              description: The timestamp of the last (latest) log entry on the current page.
              type: integer
        statement:
          description: Always null.
          type: string
    events_context:
      description: |
        The contextual log entries for the given log entry.
        It is empty for a 202 response.
      type: array
      items:
        $ref: '#/components/schemas/event_query'
    context_api_links:
      type: array
      items:
        type: object
        properties:
          rel:
            description: |
              If equal to **Self**, then href contains a link to poll the query that's in progress.
              If equal to **Next**, then href contains a link to retrieve the next page of results.
              If equal to **Prev**, then href contains a link to retrieve the previous page of results.
            type: string
          href:
            description: A http link to which a `GET` request can be made.
            type: string
        required:
          - rel
          - href
    ContextResponse:
      type: object
      properties:
        logs:
          $ref: '#/components/schemas/logs_context'
        leql:
          $ref: '#/components/schemas/leql_context'
        events:
          $ref: '#/components/schemas/events_context'
        links:
          $ref: '#/components/schemas/context_api_links'
      required:
        - logs
        - events
        - leql
    ContextContinueResponse:
      type: object
      properties:
        logs:
          $ref: '#/components/schemas/logs_context'
        leql:
          $ref: '#/components/schemas/leql_context'
        progress:
          description: The completion of the query in percent (0 to 99).
          type: integer
        id:
          description: The query ID which can be used to poll the query on the **/query/{id}** endpoint.
          type: string
        events:
          $ref: '#/components/schemas/events_context'
        links:
          $ref: '#/components/schemas/context_api_links'
      required:
        - logs
        - leql
        - progress
        - id
        - events
    member_info:
      description: |
        The information on each log set that this log is part of.
      type: array
      items:
        type: object
        properties:
          id:
            description: The UUID of the log set.
            type: string
          name:
            description: The name of the log set.
            type: string
          rrn:
            description: The Rapid7 Resource Name (RRN) of the Log Set. The RRN is a unique identifier across the Rapid7 Platform.
            type: string
          links:
            $ref: '#/components/schemas/links'
        required:
          - id
          - name
    retention_period_enum:
      type: string
      enum:
        - 1w
        - 2w
        - 1m
        - 2m
        - 6m
        - 1y
        - 2y
        - unlimited
        - default
    log_info_response:
      type: object
      properties:
        id:
          description: The UUID of the log.
          type: string
        name:
          description: The name of the log.
        tokens:
          description: The log token(s) used for writing to the log. This only applies to token type logs (view the `source_type` parameter).
          type: array
          items:
            type: string
        structures:
          description: |
            Structures are internal entities which may apply some additional processing to log entries written to this log.
          type: array
          items:
            type: string
        ip_address:
          description: The IP address that the Log Search system receives log entries from. This only applies to syslog type logs (view the `source_type` parameter).
          type: string
        logsets_info:
          $ref: '#/components/schemas/member_info'
        user_data:
          description: A list of key-values pairs that may indicate some auxiliary information about the log.
          type: object
          additionalProperties:
            x-additionalPropertiesName: <key>
            type: string
        source_type:
          description: |
            A categorization of logs which defines how log entries are received by a server.
            * Syslog type logs are associated with an IP address and a port (the values appear in the `user_data` field). Any log entries received by the server on that port and from that IP address will belong to that log.
            * Token type logs are associated with a log token. Any log entries received by the server on one of the [standard ports](https://docs.rapid7.com/insightops/token-tcp) containing that log token will belong to that log (with the log token removed from the log entry).
            * Internal type logs use internal mechanisms to receive log entries, for example any of the logs in the Internal Logs log set.
          type: string
          enum:
            - syslog
            - token
            - internal
          default: token
        rrn:
          description: The Rapid7 Resource Name (RRN) of the log. The RRN is a unique identifier across the Rapid7 Platform.
          type: string
        token_seed:
          description: The seed used to generate the log token (if the log's source type is `"token"`).
        retention_period:
          description: The amount of time the log's entries are stored for.
          type: string
          $ref: '#/components/schemas/retention_period_enum'
        links:
          $ref: '#/components/schemas/links'
      required:
        - id
        - name
        - links
    logs_metrics:
      description: The information of the logs used in the pre-computed query.
      type: array
      items:
        $ref: '#/components/schemas/log_info_response'
    member_info_logset:
      description: |
        Information on each log that this log set contains.
      type: array
      items:
        type: object
        properties:
          id:
            description: The UUID of the log.
            type: string
          name:
            description: The name of the log.
            type: string
          rrn:
            description: The Rapid7 Resource Name (RRN) of the log. The RRN is a unique identifier across the Rapid7 Platform.
            type: string
          links:
            $ref: '#/components/schemas/links'
        required:
          - id
          - name
    logset_info:
      type: object
      properties:
        id:
          description: The UUID of the log set.
          type: string
        name:
          description: The name of the log set.
        description:
          type: string
          description: The description of the log set.
        user_data:
          description: A list of key-value pairs that may indicate some auxiliary information about the log set.
          type: object
        logs_info:
          $ref: '#/components/schemas/member_info_logset'
        rrn:
          description: The Rapid7 Resource Name (RRN) of the log set. The RRN is a unique identifier across the Rapid7 Platform.
          type: null
      required:
        - id
        - name
        - description
        - user_data
        - logs_info
        - rrn
    logsets_metrics:
      description: The information on the log sets used in the pre-computed query.
      type: array
      items:
        $ref: '#/components/schemas/logset_info'
    leql_metrics:
      description: The LEQL statement of the pre-computed query.
      type: object
      properties:
        statement:
          description: The 'where' statement of the pre-computed query, for example, `"where(foo>10 AND bar!=0 OR /some_reg[ex]*/)"`.
          type: string
        function:
          description: |
            The 'calculate' statement of the pre-computed query.
            Possible values:
            * `"calculate(count)"`
            * `"calculate(min: <key>)"`
            * `"calculate(max: <key>)"`
            * `"calculate(sum: <key>)"`
            * `"calculate(average: <key>)"`
            * `"calculate(bytes)"`
          type: string
    statistics_metrics_resolution:
      description: The length of each element of the time series, in seconds.
      type: integer
    statistics_metrics_timeseries:
      type: array
      items:
        type: object
        properties:
          time:
            description: The end of the time range that the pre-computed query is applied to. The time is displayed as a UNIX timestamp in milliseconds.
            type: integer
          value:
            description: The pre-computed query value for this slice of the time range.
            type: number
    statistics_metrics_result:
      description: The total of all the values in the timeseries.
      type: number
    statistics_metrics:
      description: Holds the results of the query.
      type: object
      properties:
        type:
          description: |
            The type of calculation performed.
          type: string
          enum:
            - COUNT
            - MIN
            - MAX
            - SUM
            - AVERAGE
            - BYTES
        key:
          description: The key that the calculation was performed on.
          type: string
        resolution:
          $ref: '#/components/schemas/statistics_metrics_resolution'
        timeseries:
          $ref: '#/components/schemas/statistics_metrics_timeseries'
        result:
          $ref: '#/components/schemas/statistics_metrics_result'
    MetricsResponse:
      type: object
      properties:
        id:
          description: The UUID of the pre-computed query.
          type: string
        logs:
          $ref: '#/components/schemas/logs_metrics'
        logsets:
          $ref: '#/components/schemas/logsets_metrics'
        leql:
          $ref: '#/components/schemas/leql_metrics'
        statistics:
          $ref: '#/components/schemas/statistics_metrics'
    name_def:
      type: string
      description: The name of the detection rule.
    description_def:
      type: string
      description: The description of the detection rule.
    tag_source_response:
      type: object
      properties:
        id:
          type: string
          description: The UUID of the log.
        retention_period:
          type: string
          description: The amount of time that the log's entries are stored for.
          $ref: '#/components/schemas/retention_period_enum'
        token:
          type: string
          description: The log token(s) used for writing to the log. This only applies to token type logs (view the `source_type` parameter).
        name:
          type: string
          description: The name of the log.
        stored_days:
          description: The number of days stored.
    sources_array:
      description: The collection of logs the detection rule operates on.
      type: array
      items:
        $ref: '#/components/schemas/tag_source_response'
    period_enum:
      type: string
      default: Hour
      enum:
        - Hour
        - Day
        - Minute
        - 5Minute
        - 10Minute
        - 15Minute
        - 30Minute
    notification_type_enum:
      type: string
      enum:
        - mailto
        - pagerduty
        - webhook
        - slack
        - sqs
    target_params_set_mailto:
      title: mailto
      description: The list of key values that are defined for target type **mailto**.
      type: object
      properties:
        direct:
          type: string
          description: The list of emails to send the notification to. The emails are separated by commas.
      required:
        - direct
    target_params_set_pagerduty:
      description: The list of key values that are defined for the **pagerduty** target type.
      title: pagerduty
      type: object
      properties:
        service_key:
          type: string
          description: The service key of the PagerDuty.
        description:
          type: string
          description: The description of the PagerDuty target.
      required:
        - service_key
    target_params_set_slack:
      description: The list of key values that are defined for target type **slack**.
      title: slack
      type: object
      properties:
        url:
          type: string
          description: The URL to the hook to send the notification to.
      required:
        - url
    target_params_set_webhook:
      description: The list of key values that are defined for target type **webhook***.
      title: webhook
      type: object
      properties:
        url:
          type: string
          description: The URL to the hook to send the notification to.
      required:
        - url
    target_params_set_sqs:
      description: The list of key values that are defined for target type **webhook***.
      title: sqs
      type: object
      properties:
        destination_app:
          type: string
          description: The product code for any license with LOG_SEARCH e.g. OPS, IDR.
        destination_queue:
          type: string
          description: The name for the destination queue e.g. IDR_investigation_queue. This is not the URL.
      required:
        - destination_app
        - destination_queue
    target_params_set_iconworkflow:
      description: InsightConnect Workflow.
      title: insight_connect
      type: object
      properties:
        workflow_id:
          type: string
          description: The ID of the basic detection rule trigger type of workflow in InsightConnect.
      required:
        - workflow_id
    target_user_data:
      description: A list of key-value pairs that may indicate some auxiliary information about the notification target.
      type: object
      properties:
        type: object
    target_alert_content_set:
      type: object
      description: The list of key-value pairs to modify the content of the notification.
      properties:
        le_context:
          type: string
          description: When set to "true", the log context is set to appear in the notification. When set to "false", the log context is set to not appear in the notification.
        le_trigger_event:
          type: array
          description: When set to "true", the log entry which triggered the alert will appear in the notification. When set to "false", the log entry which triggered the alert will not appear in the notification.
    target_response:
      type: object
      properties:
        id:
          type: string
          description: The id of the notification target.
        name:
          type: string
          description: The name of the notification target.
        description:
          type: string
          description: The description of the notification target.
        type:
          type: string
          description: Defines the type of target to send when the notification triggers.
          $ref: '#/components/schemas/notification_type_enum'
        params_set:
          description: The list of key values that are defined depending on the notification target type.
          oneOf:
            - $ref: '#/components/schemas/target_params_set_mailto'
            - $ref: '#/components/schemas/target_params_set_pagerduty'
            - $ref: '#/components/schemas/target_params_set_slack'
            - $ref: '#/components/schemas/target_params_set_webhook'
            - $ref: '#/components/schemas/target_params_set_sqs'
            - $ref: '#/components/schemas/target_params_set_iconworkflow'
        user_data:
          $ref: '#/components/schemas/target_user_data'
        alert_content_set:
          $ref: '#/components/schemas/target_alert_content_set'
      required:
        - id
        - name
        - description
        - type
        - params_set
        - user_data
        - alert_content_set
    action_response:
      type: object
      properties:
        id:
          type: string
          description: The ID of the notification.
        min_matches_count:
          type: integer
          description: The number of log entries that the pattern detection rule needs to match for a notification to be triggered (within a window of time, controlled by the `min_matches_period` parameter).
          default: 0
        min_matches_period:
          type: string
          description: The time window used in combination with the `min_matches_count` parameter to determine if enough log entries have matched a pattern detection rule for an alert notification to be sent. For example, if `min_matches_count=2`, and `min_matches_period="5Minute"`, then this notification will be triggered whenever two log entries match the pattern detection rule within 5 Minutes.
        min_report_count:
          type: integer
          description: The maximum number of notifications that will be triggered within a window of time, controlled by the `min_report_period` parameter.
          default: 1
        min_report_period:
          type: string
          description: The time window used in combination with the `min_report_count` parameter to determine if the notification has triggered the maximum number of times it is allowed to. For example, if `min_report_count=2` and `min_report_period="5 Minute"`, then there will be a maximum of 2 notifications triggered within any 5 minute window.
          $ref: '#/components/schemas/period_enum'
        targets:
          type: array
          description: The list of notification targets for this notification.
          items:
            $ref: '#/components/schemas/target_response'
        enabled:
          type: boolean
          description: |
            \
            When set to true, the notification is enabled. When set to false, the notification is disabled.
        type:
          type: string
          description: Always set to "Alert".
    actions_array:
      description: The notifications attached to the detection rule.
      type: array
      items:
        $ref: '#/components/schemas/action_response'
    patterns_string_array:
      title: patterns
      description: Use the `leql` parameter instead of this parameter.
      type: array
      deprecated: true
      items:
        type: string
    basic_leql:
      title: leql
      description: The [LEQL](https://docs.rapid7.com/insightidr/log-search/#write-a-leql-query) query used by this pattern detection rule to identify matching log entries.
      type: object
      properties:
        statement:
          type: string
          description: The `where()` clause of the [LEQL](https://docs.rapid7.com/insightidr/log-search/#write-a-leql-query) query, for example, `where(foo)`. If empty, the query matches all log entries.
      required:
        - statement
    priority_def:
      type: integer
      description: This ensures investigations are ordered by priority in Investigation Management. Must be >=0
    tag_user_data:
      description: A list of key-value pairs that may indicate some auxiliary information about the change detection rule.
      type: object
    label_response:
      type: object
      properties:
        id:
          type: string
          description: The id of the label.
        sn:
          type: integer
          description: A property which exists for legacy reasons and is no longer used for anything.
        name:
          type: string
          description: The name of the label.
        color:
          type: string
          description: The color of the label in HEX code.
        reserved:
          type: boolean
          description: When set to true, the label is read-only and cannot be modified.
      required:
        - id
        - sn
        - name
        - color
        - reserved
    labels_array:
      description: The labels attached to the detection rule.
      type: array
      items:
        $ref: '#/components/schemas/label_response'
    basic_tag_response:
      title: Pattern Detection
      type: object
      properties:
        type:
          description: Always set to "Alert".
          type: string
        id:
          description: The unique id of the detection rule.
          type: string
        name:
          $ref: '#/components/schemas/name_def'
        description:
          $ref: '#/components/schemas/description_def'
        sources:
          $ref: '#/components/schemas/sources_array'
        actions:
          $ref: '#/components/schemas/actions_array'
        patterns:
          $ref: '#/components/schemas/patterns_string_array'
        leql:
          $ref: '#/components/schemas/basic_leql'
        priority:
          $ref: '#/components/schemas/priority_def'
        user_data:
          $ref: '#/components/schemas/tag_user_data'
        labels:
          $ref: '#/components/schemas/labels_array'
    action_response_inactivity:
      type: object
      properties:
        id:
          type: string
          description: The ID of the notification.
        min_report_count:
          type: integer
          description: The maximum number of notifications that will be triggered within a window of time, controlled by the `min_report_period` parameter.
          default: 1
        min_report_period:
          type: string
          description: The time window used in combination with the `min_report_count` parameter to determine if the notification has triggered the maximum number of times it is allowed to. For example, if `min_report_count=2` and `min_report_period="5 Minute"`, then there will be a maximum of 2 notifications triggered within any 5 minute window.
          $ref: '#/components/schemas/period_enum'
        targets:
          type: array
          description: The list of notification targets for this notification.
          items:
            $ref: '#/components/schemas/target_response'
        enabled:
          type: boolean
          description: |
            \
            When set to true, the notification is enabled. When set to false, the notification is disabled.
        type:
          type: string
          description: Always set to "Alert".
    actions_array_inactivity:
      description: The notifications attached to the detection rule.
      type: array
      items:
        $ref: '#/components/schemas/action_response_inactivity'
    inactivity_leql:
      title: leql
      description: The [LEQL](https://docs.rapid7.com/insightidr/log-search/#write-a-leql-query) query used by this inactivity detection rule to identify matching log entries. Notifications will be triggered when no matches have been identified for the amount of time configured for this detection rule.
      type: object
      properties:
        statement:
          type: string
          description: The `where()` clause of the [LEQL](https://docs.rapid7.com/insightidr/log-search/#write-a-leql-query) query, for example, `where(foo)`. If empty, the detection rule matches all log entries.
      required:
        - statement
    timeframe_value:
      description: Defines the duration of inactivity before an alert triggers along with the `timeframe_period` parameter.
      type: integer
    timeframe_period:
      description: |
        Defines the unit of time to use along with the `timeframe_value` parameter.
      type: string
      enum:
        - Week
        - Day
        - Hour
        - Minute
    tag_inactivity_alert_response:
      title: Inactivity Detection
      type: object
      properties:
        type:
          description: Always set to "AlertNotify".
          type: string
        id:
          description: The unique ID of the detection rule.
          type: string
        name:
          $ref: '#/components/schemas/name_def'
        description:
          $ref: '#/components/schemas/description_def'
        sources:
          $ref: '#/components/schemas/sources_array'
        actions:
          $ref: '#/components/schemas/actions_array_inactivity'
        patterns:
          $ref: '#/components/schemas/patterns_string_array'
        leql:
          $ref: '#/components/schemas/inactivity_leql'
        user_data:
          $ref: '#/components/schemas/tag_user_data'
        timeframe_value:
          $ref: '#/components/schemas/timeframe_value'
        timeframe_period:
          $ref: '#/components/schemas/timeframe_period'
        priority:
          $ref: '#/components/schemas/priority_def'
        sub_type:
          description: Always set to "InactivityAlert".
          type: string
    action_response_anomaly:
      type: object
      properties:
        id:
          type: string
          description: The ID of the notification.
        min_report_count:
          type: integer
          description: The maximum number of notifications that will be triggered within a window of time, controlled by the `min_report_period` parameter.
          default: 1
        min_report_period:
          type: string
          description: The time window used in combination with the `min_report_count` parameter to determine if the notification has triggered the maximum number of times it is allowed to. For example, if `min_report_count=2` and `min_report_period="5 Minute"`, then there will be a maximum of 2 notifications triggered within any 5 minute window.
          $ref: '#/components/schemas/period_enum'
        targets:
          type: array
          description: The list of notification targets for this notification.
          items:
            $ref: '#/components/schemas/target_response'
        enabled:
          type: boolean
          description: |
            \
            When set to true, the notification is enabled. When set to false, the notification is disabled.
        type:
          type: string
          description: Always set to "Alert".
    actions_array_anomaly:
      description: The notifications attached to the detection rule.
      type: array
      items:
        $ref: '#/components/schemas/action_response_anomaly'
    scheduled_query_id:
      description: ID of the scheduled query associated with this change detection rule.
      type: string
    function_def:
      type: object
      properties:
        calculate:
          type: string
    anomaly_leql:
      title: leql
      description: The [LEQL](https://docs.rapid7.com/insightidr/log-search/#write-a-leql-query) query used by this change detection rule to compute results.
      type: object
      properties:
        statement:
          type: string
          description: The `where()` clause of the [LEQL](https://docs.rapid7.com/insightidr/log-search/#write-a-leql-query) query, for example, `where(foo)`. If empty, the query matches all log entries.
        function:
          description: The function applied to matching log entries, which returns a numeric result, for example, `count:my_key`.
          $ref: '#/components/schemas/function_def'
      required:
        - function
    scheduled_query_response:
      description: The configurations for the two queries that are executed at regular 10-minute intervals. Notifications will be triggered when there is a large enough difference between the two (defined by the `threshold_value` parameter).
      type: object
      properties:
        id:
          $ref: '#/components/schemas/scheduled_query_id'
        name:
          description: The name of the scheduled query.
          type: string
        leql:
          $ref: '#/components/schemas/anomaly_leql'
        time_value:
          description: |
            Defines the timerange for the two queries, along with the `time_period` parameter. 
            Two queries will be run: the timerange of the first, more recent query, will end at the current system time; 
            the timerange of the older query will end at the current system time minus the time specified by the `timeframe_value` & `timeframe_period` parameters.
          type: integer
        time_period:
          description: Defines the timerange for the two queries, along with the `time_value` parameter.
          type: string
          enum:
            - Week
            - Day
            - Hour
            - Minute
        timeframe_value:
          description: Defines the "offset" for the older of the two queries along with the `timeframe_period` parameter. For example, if the `timeframe_value` is set to 1 and `timeframe_period` is set to `Week`, then the time range for the older of the two queries will end at the current system time minus 1 week.
          type: integer
        timeframe_period:
          description: Defines the "offset" for the older of the two queries, along with the `timeframe_value` parameter.
          type: string
          enum:
            - Week
            - Day
            - Hour
            - Minute
      required:
        - id
    threshold_value:
      description: The percentage that defines when to trigger notifications. The percentage can be positive or negative. For example, if the percentage is set to -50, then notifications will be triggered when the query result for the time range defined by the `time_value` and `time_period` parameters is 50% smaller when compared to the same query over the time range defined by the `timeframe_value` and `timeframe_period` parameters.
      type: integer
    tag_anomaly_alert_response:
      title: Change Detection
      type: object
      properties:
        type:
          description: Always set to "AlertNotify".
          type: string
        id:
          description: The unique ID of the detection rule.
          type: string
        name:
          $ref: '#/components/schemas/name_def'
        description:
          $ref: '#/components/schemas/description_def'
        sources:
          $ref: '#/components/schemas/sources_array'
        actions:
          $ref: '#/components/schemas/actions_array_anomaly'
        patterns:
          $ref: '#/components/schemas/patterns_string_array'
        user_data:
          $ref: '#/components/schemas/tag_user_data'
        scheduled_query_id:
          $ref: '#/components/schemas/scheduled_query_id'
        sub_type:
          description: Always set to "AnomalyAlert".
          type: string
        scheduled_query:
          $ref: '#/components/schemas/scheduled_query_response'
        threshold_value:
          $ref: '#/components/schemas/threshold_value'
        priority:
          $ref: '#/components/schemas/priority_def'
    sources_id_array:
      description: The IDs of the logs that the detection rule operates on.
      type: array
      items:
        type: object
        properties:
          id:
            description: The UUID of the log.
            type: string
    create_tag_target:
      type: object
      properties:
        alert_content_set:
          $ref: '#/components/schemas/target_alert_content_set'
        params_set:
          description: The list of key values that are defined depending on the notification target type.
          oneOf:
            - $ref: '#/components/schemas/target_params_set_mailto'
            - $ref: '#/components/schemas/target_params_set_pagerduty'
            - $ref: '#/components/schemas/target_params_set_slack'
            - $ref: '#/components/schemas/target_params_set_webhook'
            - $ref: '#/components/schemas/target_params_set_sqs'
            - $ref: '#/components/schemas/target_params_set_iconworkflow'
        type:
          type: string
          description: Defines the type of target to send when the notification triggers.
          $ref: '#/components/schemas/notification_type_enum'
      required:
        - type
        - params_set
    create_tag_action:
      type: object
      properties:
        enabled:
          type: boolean
          description: |
            \
            When set to true, the notification is enabled. When set to false, the notification is disabled.
        min_matches_count:
          type: integer
          description: The number of log entries that the pattern detection rule needs to match for a notification to be triggered (within a window of time, controlled by the `min_matches_period` parameter).
          default: 0
        min_matches_period:
          type: string
          description: The time window used in combination with the `min_matches_count` parameter to determine if enough log entries have matched a pattern detection rule for an alert notification to be sent. For example, if `min_matches_count=2`, and `min_matches_period="5Minute"`, then this notification will be triggered whenever two log entries match the pattern detection rule within 5 minutes.
        min_report_count:
          type: integer
          description: The maximum number of notifications that will be triggered within a window of time, controlled by the `min_report_period` parameter.
          default: 1
        min_report_period:
          type: string
          description: The time window used in combination with the `min_report_count` parameter to determine if the notification has triggered the maximum number of times it is allowed to. For example, if `min_report_count=2` and `min_report_period="5 Minute"`, then there will be a maximum of 2 notifications triggered within any 5-minute window.
          $ref: '#/components/schemas/period_enum'
        targets:
          type: array
          description: The list of notification targets for this notification.
          items:
            $ref: '#/components/schemas/create_tag_target'
        type:
          type: string
          description: Always set to "Alert".
      required:
        - enabled
        - min_matches_count
        - min_matches_period
        - min_report_count
        - min_report_period
        - targets
    create_actions_array:
      description: The notifications attached to the detection rule.
      type: array
      items:
        $ref: '#/components/schemas/create_tag_action'
    create_basic_tag:
      title: Pattern Detection
      type: object
      properties:
        tag:
          type: object
          properties:
            name:
              $ref: '#/components/schemas/name_def'
            patterns:
              $ref: '#/components/schemas/patterns_string_array'
            sources:
              $ref: '#/components/schemas/sources_id_array'
            type:
              type: string
              description: Always set to "Alert".
            description:
              $ref: '#/components/schemas/description_def'
            actions:
              $ref: '#/components/schemas/create_actions_array'
            labels:
              $ref: '#/components/schemas/labels_array'
            user_data:
              $ref: '#/components/schemas/tag_user_data'
            leql:
              $ref: '#/components/schemas/basic_leql'
            priority:
              $ref: '#/components/schemas/priority_def'
          required:
            - name
            - sources
            - leql
    create_tag_action_inactivity:
      type: object
      properties:
        enabled:
          type: boolean
          description: |
            \
            When set to true, the notification is enabled. When set to false, the notification is disabled.
        min_report_count:
          type: integer
          description: The maximum number of notifications that will be triggered within a window of time, controlled by the `min_report_period` parameter.
          default: 1
        min_report_period:
          type: string
          description: The time window used in combination with the `min_report_count` parameter to determine if the notification has triggered the maximum number of times it is allowed to. For example, if `min_report_count=2` and `min_report_period="5 Minute"`, then there will be a maximum of 2 notifications triggered within any 5-minute window.
          $ref: '#/components/schemas/period_enum'
        targets:
          type: array
          description: The list of notification targets for this notification.
          items:
            $ref: '#/components/schemas/create_tag_target'
        type:
          type: string
          description: Always set to "Alert".
      required:
        - enabled
        - min_matches_count
        - min_matches_period
        - min_report_count
        - min_report_period
        - targets
    create_actions_array_inactivity:
      description: The notifications attached to the detection rule.
      type: array
      items:
        $ref: '#/components/schemas/create_tag_action_inactivity'
    create_or_put_tag_inactivity_alert:
      title: Inactivity Detection
      type: object
      properties:
        tag:
          type: object
          properties:
            name:
              $ref: '#/components/schemas/name_def'
            patterns:
              $ref: '#/components/schemas/patterns_string_array'
            sources:
              $ref: '#/components/schemas/sources_id_array'
            type:
              description: The Always set to "AlertNotify".
              type: string
            sub_type:
              description: Always set to "InactivityAlert".
              type: string
            description:
              $ref: '#/components/schemas/description_def'
            actions:
              $ref: '#/components/schemas/create_actions_array_inactivity'
            user_data:
              $ref: '#/components/schemas/tag_user_data'
            timeframe_value:
              $ref: '#/components/schemas/timeframe_value'
            timeframe_period:
              $ref: '#/components/schemas/timeframe_period'
            leql:
              $ref: '#/components/schemas/inactivity_leql'
            priority:
              $ref: '#/components/schemas/priority_def'
          required:
            - type
            - name
            - sources
            - sub_type
            - leql
    create_tag_action_anomaly:
      type: object
      properties:
        enabled:
          type: boolean
          description: |
            \
            When set to true, the notification is enabled. When set to false, the notification is disabled.
        min_report_count:
          type: integer
          description: The maximum number of notifications that will be triggered within a window of time, controlled by the `min_report_period` parameter.
          default: 1
        min_report_period:
          type: string
          description: The time window used in combination with the `min_report_count` parameter to determine if the notification has triggered the maximum number of times it is allowed to. For example, if `min_report_count=2` and `min_report_period="5 Minute"`, then there will be a maximum of 2 notifications triggered within any 5-minute window.
          $ref: '#/components/schemas/period_enum'
        targets:
          type: array
          description: The list of notification targets for this notification.
          items:
            $ref: '#/components/schemas/create_tag_target'
        type:
          type: string
          description: Always set to "Alert".
      required:
        - enabled
        - min_matches_count
        - min_matches_period
        - min_report_count
        - min_report_period
        - targets
    create_actions_array_anomaly:
      description: The notifications attached to the detection rule.
      type: array
      items:
        $ref: '#/components/schemas/create_tag_action_anomaly'
    create_scheduled_query:
      description: The configurations for the two queries that are executed at regular 10-minute intervals. Notifications will be triggered when there is a large enough difference between the two (defined by the `threshold_value` parameter).
      type: object
      properties:
        name:
          type: string
          description: The name of the scheduled query.
        leql:
          $ref: '#/components/schemas/anomaly_leql'
        time_value:
          description: |
            Defines the time range for the two queries, along with the `time_period` parameter.
            Two queries will run: the time range of the first, more recent query, will end at the current system time;
            the time range of the older query will end at the current system time minus the time specified by the `timeframe_value` and `timeframe_period` parameters.
          type: integer
        time_period:
          description: Defines the time range for the two queries, along with the `time_value` parameter.
          type: string
          enum:
            - Week
            - Day
            - Hour
            - Minute
        timeframe_value:
          description: Defines the "offset" for the older of the two queries along with the `timeframe_period` parameter. For example, if the `timeframe_value` is set to 1 and `timeframe_period` is set to `Week`, then the time range for the older of the two queries will end at the current system time minus 1 week.
          type: integer
        timeframe_period:
          description: Defines the "offset" for the older of the two queries, along with the `timeframe_value` parameter.
          type: string
          enum:
            - Week
            - Day
            - Hour
            - Minute
      required:
        - name
        - leql
        - timeframe_value
        - timeframe_period
        - time_value
        - time_period
    create_tag_anomaly_alert:
      title: Change Detection
      type: object
      properties:
        tag:
          type: object
          properties:
            name:
              $ref: '#/components/schemas/name_def'
            sources:
              $ref: '#/components/schemas/sources_id_array'
            type:
              description: Always set to "AlertNotify".
              type: string
            sub_type:
              description: Always set to "AnomalyAlert".
              type: string
            description:
              $ref: '#/components/schemas/description_def'
            actions:
              $ref: '#/components/schemas/create_actions_array_anomaly'
            user_data:
              $ref: '#/components/schemas/tag_user_data'
            scheduled_query:
              $ref: '#/components/schemas/create_scheduled_query'
            threshold_value:
              $ref: '#/components/schemas/threshold_value'
            priority:
              $ref: '#/components/schemas/priority_def'
          required:
            - name
            - sources
            - type
            - sub_type
            - scheduled_query
            - threshold_value
    put_basic_tag:
      title: Pattern Detection
      type: object
      properties:
        tag:
          type: object
          properties:
            name:
              $ref: '#/components/schemas/name_def'
            patterns:
              $ref: '#/components/schemas/patterns_string_array'
            leql:
              $ref: '#/components/schemas/basic_leql'
            sources:
              $ref: '#/components/schemas/sources_id_array'
            type:
              type: string
              description: Always set to "Alert".
            description:
              $ref: '#/components/schemas/description_def'
            actions:
              $ref: '#/components/schemas/create_actions_array'
            labels:
              $ref: '#/components/schemas/labels_array'
            user_data:
              $ref: '#/components/schemas/tag_user_data'
            priority:
              $ref: '#/components/schemas/priority_def'
          required:
            - name
            - sources
            - leql
    put_tag_anomaly_alert:
      title: Change Detection
      type: object
      properties:
        tag:
          type: object
          properties:
            name:
              $ref: '#/components/schemas/name_def'
            sources:
              $ref: '#/components/schemas/sources_id_array'
            type:
              description: Always set to "AlertNotify".
              type: string
            sub_type:
              description: Always set to "AnomalyAlert".
              type: string
            description:
              $ref: '#/components/schemas/description_def'
            actions:
              $ref: '#/components/schemas/create_actions_array_anomaly'
            user_data:
              $ref: '#/components/schemas/tag_user_data'
            scheduled_query_id:
              $ref: '#/components/schemas/scheduled_query_id'
            scheduled_query:
              $ref: '#/components/schemas/scheduled_query_response'
            threshold_value:
              $ref: '#/components/schemas/threshold_value'
            priority:
              $ref: '#/components/schemas/priority_def'
          required:
            - name
            - sources
            - type
            - sub_type
            - scheduled_query
            - threshold_value
    patch_basic_tag:
      title: Pattern Detection
      type: object
      properties:
        tag:
          type: object
          properties:
            name:
              $ref: '#/components/schemas/name_def'
            patterns:
              $ref: '#/components/schemas/patterns_string_array'
            leql:
              $ref: '#/components/schemas/basic_leql'
            sources:
              $ref: '#/components/schemas/sources_id_array'
            type:
              type: string
              description: Always set to "Alert".
            description:
              $ref: '#/components/schemas/description_def'
            actions:
              $ref: '#/components/schemas/create_actions_array'
            labels:
              $ref: '#/components/schemas/labels_array'
            user_data:
              $ref: '#/components/schemas/tag_user_data'
            priority:
              $ref: '#/components/schemas/priority_def'
    patch_tag_with_inactivity_alert:
      title: Inactivity Detection
      type: object
      properties:
        tag:
          type: object
          properties:
            name:
              $ref: '#/components/schemas/name_def'
            patterns:
              $ref: '#/components/schemas/patterns_string_array'
            leql:
              $ref: '#/components/schemas/inactivity_leql'
            sources:
              $ref: '#/components/schemas/sources_id_array'
            type:
              description: Always set to "AlertNotify".
              type: string
            sub_type:
              description: Always set to "InactivityAlert".
              type: string
            description:
              $ref: '#/components/schemas/description_def'
            actions:
              $ref: '#/components/schemas/create_actions_array_inactivity'
            user_data:
              $ref: '#/components/schemas/tag_user_data'
            timeframe_value:
              $ref: '#/components/schemas/timeframe_value'
            timeframe_period:
              $ref: '#/components/schemas/timeframe_period'
            priority:
              $ref: '#/components/schemas/priority_def'
          required:
            - type
    patch_tag_with_anomaly_alert:
      title: Change Detection
      type: object
      properties:
        tag:
          type: object
          properties:
            name:
              $ref: '#/components/schemas/name_def'
            sources:
              $ref: '#/components/schemas/sources_id_array'
            type:
              description: Always set to "AlertNotify".
              type: string
            sub_type:
              description: Always set to "AnomalyAlert".
              type: string
            description:
              $ref: '#/components/schemas/description_def'
            actions:
              $ref: '#/components/schemas/create_actions_array_anomaly'
            user_data:
              $ref: '#/components/schemas/tag_user_data'
            scheduled_query:
              $ref: '#/components/schemas/create_scheduled_query'
            threshold_value:
              $ref: '#/components/schemas/threshold_value'
            priority:
              $ref: '#/components/schemas/priority_def'
          required:
            - type
    alert_notification_setting:
      description: A notification that may be attached to a basic detection rule.
      type: object
      properties:
        id:
          type: string
          description: The ID of the notification.
        min_matches_count:
          type: integer
          description: The number of log entries that the pattern detection rule needs to match for a notification to be triggered (within a window of time, controlled by the `min_matches_period` parameter). Only for pattern detection rules. This parameter is ignored when used with change detection rules or inactivity detection rules.
          default: 0
        min_matches_period:
          type: string
          description: The time window used in combination with the `min_matches_count` parameter to determine if enough log entries have matched a pattern detection rule for an alert notification to be sent. For example, if `min_matches_count=2`, and `min_matches_period="5Minute"`, then this notification will be triggered whenever two log entries match the pattern detection rule within 5 minutes. Only for pattern detection rules. This parameter is ignored when used with change detection rules or inactivity detection rules.
        min_report_count:
          type: integer
          description: The maximum number of notifications that will be triggered within a window of time, controlled by the `min_report_period` parameter.
          default: 1
        min_report_period:
          type: string
          description: The time window used in combination with the `min_report_count` parameter to determine if the notification has triggered the maximum number of times it is allowed to. For example, if `min_report_count=2` and `min_report_period="5 Minute"`, then there will be a maximum of 2 notifications triggered within any 5 minute window.
          $ref: '#/components/schemas/period_enum'
        targets:
          type: array
          description: The list of targets for the action.
          items:
            $ref: '#/components/schemas/target_response'
        enabled:
          type: boolean
          description: |
            \
            When set to true, the action is enabled. When set to false, the action is disabled.
        type:
          type: string
          description: Always set to "Alert".
    alert_notification_setting_request:
      description: A notification that may be attached to a basic detection rule.
      type: object
      properties:
        min_matches_count:
          type: integer
          description: The number of log entries that the pattern detection rule needs to match for a notification to be triggered (within a window of time, controlled by the `min_matches_period` parameter). Only for pattern detection rules. This parameter is ignored when used with change detection rules or inactivity detection rules.
          default: 0
        min_matches_period:
          type: string
          description: The time window used in combination with the `min_matches_count` parameter to determine if enough log entries have matched a pattern detection rule for an alert notification to be sent. For example, if `min_matches_count=2`, and `min_matches_period="5Minute"`, then this notification will be triggered whenever two log entries match the pattern detection rule within 5 minutes. Only for pattern detection rules. This parameter is ignored when used with change detection rules or inactivity detection rules.
        min_report_count:
          type: integer
          description: The maximum number of notifications that will be triggered within a window of time, controlled by the `min_report_period` parameter.
          default: 1
        min_report_period:
          type: string
          description: The time window used in combination with the `min_report_count` parameter to determine if the notification has triggered the maximum number of times it is allowed to. For example, if `min_report_count=2` and `min_report_period="5 Minute"`, then there will be a maximum of 2 notifications triggered within any 5 minute window.
          $ref: '#/components/schemas/period_enum'
        targets:
          type: array
          description: The list of targets for the action.
          items:
            $ref: '#/components/schemas/target_response'
        enabled:
          type: boolean
          description: |
            \
            When set to true, the action is enabled. When set to false, the action is disabled.
        type:
          type: string
          description: Always set to "Alert".
      required:
        - min_matches_count
        - min_report_count
        - min_matches_period
        - min_report_period
        - targets
        - enabled
        - type
    get_target_action:
      title: target
      type: object
      properties:
        name:
          type: string
          description: The name of the notification target.
        description:
          type: string
          description: The description of the notifiaction target.
        type:
          type: string
          description: This defines the type of target to send when the notification triggers.
          $ref: '#/components/schemas/notification_type_enum'
        params_set:
          description: The list of key values that are defined depending on the notification target type.
          oneOf:
            - $ref: '#/components/schemas/target_params_set_mailto'
            - $ref: '#/components/schemas/target_params_set_pagerduty'
            - $ref: '#/components/schemas/target_params_set_slack'
            - $ref: '#/components/schemas/target_params_set_webhook'
            - $ref: '#/components/schemas/target_params_set_sqs'
            - $ref: '#/components/schemas/target_params_set_iconworkflow'
        alert_content_set:
          $ref: '#/components/schemas/target_alert_content_set'
        user_data:
          $ref: '#/components/schemas/target_user_data'
    create_patch_target:
      title: target
      type: object
      properties:
        name:
          type: string
          description: The name of the notification target.
        description:
          type: string
          description: The description of the notification target.
        type:
          type: string
          description: This defines the type of target to send when the notification triggers.
          $ref: '#/components/schemas/notification_type_enum'
        params_set:
          description: The list of key values that are defined depending on the target type.
          oneOf:
            - $ref: '#/components/schemas/target_params_set_mailto'
            - $ref: '#/components/schemas/target_params_set_pagerduty'
            - $ref: '#/components/schemas/target_params_set_slack'
            - $ref: '#/components/schemas/target_params_set_webhook'
            - $ref: '#/components/schemas/target_params_set_sqs'
            - $ref: '#/components/schemas/target_params_set_iconworkflow'
        alert_content_set:
          $ref: '#/components/schemas/target_alert_content_set'
        user_data:
          $ref: '#/components/schemas/target_user_data'
      required:
        - name
        - description
        - type
        - params_set
        - alert_content_set
        - user_data
    create_put_target:
      title: target
      type: object
      properties:
        target:
          description: |
            This creates a target.
          type: object
          properties:
            name:
              type: string
              description: The name of the target.
            description:
              type: string
              description: The description of the target.
            type:
              type: string
              description: This defines the type of target to send when the notification triggers.
              $ref: '#/components/schemas/notification_type_enum'
            params_set:
              description: The list of key values that are defined depending on the target type.
              oneOf:
                - $ref: '#/components/schemas/target_params_set_mailto'
                - $ref: '#/components/schemas/target_params_set_pagerduty'
                - $ref: '#/components/schemas/target_params_set_slack'
                - $ref: '#/components/schemas/target_params_set_webhook'
                - $ref: '#/components/schemas/target_params_set_sqs'
                - $ref: '#/components/schemas/target_params_set_iconworkflow'
            alert_content_set:
              $ref: '#/components/schemas/target_alert_content_set'
            user_data:
              $ref: '#/components/schemas/target_user_data'
          required:
            - name
            - type
            - params_set
            - alert_content_set
            - user_data
    logs_response:
      type: object
      properties:
        logs:
          type: array
          items:
            $ref: '#/components/schemas/log_info_response'
      required:
        - logs
    create_or_put_log:
      type: object
      properties:
        log:
          type: object
          properties:
            name:
              description: The name of the log.
            tokens:
              description: The log token(s) used for writing to the log. This only applies to token type logs (view the `source_type` parameter).
              type: array
              items:
                type: string
            structures:
              description: |
                Structures are internal entities which may apply some additional processing to log entries written to this this log.
              type: array
              items:
                type: string
            ip_address:
              description: The IP address that the Log Search system receives log entries from. This only applies to syslog type logs (view the `source_type` parameter).
              type: string
            logsets_info:
              description: |
                The information on each log set that this log is part of.
              type: array
              items:
                type: object
                properties:
                  id:
                    description: The UUID of the log set.
                    type: string
                  name:
                    description: The name of the log set.
                    type: string
                required:
                  - id
                  - name
            user_data:
              type: object
              description: A list of key-value pairs that may indicate some auxiliary information about the log.
            source_type:
              description: |
                A categorization of logs that defines how log entries are received by servers.
                * `syslog` type logs are associated with an IP address and a port (the values appear in the `user_data` field). Any log entries received by the server on that port and from that IP address will belong to that log.
                * `token` type logs are associated with a log token. Any log entries received by the server on one of the [standard ports](https://docs.rapid7.com/insightops/token-tcp) containing that log token will belong to that log (with the log token removed from the log entry).
                * `internal` type logs use internal mechanisms to receive log entries, for example any of the logs in the Internal Logs log set.
              type: string
              enum:
                - syslog
                - token
                - internal
              default: token
            token_seed:
              type: string
              description: The seed used to generate the log token (for token type logs).
          required:
            - name
      required:
        - log
    log_response:
      type: object
      properties:
        id:
          description: The UUID of the log.
          type: string
        name:
          description: The name of the log.
        tokens:
          description: The log token(s) used for writing to the log. This only applies to token type logs (view `source_type` parameter).
          type: array
          items:
            type: string
        structures:
          description: |
            Structures are internal entities which may apply some additional processing to log entries written to this this log.
          type: array
          items:
            type: string
        ip_address:
          description: |
            The IP address that the Log Search system receives log entries from. This only applies to syslog type logs (view the `source_type` parameter).
          type: string
        logsets_info:
          $ref: '#/components/schemas/member_info'
        user_data:
          description: A list of key-values pairs that may indicate some auxiliary information about the log.
          type: object
          additionalProperties:
            x-additionalPropertiesName: <key>
            type: string
        source_type:
          description: |
            A categorization of logs which defines how log entries are received by a server.
            * Syslog type logs are associated with an IP address and a port (the values appear in the `user_data` field). Any log entries received by the server on that port and from that IP address will belong to that log.
            * Token type logs are associated with a log token. Any log entries received by the server on one of the [standard ports](https://docs.rapid7.com/insightops/token-tcp) containing that log token will belong to that log (with the log token removed from the log entry).
            * Internal type logs use internal mechanisms to receive log entries, for example any of the logs in the Internal Logs log set.
          type: string
          enum:
            - syslog
            - token
            - internal
          default: token
        rrn:
          description: The Rapid7 Resource Name (RRN) of the log. The RRN is a unique identifier across the Rapid7 Platform.
          type: string
        token_seed:
          description: The seed used to generate the log token if the log's `source_type` is `token`.
        retention_period:
          description: The amount of time the log's entries are stored for.
          type: string
          $ref: '#/components/schemas/retention_period_enum'
        links:
          $ref: '#/components/schemas/links'
      required:
        - id
        - name
        - tokens
        - structures
        - logsets_info
        - user_data
        - source_type
        - rrn
        - token_seed
        - retention_period
        - links
    log_topkeys_response:
      type: object
      properties:
        topkeys:
          description: The list of commonly occurring keys for this log.
          type: array
          items:
            type: object
            properties:
              key:
                description: The key.
                type: string
              weight:
                description: The weight to denote the popularity of this key.
                type: number
            required:
              - key
              - weight
      required:
        - topkeys
    logset_response:
      title: log set
      type: object
      properties:
        logsets:
          description: |
            A list of the log sets.
          type: array
          items:
            $ref: '#/components/schemas/logset_info'
    create_logset:
      title: logset
      type: object
      properties:
        logset:
          description: The log set.
          type: object
          properties:
            id:
              description: The UUID of the log set.
              type: string
            name:
              description: The name of the log set.
            description:
              type: string
              description: The description of the log set.
            user_data:
              description: A list of key-value pairs that may indicate some auxiliary information about the log set.
              type: object
            logs_info:
              $ref: '#/components/schemas/member_info_logset'
            token_seed:
              type: string
              description: The string that will be used in combination with the log set name to generate the log set ID.
            rrn:
              description: The Rapid7 Resource Name (RRN) of the log set. The RRN is a unique identifier across the Rapid7 Platform.
              type: null
          required:
            - name
    leql_metrics_endpoints:
      description: The LEQL statement of the pre-computed query.
      type: object
      properties:
        statement:
          description: The 'where' statement of the pre-computed query, for example, `"where(foo>10 AND bar!=0 OR /some_reg[ex]*/)"`.
          type: string
        function:
          description: |
            The 'calculate' statement of the pre-computed query.
            Possible values:
            * `"calculate(count)"`
            * `"calculate(min: <key>)"`
            * `"calculate(max: <key>)"`
            * `"calculate(sum: <key>)"`
            * `"calculate(average: <key>)"`
            * `"calculate(bytes)"`
          type: string
    MetricsResponseSingle:
      type: object
      properties:
        metric:
          type: object
          properties:
            id:
              description: The UUID of the pre-computed query.
              type: string
            name:
              description: The name of the pre-computed query.
              type: String
            description:
              description: The description of the pre-computed query.
              type: String
            enabled:
              description: This indicates whether the pre-computed query is enabled or not.
            logs:
              $ref: '#/components/schemas/logs_metrics'
            logsets:
              $ref: '#/components/schemas/logsets_metrics'
            leql:
              $ref: '#/components/schemas/leql_metrics_endpoints'
            resolution_secs:
              type: integer
              description: The time window in seconds, that each PCQ datapoint corresponds to.
            retention_secs:
              type: integer
              description: The length of time in seconds, that the PCQ will be stored for.
            enabled_since:
              type: string
              description: The time the PCQ was enabled.
            created:
              type: string
              description: The time the PCQ was created.
    MetricsResponseList:
      type: object
      properties:
        metrics:
          type: array
          items:
            $ref: '#/components/schemas/MetricsResponseSingle'
    MetricsInput:
      title: Using Log ID(s)
      type: object
      properties:
        metric:
          type: object
          properties:
            name:
              description: The name of the pre-computed query.
              type: String
            description:
              description: The description of the pre-computed query.
              type: String
            enabled:
              description: This indicates whether the pre-computed query is enabled or not.
            logs:
              description: The logs to use in the pre-computed query.
              type: object
              properties:
                id:
                  description: The UUID of the logs.
                  type: String
            leql:
              $ref: '#/components/schemas/leql_metrics'
            resolution:
              type: integer
              description: The time window in seconds, that each PCQ datapoint corresponds to.
            retention:
              type: integer
              description: The length of time in seconds, that the PCQ will be stored for.
    MetricsInputLogsetsById:
      title: Using Log Set ID(s)
      type: object
      properties:
        metric:
          type: object
          properties:
            name:
              description: The name of the pre-computed query.
              type: String
            description:
              description: The description of the pre-computed query.
              type: String
            enabled:
              description: This indicates whether the pre-computed query is enabled or not.
            logsets:
              description: The log sets to use in the pre-computed query.
              type: object
              properties:
                id:
                  description: The UUID of the log set.
                  type: String
            leql:
              $ref: '#/components/schemas/leql_metrics_endpoints'
            resolution:
              type: integer
              description: The time window in seconds, that each PCQ datapoint corresponds to.
            retention:
              type: integer
              description: The length of time in seconds, that the PCQ will be stored for.
    MetricsInputLogsetsByName:
      title: Using Log Set Name(s)
      type: object
      properties:
        metric:
          type: object
          properties:
            name:
              description: The name of the pre-computed query.
              type: String
            description:
              description: The description of the pre-computed query.
              type: String
            enabled:
              description: This indicates whether the pre-computed query is enabled or not.
            logsets:
              description: The log sets to use in the pre-computed query.
              type: object
              properties:
                name:
                  description: The name of the log set.
                  type: String
            leql:
              $ref: '#/components/schemas/leql_metrics'
            resolution:
              type: integer
              description: The time window in seconds, that each PCQ datapoint corresponds to.
            retention:
              type: integer
              description: The length of time in seconds, that the PCQ will be stored for.
    s3_archiving_setup:
      type: object
      properties:
        s3setup:
          type: object
          properties:
            id:
              description: The unique id of the S3 Archiving Setup.
              type: string
            bucket_name:
              description: The name of the AWS S3 Bucket.
              type: string
            enabled:
              description: Boolean indicating whether the S3 setup is enabled.
              type: boolean
            compression:
              description: The type of compression used for archiving. This is either "GZIP" or "BZIP2".
              type: string
          required:
            - id
            - bucket_name
            - enabled
            - compression
    create_s3_archiving_setup:
      type: object
      properties:
        s3setup:
          type: object
          properties:
            bucket_name:
              description: The name of the S3 Bucket.
              type: string
            enabled:
              description: Boolean indicating whether the S3 setup is enabled.
              type: boolean
            compression:
              description: The type of compression used for archiving. This is either "GZIP" or "BZIP2".
              type: string
          required:
            - bucket_name
            - enabled
            - compression
    patch_s3_archiving_setup:
      type: object
      properties:
        s3setup:
          type: object
          properties:
            bucket_name:
              description: The name of the S3 Bucket.
              type: string
            enabled:
              description: Boolean indicating whether the S3 setup is enabled.
              type: boolean
            compression:
              description: The type of compression used for archiving. This is either "GZIP" or "BZIP2".
              type: string
    accounts_usage_response:
      type: object
      properties:
        daily_usage:
          description: The total number of bytes written to every log each day.
          properties:
            usage:
              description: The number of bytes.
              type: int
            day:
              description: The date in the format "YYYY-MM-DD".
              type: string
        period_usage:
          description: The total number of bytes written to every log, for the entire time range.
          type: int
        period:
          description: The time range.
          properties:
            from:
              description: The start date of the time range in the format "YYYY-MM-DD".
              type: string
            to:
              description: The end date of the time range in the format "YYYY-MM-DD".
              type: string
        id:
          description: The account resource ID (UUID). A unique identifier for your organization.
          type: string
        name:
          description: The name of your organization.
          type: string
    logs_usage_response:
      type: object
      properties:
        per_day_usage:
          description: The total number of bytes written to each log each day.
          type: object
          properties:
            period:
              description: The time range.
              properties:
                from:
                  description: The start date of the time range in the format "YYYY-MM-DD".
                  type: string
                to:
                  description: The end date of the time range in the format "YYYY-MM-DD".
                  type: string
            report_interval:
              description: Always set to "day"
              type: string
            usage_units:
              description: Always set to "bytes".
              type: string
            usage:
              description: The total number of bytes written to each log each day.
              type: array
              items:
                properties:
                  interval:
                    description: The date in the format "YYYY-MM-DD".
                    type: string
                  log_usage:
                    description: The total number of bytes written to each log.
                    type: array
                    items:
                      properties:
                        id:
                          description: The ID of the log (UUID).
                          type: string
                        usage:
                          description: The total number of bytes written to the log.
                          type: int
    log_usage_response:
      type: object
      properties:
        usage:
          description: The total number of bytes written to the log each day.
          type: object
          properties:
            id:
              description: The ID of the log (UUID).
              type: string
            period:
              description: The time range.
              properties:
                from:
                  description: The start date of the time range in the format "YYYY-MM-DD".
                  type: string
                to:
                  description: The end date of the time range in the format "YYYY-MM-DD".
                  type: string
            daily_usage:
              description: The total number of bytes written to each log each day.
              properties:
                usage:
                  description: The total number of bytes written to the log.
                  type: ints
                day:
                  description: The date in the format "YYYY-MM-DD".
                  type: string
    export_job:
      type: object
      properties:
        id:
          description: The UUID of the job.
          type: string
        created:
          description: The Unix timestamp of when the job was created in milliseconds.
          type: integer
        format:
          description: The export format. This can only be 'csv'.
          type: string
          enum:
            - csv
        percentage:
          description: The percentage progress of the export job.
          type: integer
        status:
          description: |
            The status of the export job.
              * `Started`: The job has been accepted and registered.
              * `Retrieving`: The query is being executed and the events are being retrieved and streamed to disk.
              * `Converting`: The events are being run through the converter pipeline.
              * `Uploading`: The results are being uploaded to the S3 bucket.
              * `Completed`: The job has been completed and the direct download link is available.
              * `Failed`: The export job has failed. Report this to support for analysis and resolution.
          type: string
          enum:
            - Started
            - Retrieving
            - Converting
            - Uploading
            - Completed
            - Failed
        expires:
          description: The Unix timestamp of when the job result will be deleted.
          type: integer
        links:
          type: array
          items:
            type: object
            properties:
              rel:
                type: string
                enum:
                  - Self
                  - Download
              href:
                type: string
            required:
              - rel
              - href
      required:
        - id
        - created
        - format
        - percentage
        - status
        - expires
        - links
    export_jobs_response:
      type: object
      properties:
        export_jobs:
          type: array
          items:
            $ref: '#/components/schemas/export_job'
      required:
        - export_jobs
    export_job_response:
      type: object
      properties:
        export_job:
          $ref: '#/components/schemas/export_job'
      required:
        - export_job
    labels_response:
      type: object
      properties:
        labels:
          type: array
          $ref: '#/components/schemas/labels_array'
    create_label:
      title: label
      type: object
      properties:
        label:
          description: The created label.
          type: object
          properties:
            name:
              type: string
              description: The name of the label.
            color:
              type: string
              description: The color of the label in HEX code.
          required:
            - name
            - color
    put_label:
      title: label
      type: object
      properties:
        label:
          description: The created label.
          type: object
          properties:
            name:
              type: string
              description: The name of the label.
            color:
              type: string
              description: The color of the label in HEX code.
          required:
            - name
            - color
    patch_label:
      title: label
      type: object
      properties:
        label:
          description: The created label.
          type: object
          properties:
            name:
              type: string
              description: The name of the label.
            color:
              type: string
              description: The color of the label in HEX code.
    search-stats:
      type: array
      items:
        type: object
        properties:
          query_id:
            type: string
            description: The unique ID of the query.
          date:
            type: integer
            description: The date when the query was started, as a UNIX timestamp in milliseconds.
          source:
            type: string
            description: May contain some information on the source of the query. For example, if the value is `"dashboard"`, then the query was launched by a Log Search dashboard rather than explicitly by a user through the Log Search UI.
          leql:
            description: The LEQL statement of the query, along with the time range.
            properties:
              statement:
                type: string
                description: The LEQL query run against the log(s), for example, `where(foo>10 AND bar!=0 OR /some_reg[ex]*/)`. If empty, the query retrieves all log entries in the specified time range.
              from:
                type: integer
                description: The start of the time range for the query, as a UNIX timestamp in milliseconds.
              to:
                type: integer
                description: The end of the time range for the query, as a UNIX timestamp in milliseconds.
              num_of_logs:
                type: integer
                description: The number of logs searched by this query.
          statistics:
            properties:
              duration_ms:
                type: integer
                description: The time taken to complete the query, in milliseconds.
              bytes_all:
                type: integer
                description: The total amount of log data queried in bytes.
              bytes_checked:
                type: integer
                description: The amount of log data that was scanned by this query in bytes. This amount may be much less than the total amount of log data that is queried. This is a result of data indexing performed by Log Search when the LEQL statement matches a small subset of the data.
              events_all:
                type: integer
                description: The total number of log entries queried.
              events_checked:
                type: integer
                description: The number of log entries that were scanned by this query. This amount may be much less than the total amount of log data that is queried. This is a result of data indexing performed by Log Search when the LEQL statement matches a small subset of the data.
              events_matched:
                type: integer
                description: The number of log entries that matched the LEQL statement of the query.
    audit_log:
      description: The object describing a log.
      type: object
      properties:
        id:
          description: The ID of the log.
          type: string
        name:
          description: The name of the log.
          type: string
        rrn:
          description: The Rapid7 Resource Name of the log (unique identifier across the Rapid7 Platform).
          type: string
        logsets_info:
          $ref: '#/components/schemas/member_info'
    audit_log_list:
      description: The list of log sets.
      type: object
      properties:
        logs:
          descritpion: The list of logs.
          type: array
          items:
            $ref: '#/components/schemas/audit_log'
    audit_log_single:
      description: A single Log.
      type: object
      properties:
        log:
          $ref: '#/components/schemas/audit_log'
  parameters:
    log_keys_deprecated:
      name: log_keys
      required: true
      in: path
      schema:
        type: string
      example: /query/logs/565c1b7b-c08b-4c87-a42a-ab08bad56071
      description: |
        \
        The key of the log to be queried.

        Supplying multiple ':' separated log keys is deprecated;
        users should instead 'POST' the query as a JSON payload to [/query/logs](#operation/postQueryLogs).
    query:
      name: query
      required: false
      in: query
      schema:
        type: string
      example: where(foo=bar)
      description: |
        \
        A valid LEQL query to run against the log.
        If omitted, the query retrieves all log entries in the specified time range.
    from:
      name: from
      required: true
      in: query
      schema:
        type: integer
      example: 1450557004000
      description: |
        \
        The start of the time range for the query, as a UNIX timestamp in milliseconds.
    to:
      name: to
      required: true
      in: query
      schema:
        type: integer
      example: 1460557604000
      description: |
        \
        The end of the time range for the query, as a UNIX timestamp in milliseconds.
    time_range:
      name: time_range
      required: false
      in: query
      schema:
        type: string
      example: last 5 minutes
      description: |
        \
        An alternative to the `from` and `to` query parameters. Supported values:
        * `yesterday`
        * `today`
        * `last x timeunits` where x is the number of time unit back from the current server time. Supported time units (case insensitive):
            - min(s) or minute(s)
            - hr(s) or hour(s)
            - day(s)
            - week(s)
            - month(s)
            - year(s)

        If `time_range` is used, then the `from` and `to` query parameters must not be used.
    label:
      name: label
      required: false
      in: query
      schema:
        type: string
      example: 00000000-0000-0000-0000-000000000001
      description: |
        \
        Only entries which have a label with this UUID will be returned.
        This only works with non-statistical queries (i.e. no 'groupby' or 'calculate' clauses).
    labels:
      name: labels
      required: false
      in: query
      schema:
        type: string
      example: 00000000-0000-0000-0000-000000000001:21b21bb8-8869-4e2c-98df-684892e4e112
      description: |
        \
        A set of ':' separated label UUIDs. Only entries which have a label matching one of these UUIDs will be returned.
        This only works with non-statistical queries (i.e. no 'groupby' or 'calculate' clauses).
        Takes precedence over the 'label' parameter.
    per_page:
      name: per_page
      in: query
      required: false
      schema:
        type: integer
        default: 50
      example: 100
      description: |
        \
        Number of log entries to return per page, up to 500(the maximum allowed).
    export_format:
      name: export_format
      required: false
      in: query
      schema:
        type: string
      example: csv
      description: |
        \
        If included, the query results will be exported to the given format.

        * Currently only `csv` is supported.
        * This parameter is only for non-statistical search queries (i.e. no 'calculate' and/or 'groupby' clauses).
        * Results are limited to the first 1 million log entries, and only one export job may run per account at a time.

        The response will be a 202, and the response body will contain a link for polling the export job (on the **/exports/{id}** endpoint).
    kvp_info:
      name: kvp_info
      required: false
      in: query
      schema:
        type: boolean
      example: true
      description: |
        \
        When set to true, the `events` object that is returned will additionally contain information about
        all the key-value pairs in each returned log entry.
    most_recent_first:
      name: most_recent_first
      required: false
      in: query
      schema:
        type: boolean
        default: false
      example: true
      description: |
        \
        When set to `true`, the query returns the most recent events first. When set to `false`, it returns the oldest events first.
    sequence_number:
      name: sequence_number
      required: false
      in: query
      schema:
        type: integer
      example: null
      description: |
        \
        If this query parameter is included, the query results will additionally include all log entries received in the
        `from` millisecond which have sequence numbers larger than the one specified.

        Sequence numbers are identifiers used to distinguish between log entries received in the same millisecond.
        If a log entry was split up into several log entries during ingestion, then those chunks are ordered by sequence number.
    logset_name:
      name: logset_name
      required: true
      in: query
      schema:
        type: string
      example: Internal Logs
      description: |
        \
        The name of the log set to be queried.
        Multiple log sets can be queried by providing this parameter multiple times,
        which results in the query running on the *union* of all contained logs.
        If any of the provided log set names do not exist, a 404 error response is returned.
    logset_id:
      name: logset_id
      required: true
      in: path
      schema:
        type: string
      example: 4a8869fa-0843-4edd-85f5-bf7d6b80d6c5
      description: |
        \
        The id of the log set to be queried.
    saved_query_id:
      name: saved_query_id
      required: true
      in: path
      schema:
        type: string
      example: 00000000-0000-00cf-0000-000000000000
      description: |
        \
        The id of the saved query.
    log_keys:
      name: log_keys
      required: true
      in: path
      schema:
        type: string
      example: /query/logs/565c1b7b-c08b-4c87-a42a-ab08bad56071
      description: |
        \
        The keys of the logs to be queried, separated by the ':' character.
    continuation_id:
      name: id
      required: true
      in: path
      schema:
        type: string
      example: '0bnc17f4-bbbe-46b1-a843-163c074bd1ad:0:c5be1c97f925ff772263661182974903b83ef305:50:f89f7d5cbeb270abeb18b1c28262cee66047d21d:'
      description: |
        \
        The continuation id generated when the query started.
    log_keys_live_tail_deprecated:
      name: log_keys
      required: true
      in: path
      schema:
        type: string
      example: /query/live/logs/565c1b7b-c08b-4c87-a42a-ab08bad56071
      description: |
        \
        The keys of the logs for the Live Tail Feed.

        Supplying multiple ':' separated log keys is deprecated;
        users should instead 'POST' the query as a JSON payload to [/query/live/logs](#operation/postLiveLogs).
    query_live_tail:
      name: query
      required: false
      in: query
      schema:
        type: string
      example: where(foo=bar)
      description: |
        \
        A valid LEQL query for the Live Tail feed.
        If omitted, the query matches all log entries.

        *Live Tail does not support 'calculate' or 'groupby' queries.*
    mode:
      name: mode
      required: false
      in: query
      schema:
        type: string
        default: tail
      example: head
      description: |
        \
        The order the log entries are returned in. Possible values:
        * `tail` (which returns entries in the order: newest to oldest.)
        * `head` (which returns entries in the order: oldest to newest.)
    per_page_live_tail:
      name: per_page
      in: query
      required: false
      schema:
        type: integer
        default: 50
      example: 100
      description: |
        \
        The maximum number of log entries to return at a time, up to 500(the maximum allowed).
        If the number of results exceed this value, the next "page" of results is returned the next time
        that the Live Tail feed is polled.
    log_keys_live_tail:
      name: log_keys
      required: true
      in: path
      schema:
        type: string
      example: /query/live/logs/565c1b7b-c08b-4c87-a42a-ab08bad56071
      description: |
        \
        The keys of the logs for the Live Tail Feed, separated by the ':' character.
    live_tail_poll_id:
      name: id
      required: true
      in: path
      schema:
        type: string
      example: 'c9d059da-7b1b-48a9-aaeb-edf2aa3e3fd9:2:::0447214e1b4e5b2041bf62bd7421cb9b7069065f:'
      description: |
        \
        The polling id generated when the Live Tail Feed started.
    log_keys_live_tail_query_param:
      name: log_keys
      required: false
      in: query
      schema:
        type: string
      example: 565c1b7b-c08b-4c87-a42a-ab08bad56071
      description: |
        \
        The keys of the logs for the Live Tail Feed, separated by the ':' character.
    context_id:
      name: id (sequence number)
      required: true
      in: path
      schema:
        type: integer
      example: 2134329353399137000
      description: |
        \
        The sequence number of the log entry to fetch contextual log entries for
        (a unique identifier used to distinguish between log entries received in the same millisecond).

        The sequence number can be found next to the log entry in the response body for an Event Search query. For
        more context on creating an Event Search query [view the introduction to this section](#tag/Query-Log-Data).
    timestamp_context:
      name: timestamp
      required: true
      in: query
      schema:
        type: string
      example: 1609607464185
      description: |
        \
        The timestamp of the log entry to fetch contextual events for.
    log_keys_context:
      name: log_keys
      required: true
      in: query
      schema:
        type: string
      example: 565c1b7b-c08b-4c87-a42a-ab08bad56071
      description: |
        \
        The key of the log containing the log entry to fetch the contextual events for.
    context_type:
      name: context_type
      required: true
      in: query
      schema:
        type: string
      example: SURROUND
      description: |
        Possible values:
        * `AFTER`  -  returns the log entries immediately *after* the given log entry (doesn't include the given log entry).
        * `BEFORE` -  returns the log entries immediately *before* the given log entry (doesn't include the given log entry).
        * `SURROUND` -  returns the log entries immediately *before and after* the given log entry(*does* include the given log entry).
    metrics_id:
      name: metric_id
      required: true
      in: path
      schema:
        type: string
      example: 9aff96bd-ef12-4887-93b5-00931se12f1a
      description: |
        \
        The UUID of the pre-computed query.
    tag_id:
      name: tag_id
      required: true
      in: path
      schema:
        type: string
      example: 00000000-0000-00cf-0000-000000000000
      description: |
        \
        The id of the change detection rule.
    action_id:
      name: action_id
      required: true
      in: path
      schema:
        type: string
      example: 00000000-0000-00cf-0000-000000000000
      description: |
        \
        The id of the notification.
    target_id:
      name: target_id
      required: true
      in: path
      schema:
        type: string
      example: 4a8869fa-0843-4edd-85f5-bf7d6b80d6c5
      description: |
        \
        The id of the notification target.
    log_id:
      name: id
      required: true
      in: path
      schema:
        type: string
      example: a53578a2-e667-423b-9694-3e989c388186
      description: |
        \
        The id of the log to be queried.
    from_usage:
      name: from
      required: true
      in: query
      schema:
        type: string
      example: '2023-09-14'
      description: |
        \
        The start of the time range as a string in the format "YYYY-MM-DD".
    to_usage:
      name: to
      required: true
      in: query
      schema:
        type: string
      example: '2023-09-20'
      description: |
        \
        The end of the time range as a string in the format "YYYY-MM-DD".
    log_key:
      name: log key
      required: true
      in: path
      schema:
        type: string
      example: 565c1b7b-c08b-4c87-a42a-ab08bad56071
      description: |
        \
        The key of the log to be queried.
    log_ids:
      name: ids
      required: true
      in: path
      schema:
        type: string
      example: aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa:bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb:cccccccc-cccc-cccc-cccc-cccccccccccc
      description: |
        \
        The UUIDs of the logs separated by colons ":" or semicolons ";". For example "UUID1:UUID2:UUID3" or "UUID1;UUID2;UUID3".
    download_logs_limit:
      name: limit
      required: false
      in: query
      schema:
        type: integer
      example: 10
      description: |
        \
        The maximum, and default, number of log entries to download is 500,000,000 log entries.
        You can specify this parameter to limit the number of log entries in the download.
    export_job_id:
      name: id
      required: true
      in: query
      schema:
        type: string
      example: 00000000-0000-0000-0000-000000000000
      description: |
        \
        The UUID of the export job.
    label_id:
      name: label_id
      required: true
      in: path
      schema:
        type: string
      example: 4a8869fa-0843-4edd-85f5-bf7d6b80d6c5
      description: |
        \
        The ID of the label to be queried.
  headers:
    x-beyond-retention:
      schema:
        type: boolean
      description: When present, indicates that the data queried is beyond the retention period.
    x-beyond-retention-message:
      schema:
        type: string
      description: Standard error message returned if the executed query is beyond retention period.
    X-RateLimit-Limit:
      schema:
        type: integer
      description: |
        The total number of requests allowed in the current rate limit window. 
        By default, you can make 1,500 requests in a 15-minute time window.
        The `X-RateLimit-Reset` response header tells you how many seconds you must wait until the limit is reset.
      required: true
    X-RateLimit-Remaining:
      schema:
        type: integer
      description: The number of requests remaining for the current window.
      required: true
    X-RateLimit-Reset:
      schema:
        type: integer
      description: The number of seconds until the current rate limit window resets.
      required: true
    Retry-After:
      schema:
        type: integer
      description: |
        The number of seconds until the current rate limit window resets.
        Automatically handled by some programming libraries for making HTTP requests.
      required: true
    X-RateLimit-Limit-Polling:
      schema:
        type: integer
      description: |
        The total number of requests allowed in the current rate limit window. 
        By default, you can make 10,000 polling requests in a 15-minute time window.
        The `X-RateLimit-Reset` response header tells you how many seconds you must wait until the limit is reset.
      required: true
    X-RateLimit-Limit-Usage-API:
      schema:
        type: integer
      description: |
        The total number of requests allowed in the current rate limit window. 
        By default, you can make 500 requests to the `/usage` namespace in a 15-minute time window.
        The `X-RateLimit-Reset` response header tells you how many seconds you must wait until the limit is reset.
      required: true
    X-RateLimit-Limit-Download-Log-Data:
      schema:
        type: integer
      description: |
        The total number of requests allowed in the current rate limit window. 
        By default, you can make 300 download requests in a 15-minute time window.
        The `X-RateLimit-Reset` response header tells you how many seconds you must wait until the limit is reset.
      required: true
    X-RateLimit-Limit-Export-To-CSV:
      schema:
        type: integer
      description: |
        The total number of requests allowed in the current rate limit window. 
        By default, you can make 500 requests to the `/exports` namespace in a 15-minute time window.
        The `X-RateLimit-Reset` response header tells you how many seconds you must wait until the limit is reset.
      required: true
    X-RateLimit-Limit-Search-Stats:
      schema:
        type: integer
      description: |
        The total number of requests allowed in the current rate limit window. 
        By default, you can make 500 requests to the `/search-stats` namespace in a 15-minute time window.
        The `X-RateLimit-Reset` response header tells you how many seconds you must wait until the limit is reset.
      required: true
  examples:
    EventsResponseSimple:
      summary: query=where(931dde6c60>=800)
      value:
        logs:
          - 565c1b7b-c08b-4c87-a42a-ab08bad56071
        leql:
          statement: where(931dde6c60>=800)
          during:
            from: 1609629856000
            to: 1609629992000
        events:
          - labels:
              - links:
                  - rel: Self
                    href: https://ap.rest.logs.insight.rapid7.com/management/labels/00000000-0000-0000-0000-000000000001
                id: 00000000-0000-0000-0000-000000000001
            timestamp: 1609629969390
            sequence_number: 2234733321019952000
            log_id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
            message: '{"931dde6c60":899}'
            links:
              - rel: Context
                href: https://ap.rest.logs.insight.rapid7.com/query/context/2234733321019952220?per_page=50&timestamp=1609629969390&log_keys=565c1b7b-c08b-4c87-a42a-ab08bad56071&context_type=SURROUND&kvp_info=true
            sequence_number_str: 2234733321019952000
            kvp_info:
              - key:
                  text: json.931dde6c60
                  start: 2
                  end: 12
                value:
                  text: 899
                  start: 14
                  end: 17
          - labels:
              - links:
                  - rel: Self
                    href: https://ap.rest.logs.insight.rapid7.com/management/labels/00000000-0000-0000-0000-000000000001
                id: 00000000-0000-0000-0000-000000000001
            timestamp: 1609629978988
            sequence_number: 2234733321345612300
            log_id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
            message: '{"931dde6c60":931}'
            links:
              - rel: Context
                href: https://ap.rest.logs.insight.rapid7.com/query/context/2234733321345612345?per_page=1&timestamp=1609629978988&log_keys=565c1b7b-c08b-4c87-a42a-ab08bad56071&context_type=SURROUND&kvp_info=true
            sequence_number_str: 2234733321345612300
            kvp_info:
              - key:
                  text: json.931dde6c60
                  start: 2
                  end: 12
                  value:
                    text: 931
                    start: 14
                    end: 17
    EventsResponsePagination:
      summary: query=where(931dde6c60>=800), per_page=1
      value:
        logs:
          - 565c1b7b-c08b-4c87-a42a-ab08bad56071
        leql:
          statement: where(931dde6c60>=800)
          during:
            from: 1609629856000
            to: 1609629992000
        events:
          - labels:
              - links:
                  - rel: Self
                    href: https://ap.rest.logs.insight.rapid7.com/management/labels/00000000-0000-0000-0000-000000000001
                id: 00000000-0000-0000-0000-000000000001
            timestamp: 1609629969390
            sequence_number: 2234733321019952000
            log_id: 565c1b7b-c08b-4c87-a42a-ab08bad56071
            message: '{"931dde6c60":899}'
            links:
              - rel: Context
                href: https://ap.rest.logs.insight.rapid7.com/query/context/2234733321019952220?per_page=50&timestamp=1609629969390&log_keys=565c1b7b-c08b-4c87-a42a-ab08bad56071&context_type=SURROUND&kvp_info=true
            sequence_number_str: 2234733321019952000
            kvp_info:
              - key:
                  text: json.931dde6c60
                  start: 2
                  end: 12
                value:
                  text: 899
                  start: 14
                  end: 17
        links:
          - rel: Next
            href: https://ap.rest.logs.insight.rapid7.com/query/logs/565c1b7b-c08b-4c87-a42a-ab08bad56071?from=1609629969390&to=1609629992000&per_page=1&sequence_number=2234733321019952220&next_page=true&query=where%28931dde6c60%3E%3D800%29
    StatisticalResponseSimple:
      summary: query=calculate(sd:3ad3319a46)
      value:
        logs:
          - 565c1b7b-c08b-4c87-a42a-ab08bad56071
          - c78579a8-8b20-4e6a-d4c0-5287198a263b
        leql:
          statement: calculate(sd:3ad3319a46)
          during:
            from: 1609679106682
            to: 1609679706682
        statistics:
          cardinality: 0
          granularity: 60000
          from: 1609679106682
          to: 1609679706682
          type: standarddeviation
          stats:
            3ad3319a46:
              standarddeviation: 287.01781617806677
          groups: []
          others: {}
          status: 200
          timeseries:
            3ad3319a46:
              - standarddeviation: 264.67908507948334
              - standarddeviation: 318.8861682764081
              - standarddeviation: 288.0976375868536
              - standarddeviation: 298.30015234396
              - standarddeviation: 271.8874158563202
              - standarddeviation: 241.83893687729548
              - standarddeviation: 245.0096430890253
              - standarddeviation: 294.34210035083316
              - standarddeviation: 301.9467447555437
              - standarddeviation: 291.7268742522665
          groups_timeseries: []
          all_exact_results: null
          standarddeviation: 0
          key: 3ad3319a46
        search_stats:
          duration_ms: 93
          bytes_all: 5607226
          bytes_checked: 5607226
          events_all: 20000
          events_checked: 20000
          events_matched: 4310
          index_factor: 0
    StatisticalResponseTimeSeriesMultiGroupBy:
      summary: query=where(key1 <= 2 AND key2 > 8) groupby(key1, key2) timeslice(5)
      value:
        logs:
          - c78579a8-8b20-4e6a-d4c0-5287198a263b
        leql:
          statement: where(key1 <= 2 AND key2 > 8) groupby(key1, key2) timeslice(5)
          during:
            from: 1609696665614
            to: 1609697265614
        statistics:
          cardinality: 0
          granularity: 0
          from: 1609696665614
          to: 1609697265614
          type: count
          stats: {}
          groups:
            - '[1,9]':
                count: 6
            - '[2,10]':
                count: 4
            - '[1,10]':
                count: 3
            - '[0,9]':
                count: 2
            - '[0,10]':
                count: 2
            - '[2,9]':
                count: 1
          others:
            series: []
          status: 200
          timeseries: {}
          groups_timeseries:
            - '1':
                groups_timeseries:
                  - '9':
                      groups_timeseries: []
                      series:
                        - count: 1
                        - count: 1
                        - count: 2
                        - count: 2
                        - count: 0
                      totals:
                        count: 6
                  - '10':
                      groups_timeseries: []
                      series:
                        - count: 2
                        - count: 0
                        - count: 0
                        - count: 1
                        - count: 0
                      total: 3
                series:
                  - count: 3
                  - count: 1
                  - count: 2
                  - count: 3
                  - count: 0
                totals:
                  count: 9
            - '2':
                groups_timeseries:
                  - '10':
                      groups_timeseries: []
                      series:
                        - count: 1
                        - count: 0
                        - count: 0
                        - count: 2
                        - count: 1
                      totals:
                        count: 4
                  - '9':
                      groups_timeseries: []
                      series:
                        - count: 0
                        - count: 1
                        - count: 0
                        - count: 0
                        - count: 0
                      total:
                        count: 1
                series:
                  - count: 1
                  - count: 1
                  - count: 0
                  - count: 2
                  - count: 1
                totals:
                  count: 5
            - '0':
                groups_timeseries:
                  - '10':
                      groups_timeseries: []
                      series:
                        - count: 0
                        - count: 0
                        - count: 1
                        - count: 1
                        - count: 0
                      totals:
                        - count: 2
                  - '9':
                      groups-timeseries: []
                      series:
                        - count: 0
                        - count: 1
                        - count: 0
                        - count: 1
                        - count: 0
                      totals:
                        - counts: 2
                series:
                  - count: 0
                  - count: 1
                  - count: 1
                  - count: 2
                  - count: 0
                totals:
                  count: 4
          all_exact_result: true
        search_stats:
          duration_ms: 3
          bytes_all: 5607226
          bytes_checked: 2102444
          events_all: 20000
          events_checked: 7490
          events_matched: 18
          index_factor: 0.63
    EventsContinue:
      summary: query=where(931dde6c60>=800)
      value:
        logs:
          - 565c1b7b-c08b-4c87-a42a-ab08bad56071
        leql:
          statement: where(931dde6c60>=800)
          during:
            from: 1609629856000
            to: 1609629992000
        progress: 0
        id: '369640e6-5f93-468d-a6db-d378c7c37756:0:9a3ec09650da40feb64849c5e7bd56379ec9eca9:1:bc5b04ad709824b098f977e04ce729b42835b985:'
        events: []
        links:
          - rel: Self
            href: 'https://ap.rest.logs.insight.rapid7.com/query/369640e6-5f93-468d-a6db-d378c7c37756:0:9a3ec09650da40feb64849c5e7bd56379ec9eca9:1:bc5b04ad709824b098f977e04ce729b42835b985:'
    EventsContinueExportCSV:
      summary: query=where(931dde6c60>=800), export_format=csv
      value:
        logs:
          - 565c1b7b-c08b-4c87-a42a-ab08bad56071
        leql:
          statement: where(931dde6c60>=800)
          during:
            from: 1609629856000
            to: 1609629992000
        progress: 0
        id: a782e81a-1414-47c4-a8c6-8dfb16ebfc17
        events: []
        links:
          - rel: Self
            href: https://ap.rest.logs.insight.rapid7.com/exports/a782e81a-1414-47c4-a8c6-8dfb16ebfc17
    StatsContinueInitial:
      summary: query=where(level!=INFO AND /EOFException/) calculate(count) timeslice(2)
      value:
        logs:
          - 626c8841-feb2-4a45-32a8-5224e4cc6ecf
        leql:
          statement: where(level!=INFO AND /EOFException/) calculate(count) timeslice(2)
          during:
            from: 1601812494482
            to: 1609761294482
            time_range: last 3 months
        progress: 0
        id: '18e408bb-b1dd-4000-b64d-3b9d6edde452:1:c682284c6b4439b0ee207d9c6b77e7b26eaac471::6fb96975a9b1307a417bd64af3cca05ef56fa13b:'
        events: []
        partial:
          cardinality: 0
          granularity: 3974400000
          from: 1601812494482
          to: 1609761294482
          type: count
          stats:
            global_timeseries:
              count: 0
          groups: []
          others: {}
          status: 200
          timeseries:
            global_timeseries:
              - count 0.0
              - count 0.0
          groups_timeseries: []
          all_exact_result: null
          count: 0
        links:
          - rel: Self
            href: https://eu.rest.logs.insight.rapid7.com/query/18e408bb-b1dd-4000-b64d-3b9d6edde452:1:c682284c6b4439b0ee207d9c6b77e7b26eaac471::6fb96975a9b1307a417bd64af3cca05ef56fa13b:?time_range=last+3+months

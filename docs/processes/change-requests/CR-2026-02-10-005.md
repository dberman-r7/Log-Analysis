# Change Request: CR-2026-02-10-005

**Status**: PROPOSED

**Created**: 2026-02-10  
**Last Updated**: 2026-02-10

---

## Basic Information

**Title**: Update `--select-log` utility to select Log Set first, then Log

**Requestor**: User

**Category**: FEATURE

**Priority**: P2 - MEDIUM

---

## Description

### Problem Statement

The current selection utility lists logs directly and writes `RAPID7_LOG_KEY` to `.env`. In environments with many sources, users need to choose a **Log Set** first (grouping), then choose a **Log** within that Log Set.

### Proposed Solution

Amend the interactive utility to:

1. Call the Log Search management API to list **log sets**.
2. Prompt the user to select a log set (by index or id).
3. Call the Log Search management API to list **logs within the selected log set**.
4. Prompt the user to select a log (by index or id).
5. Persist selection to `.env` by updating `RAPID7_LOG_KEY=<selected log id>`.

The utility must fail loudly on unexpected response shapes or invalid selections and must not log secrets.

### Business Justification

Reduces configuration errors and speeds up onboarding by making it easy to find the intended log source in accounts with many log sets and logs.

---

## Affected Components

- `src/log_ingestion/api_client.py` (add log set list + list logs by log set)
- `src/log_ingestion/log_selection.py` (add selection helpers for log sets and logs)
- `src/log_ingestion/main.py` (update `--select-log` flow)
- `tests/` (add unit tests for list/select flow)
- `docs/requirements/rtm.md` (add/extend requirements for log set selection)
- `docs/runbooks/log-ingestion-service.md` (update selection instructions)

---

## Approval Status

**Approval Token Received**: ATP (2026-02-10)

---

## Change History

| Date | Status | Notes |
|------|--------|------|
| 2026-02-10 | PROPOSED | Created from user request (log set selection flow) |

---

**End of Change Request CR-2026-02-10-005**

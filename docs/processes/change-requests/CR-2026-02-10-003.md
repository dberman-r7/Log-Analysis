# Change Request: CR-2026-02-10-003

**Status**: APPROVED

**Created**: 2026-02-10  
**Last Updated**: 2026-02-10

---

## Basic Information

**Title**: Add utility to list Log Search logs and set `RAPID7_LOG_KEY` in `.env`

**Requestor**: User

**Category**: FEATURE

**Priority**: P2 - MEDIUM

---

## Description

### Problem Statement

Selecting the correct Rapid7 Log Search `log_key` is currently manual and error-prone. Users need a safe way to:

1. List available logs from the Log Search management API.
2. Choose which log to ingest.
3. Persist the choice by updating `.env` (setting `RAPID7_LOG_KEY=...`) without needing to hand-edit.

### Proposed Solution

Add a small CLI utility that:

- Calls `GET https://{region}.rest.logs.insight.rapid7.com/management/logs` using `x-api-key` auth.
- Displays a numbered list (id + name) for human selection.
- Accepts user input (index or direct log id).
- Writes/updates `.env` with `RAPID7_LOG_KEY=<selected>`.
- Avoids logging secrets and fails loudly on unexpected API responses.

### Business Justification

Reduces onboarding friction and runtime configuration mistakes; improves reliability by preventing ingestion against the wrong log source.

---

## Affected Components

- `src/log_ingestion/api_client.py` (add `list_logs()` method)
- `src/log_ingestion/main.py` (add a `--select-log` mode / subcommand-like option)
- `docs/runbooks/log-ingestion-service.md` (document how to list/select logs and persisted env updates)
- `tests/` (add unit tests for list/select + env update)

---

## Approval Status

**Approval Token Received**: ATP (2026-02-10)

---

## Change History

| Date | Status | Notes |
|------|--------|------|
| 2026-02-10 | APPROVED | User approved to proceed |

---

**End of Change Request CR-2026-02-10-003**
